var __extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o};define(["require","exports","../App","../Helper","./ExtraChargeView","../DAL/ExtraCharges","marionette","jquery","knockout"],function(e,t,o,n,r,i){var a,s=(e("underscore"),e("knockout"),e("knockback"),function(e){function t(){a=o.Application.getInstance(),e.call(this)}return __extends(t,e),t.prototype.EditExtraCharge=function(e){var t=this,o=i.GetById(e);o.done(function(e){t.GetByIdCompleted(e)})},t.prototype.GetByIdCompleted=function(e){var t=this;this.collection=e.extraChargesList,this.backboneModel=new Backbone.Model(this.collection[0]);var o=this.backboneModel,n=window.location.href,i=n.substring(n.indexOf("id=")+3,n.length);(void 0===o.get("id")||0===o.get("id"))&&this.InitalizeKoBinding(o),o.set("bookingId",i),o.set("busList",o.get("busList")),o.set("busSelected",""),this.view=new r.ExtraChargeView(o),this.view.on("ExtraChargesSave",function(e){return t.Save(e)}),o.set("extraChargesCollection",this.collection),a.MainRegion.show(this.view)},t.prototype.InitalizeKoBinding=function(e){e.set("extraAmountCharge",""),e.set("extraAmountReason",""),e.set("extraAmountReceipt","")},t.prototype.Save=function(e){var t=this,o=a.request("AppGlobalSetting");e.set("modifiedBy",o.get("Id")),e.set("id",$("#hdnExtraChargeId").val());var n=i.Save(e);n.done(function(e){return t.SaveCompleted(e)})},t.prototype.SaveCompleted=function(e){var t=new Backbone.Model(e);void 0!=t.get("errorMessage")&&""!=t.get("errorMessage").trim()?n.ShowModalPopup("danger","Extra Charge","Due to some technical reason payment have not been saved successfully!<br> Pelase try later"):(n.ShowModalPopup("success","Extra Charge","Record has been saved successfully with Extra Charge ID : "+e.id),location.href="#viewBooking")},t}(n.Controller));t.ExtraChargeCtrl=s});