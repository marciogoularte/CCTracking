var __extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o};define(["require","exports","../Helper","../App","marionette","jquery","jqueryUI","knockout","text!./ExtraCharge.html"],function(e,t,o,n){function i(e,t){e.bookingId(t.bookingId),e.extraAmountCharge(t.extraAmountCharge),e.extraAmountReason(t.extraAmountReason),e.extraAmountReceipt(t.extraAmountReceipt),e.actualBookingAmount(t.actualBookingAmount),e.Id(t.id)}var a,r=e("underscore"),s=e("knockout"),u=e("text!./ExtraCharge.html"),l=function(e){function t(t,o){e.call(this,t,o)}return __extends(t,e),t}(o.ViewModel);t.ExtraChargeViewModel=l;var b=function(e){function t(t){a=n.Application.getInstance(),this.template=u,this.viewModel=new h(t),this.bbModel=new Backbone.Model,this.events={submit:"Save","click .jsCancel":"Cancel","click .jsAddMore":"AddMore"},e.call(this,t)}return __extends(t,e),t.prototype.Cancel=function(){window.location.href="#viewBooking"},t.prototype.Save=function(e){e.preventDefault(),this.bbModel.set("id",this.viewModel.Id()),this.bbModel.set("bookingId",this.viewModel.bookingId()),this.bbModel.set("actualBookingAmount",this.viewModel.actualBookingAmount()),this.bbModel.set("busId",this.viewModel.busSelected().id),this.bbModel.set("extraAmountCharge",this.viewModel.extraAmountCharge()),this.bbModel.set("extraAmountReason",this.viewModel.extraAmountReason()),this.bbModel.set("extraAmountReceipt",this.viewModel.extraAmountReceipt()),this.trigger("ExtraChargesSave",this.bbModel)},t.prototype.SaveCompleted=function(e){var t=new Backbone.Model(e);void 0!=t.get("errorMessage")&&""!=t.get("errorMessage").trim()?o.ShowModalPopup("danger","Extra Charge","Due to some technical reason payment have not been saved successfully!<br> Pelase try later"):(o.ShowModalPopup("success","Extra Charge","Record has been saved successfully with Payment ID : "+e.id),location.href="#viewBooking")},t.prototype.onShow=function(){s.applyBindings(this.viewModel,this.el)},t.prototype.onClose=function(){},t}(o.Views.ItemView);t.ExtraChargeView=b;var h=function(){function e(e){var t=this;void 0==e?(this.Id=s.observable(),this.bookingId=s.observable(),this.actualBookingAmount=s.observable(),this.extraAmountCharge=s.observable(),this.extraAmountReason=s.observable(),this.extraAmountReceipt=s.observable()):(this.Id=s.observable(e.get("id")),this.busList=s.observableArray(e.get("busList")),this.busSelected=s.observable(e.get("busId")),this.bookingId=s.observable(e.get("bookingId")),this.actualBookingAmount=s.observable(e.get("actualBookingAmount")),this.extraAmountCharge=s.observable(e.get("extraAmountCharge")),this.extraAmountReason=s.observable(e.get("extraAmountReason")),this.extraAmountReceipt=s.observable(e.get("extraAmountReceipt"))),this.busSelected.subscribe(function(){var o=r.filter(e.get("extraChargesCollection"),function(e){return e.busId==t.busSelected().id});i(t,o[0])})}return e}();t.ViewModel=h});