var __extends=this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);i.prototype=t.prototype,e.prototype=new i};define(["require","exports","../../../App","../../../Helper","./DriverSummaryView","../../../Dtos/DriverDto","../../../DAL/Driver","marionette","jquery","knockout"],function(e,t,i,o,r,n,l){var a=(e("underscore"),e("knockout"),e("knockback"),function(e){function t(){e.call(this),this.app=i.Application.getInstance(),this.backboneModel=new n.Models.DriverSummaryDto,this.compositeModel=new Backbone.Model,this.backboneCollection=new Backbone.Collection([]),this.collectionView=new r.DriverSummaryCollectionView({collection:this.backboneCollection}),this.backboneCollection.reset([])}return __extends(t,e),t.prototype.Show=function(){var e=this,t=l.GetAllSummary();t.done(function(t){return e.GetDrvierSummaryCompleted(t)}),this.app.MainRegion.show(this.collectionView),this.collectionView.listenTo(this.collectionView,"itemview:DriverSummaryDetail",function(t,i){return e.GetDriverDetial(i)})},t.prototype.GetDriverDetial=function(e){var t=this,i=l.GetAllDetail(e);i.done(function(e){return t.GetDriverDetailCompleted(e)})},t.prototype.GetDriverDetailCompleted=function(e){for(var t=e.driverList,i=[],n=0;n<t.length;n++)i[n]={driverName:t[n].driverName,vehicleNo:t[n].vehicleNo,visitDate:o.FormatDateString(t[n].visitDate),visitInterval:t[n].visitInterval,bookingId:t[n].bookingId};var l=new Backbone.Collection([]),a=new r.DriverDetailCollectionView({collection:l});this.app.MainRegion.show(a),l.reset(i),location.href="#driverDetail"},t.prototype.GetDrvierSummaryCompleted=function(e){for(var t=e.driverList,i=[],o=0;o<t.length;o++)i[o]={driverId:t[o].driverId,driverName:t[o].driverName,milage:t[o].milage,visitCount:t[o].visitCount};this.backboneCollection.reset(i)},t.prototype.Cancel=function(){window.location.href="#driverSummary"},t}(o.Controller));t.DriverSummaryCtrl=a});