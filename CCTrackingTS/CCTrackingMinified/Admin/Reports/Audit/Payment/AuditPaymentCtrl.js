var __extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o};define(["require","exports","../../../../App","../../../../Helper","./AuditPaymentView","../../../../Dtos/PaymentDto","../../../../DAL/Payment","marionette","jquery","knockout"],function(e,t,o,n,i,a,r){var l=(e("underscore"),e("knockout")),c=e("knockback"),s=function(e){function t(){e.call(this),this.app=o.Application.getInstance(),this.backboneModel=new a.Models.AuditPayment,this.compositeModel=new Backbone.Model,this.backboneCollection=new Backbone.Collection([]),this.collectionView=new i.AuditPaymentCollectionView({collection:this.backboneCollection}),this.backboneCollection.reset([])}return __extends(t,e),t.prototype.Show=function(){var e=this,t=this.backboneModel;t.set("fromDate",n.FormatDateString(Date.now())),t.set("toDate",n.FormatDateString(Date.now())),this.compositeModel=t,this.collectionView.model=t,this.app.MainRegion.show(this.collectionView),this.collectionView.listenTo(this.collectionView,"Event:AuditPayment",function(t){return e.GetAuditPaymentDetial(t)});var o=c.viewModel(this.compositeModel),i=$("#txtFromDate")[0];l.cleanNode(i),l.applyBindings(o,i);var a=$("#txtToDate")[0];l.cleanNode(a),l.applyBindings(o,a)},t.prototype.GetAuditPaymentDetial=function(e){var t=this,o=new Backbone.Model(e);if(""==o.get("fromDate")||""==o.get("toDate"))return void n.ShowModalPopup("danger","Audit Payment","Please enter valid search criteria");var i=r.GetAllAuditPayment(o);i.done(function(e){return t.AuditPaymentCompleted(e)})},t.prototype.AuditPaymentCompleted=function(e){for(var t=e.auditPaymentDisplayList,o=[],i=0;i<t.length;i++)o[i]={bookingId:t[i].bookingId,userName:t[i].userName,propertyName:t[i].propertyName,oldValue:t[i].oldValue,newValue:t[i].newValue,actualModifiedDate:n.FormatDateString(t[i].actualModifiedDate),rowCounter:t[i].rowCounter};this.backboneCollection.reset(o)},t}(n.Controller);t.AuditPaymentCtrl=s});