var __extends=this.__extends||function(t,e){function o(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);o.prototype=e.prototype,t.prototype=new o};define(["require","exports","../Helper","marionette","jquery","jqueryUI","knockout","text!./BookingTmpl.html","text!./BookingGrid.html","text!./BokingGridRow.html"],function(t,e,o){function i(t){var e=JSON.parse(localStorage.getItem("lookupResponse")),o=r.filter(e.unionCouncil,function(e){return e.id==t});return o}function n(t){var e=JSON.parse(localStorage.getItem("lookupResponse")),o=r.filter(e.town,function(e){return e.id==t});return o}var r=t("underscore"),d=t("text!./BookingTmpl.html"),l=t("text!./BookingGrid.html"),a=t("text!./BokingGridRow.html"),c=function(t){function e(e,o){var r=this;t.call(this,e,o),this.model.busPointSelected.subscribe(function(){var t=i(r.model.busPointSelected().parentId);r.model.unionCouncilList(t)}),this.model.unionCouncilIdSelected.subscribe(function(){var t=n(r.model.unionCouncilIdSelected().parentId);r.model.townList(t)})}return __extends(e,t),e}(o.ViewModel);e.BookingViewModel=c;var u=function(t){function e(e){this.template=d,this.events={submit:"Save","click .jsCancel":"Cancel"},t.call(this,e)}return __extends(e,t),e.prototype.Cancel=function(){window.location.href="#viewBooking"},e.prototype.onDomRefresh=function(){var t=JSON.parse(localStorage.getItem("lookupResponse")),e=r.map(t.landmark,function(t){return{value:t.id,text:t.description,parentId:t.parentId}}),o=this.$el.find("#ddlBusPoint").selectize({options:e,create:!1,sortField:{field:"text",direction:"asc"},dropdownParent:"body"}),n=this;this.$el.find("#ddlBusPoint").on("change",function(){var e=r.filter(t.landmark,function(t){return t.id==o[0].value});if(void 0!=e[0]){n.viewModel.model.busPointSelected(e[0]);var d=i(e[0].parentId);n.viewModel.model.unionCouncilList(d)}})},e.prototype.Save=function(t){t.preventDefault(),this.trigger("SaveBooking")},e.prototype.ExportToPdf=function(t){o.PrintReceipt(t)},e}(o.Views.MvvmView);e.BookingView=u;var s=function(t){function e(e){this.itemView=p,this.template=l.getOuterHTML("#gridTemplate"),this.itemViewContainer="tbody",t.call(this,e)}return __extends(e,t),e.prototype.onShow=function(){this.dataTable=this.$el.find("#tblBooking").dataTable({autoWidth:!1,info:!0,processing:!0,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],language:{paginate:{next:"Next",previous:"Prev"},emptyTable:"No record found!",infoEmpty:"No record found!",zeroRecords:"No record found!"},pageLength:o.GetPageSize()})},e}(o.Views.CompositeView);e.BookingCollectionView=s;var p=function(t){function e(e){var o=this;e.template=a.getOuterHTML("#rowTemplate"),e.tagName="tr",e.className="jsRowClick",e.events={"mouseover .jsShowDetail":"ShowDetail","click .jsExportToPdf":function(){o.trigger("ExportToPdf",o.model.get("id"))},"click .jsShowDetail":"ShowDetail","click .jsEditBooking":"EditBooking","click .jsEditPayment":"EditPayment","click .jsEditRefund":"EditRefund","click .jsEditExtraCharge":"EditExtraCharge"},t.call(this,e)}return __extends(e,t),e.prototype.EditBooking=function(t){t.preventDefault(),window.location.href="#editBooking",this.trigger("Event:EditBooking",this.model.get("id"))},e.prototype.EditPayment=function(t){t.preventDefault(),window.location.href="#editPayment",this.trigger("Event:EditPayment",this.model.get("id"))},e.prototype.EditRefund=function(t){t.preventDefault(),window.location.href="#editRefund",this.trigger("Event:EditRefund",this.model.get("id"))},e.prototype.EditExtraCharge=function(t){t.preventDefault(),window.location.href="#editExtraCharge",this.trigger("Event:EditExtraCharge",this.model.get("id"))},e.prototype.ShowDetail=function(){},e}(o.Views.ItemView);e.BookingItemView=p});