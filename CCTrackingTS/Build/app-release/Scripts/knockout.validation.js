(function(){function e(e,t,n){e.isValidating(!0),t.validator(e(),n.params||!0,function(r){var i=!1,s="";e.__valid__()&&(r.message?(i=r.isValid,s=r.message):i=r,!i)&&(e.error=ko.validation.formatMessage(s||n.message||t.message,n.params),e.__valid__(i)),e.isValidating(!1)})}if(void 0===typeof ko)throw"Knockout is required, please ensure it is loaded before loading this validation plug-in";var t={registerExtenders:!0,messagesOnModified:!0,messageTemplate:null,insertMessages:!0,parseInputAttributes:!1,writeInputAttributes:!1,decorateElement:!1,errorClass:null,errorElementClass:"validationElement",errorMessageClass:"validationMessage",grouping:{deep:!1,observable:!0}},n=ko.utils.extend({},t),r=["required","pattern","min","max","step"],i,s=(new Date).getTime(),o={};i={isArray:function(e){return e.isArray||"[object Array]"===Object.prototype.toString.call(e)},isObject:function(e){return null!==e&&"object"==typeof e},values:function(e){var t=[],n;for(n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},getValue:function(e){return"function"==typeof e?e():e},hasAttribute:function(e,t){return null!==e.getAttribute(t)},isValidatable:function(e){return e.rules&&e.isValid&&e.isModified},insertAfter:function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},newId:function(){return s+=1},getConfigOptions:function(e){return i.contextFor(e)||n},setDomData:function(e,t){var n=e.__ko_validation__;n||(e.__ko_validation__=n=i.newId()),o[n]=t},getDomData:function(e){return e=e.__ko_validation__,e?o[e]:void 0},contextFor:function(e){switch(e.nodeType){case 1:case 8:var t=i.getDomData(e);if(t)return t;if(e.parentNode)return i.contextFor(e.parentNode)}},isEmptyVal:function(e){if(void 0===e||null===e||""===e)return!0}};var u=0;ko.validation={utils:i,init:function(e,t){if(!(0<u)||t)e=e||{},e.errorElementClass=e.errorElementClass||e.errorClass||n.errorElementClass,e.errorMessageClass=e.errorMessageClass||e.errorClass||n.errorMessageClass,ko.utils.extend(n,e),n.registerExtenders&&ko.validation.registerExtenders(),u=1},configure:function(e){ko.validation.init(e)},reset:function(){n=$.extend(n,t)},group:function(e,t){var t=ko.utils.extend(n.grouping,t),r=ko.observableArray([]),s=null,o=function u(e,n){var s=[],o=ko.utils.unwrapObservable(e),n=void 0!==n?n:t.deep?1:-1;ko.isObservable(e)&&(e.isValid||e.extend({validatable:!0}),r.push(e)),o&&(i.isArray(o)?s=o:i.isObject(o)&&(s=i.values(o))),0!==n&&ko.utils.arrayForEach(s,function(e){e&&!e.nodeType&&u(e,n+1)})};return t.observable?(o(e),s=ko.computed(function(){var e=[];return ko.utils.arrayForEach(r(),function(t){t.isValid()||e.push(t.error)}),e})):s=function(){var t=[];return r([]),o(e),ko.utils.arrayForEach(r(),function(e){e.isValid()||t.push(e.error)}),t},s.showAllMessages=function(e){e==void 0&&(e=!0),s(),ko.utils.arrayForEach(r(),function(t){t.isModified(e)})},e.errors=s,e.isValid=function(){return e.errors().length===0},e.isAnyMessageShown=function(){var e=!1;return s(),ko.utils.arrayForEach(r(),function(t){!t.isValid()&&t.isModified()&&(e=!0)}),e},s},formatMessage:function(e,t){return e.replace(/\{0\}/gi,t)},addRule:function(e,t){return e.extend({validatable:!0}),e.rules.push(t),e},addAnonymousRule:function(e,t){var n=i.newId();void 0===t.message&&(rulesObj.message="Error"),ko.validation.rules[n]=t,ko.validation.addRule(e,{rule:n,params:t.params})},addExtender:function(e){ko.extenders[e]=function(t,n){return n.message||n.onlyIf?ko.validation.addRule(t,{rule:e,message:n.message,params:i.isEmptyVal(n.params)?!0:n.params,condition:n.onlyIf}):ko.validation.addRule(t,{rule:e,params:n})}},registerExtenders:function(){if(n.registerExtenders)for(var e in ko.validation.rules)ko.validation.rules.hasOwnProperty(e)&&(ko.extenders[e]||ko.validation.addExtender(e))},insertValidationMessage:function(e){var t=document.createElement("SPAN");return t.className=i.getConfigOptions(e).errorMessageClass,i.insertAfter(e,t),t},parseInputValidationAttributes:function(e,t){ko.utils.arrayForEach(r,function(n){i.hasAttribute(e,n)&&ko.validation.addRule(t(),{rule:n,params:e.getAttribute(n)||!0})})},writeInputValidationAttributes:function(e,t){var n=t();if(n&&n.rules){var i=n.rules();ko.utils.arrayForEach(r,function(t){var n,r=ko.utils.arrayFirst(i,function(e){return e.rule.toLowerCase()===t.toLowerCase()});r&&(n=r.params,"pattern"==r.rule&&r.params instanceof RegExp&&(n=r.params.source),e.setAttribute(t,n))}),i=null}}},ko.validation.rules={},ko.validation.rules.required={validator:function(e,t){var n=/^\s+|\s+$/g,r;return void 0===e||null===e?!t:(r=e,"string"==typeof e&&(r=e.replace(n,"")),t&&0<(r+"").length)},message:"This field is required."},ko.validation.rules.min={validator:function(e,t){return i.isEmptyVal(e)||e>=t},message:"Please enter a value greater than or equal to {0}."},ko.validation.rules.max={validator:function(e,t){return i.isEmptyVal(e)||e<=t},message:"Please enter a value less than or equal to {0}."},ko.validation.rules.minLength={validator:function(e,t){return i.isEmptyVal(e)||e.length>=t},message:"Please enter at least {0} characters."},ko.validation.rules.maxLength={validator:function(e,t){return i.isEmptyVal(e)||e.length<=t},message:"Please enter no more than {0} characters."},ko.validation.rules.pattern={validator:function(e,t){return i.isEmptyVal(e)||null!=e.match(t)},message:"Please check this value."},ko.validation.rules.step={validator:function(e,t){return i.isEmptyVal(e)||0===100*e%(100*t)},message:"The value must increment by {0}"},ko.validation.rules.email={validator:function(e,t){return i.isEmptyVal(e)||t&&/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)},message:"Please enter a proper email address"},ko.validation.rules.date={validator:function(e,t){return i.isEmptyVal(e)||t&&!/Invalid|NaN/.test(new Date(e))},message:"Please enter a proper date"},ko.validation.rules.dateISO={validator:function(e,t){return i.isEmptyVal(e)||t&&/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(e)},message:"Please enter a proper date"},ko.validation.rules.number={validator:function(e,t){return i.isEmptyVal(e)||t&&/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(e)},message:"Please enter a number"},ko.validation.rules.digit={validator:function(e,t){return i.isEmptyVal(e)||t&&/^\d+$/.test(e)},message:"Please enter a digit"},ko.validation.rules.phoneUS={validator:function(e,t){return"string"!=typeof e?!1:i.isEmptyVal(e)?!0:(e=e.replace(/\s+/g,""),t&&9<e.length&&e.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/))},message:"Please specify a valid phone number"},ko.validation.rules.equal={validator:function(e,t){return e===i.getValue(t)},message:"Values must equal"},ko.validation.rules.notEqual={validator:function(e,t){return e!==i.getValue(t)},message:"Please choose another value."},ko.validation.rules.unique={validator:function(e,t){var n=i.getValue(t.collection),r=i.getValue(t.externalValue),s=0;return!e||!n?!0:(ko.utils.arrayFilter(ko.utils.unwrapObservable(n),function(n){e===(t.valueAccessor?t.valueAccessor(n):n)&&s++}),s<(void 0!==r&&e!==r?1:2))},message:"Please make sure the value is unique."},ko.validation.registerExtenders(),ko.bindingHandlers.validationCore={init:function(e,t){var n=i.getConfigOptions(e);if(n.parseInputAttributes){var r=function(){ko.validation.parseInputValidationAttributes(e,t)};window.setImmediate?window.setImmediate(r):window.setTimeout(r,0)}n.insertMessages&&i.isValidatable(t())&&(r=ko.validation.insertValidationMessage(e),n.messageTemplate?ko.renderTemplate(n.messageTemplate,{field:t()},null,r,"replaceNode"):ko.applyBindingsToNode(r,{validationMessage:t()})),n.writeInputAttributes&&i.isValidatable(t())&&ko.validation.writeInputValidationAttributes(e,t),n.decorateElement&&i.isValidatable(t())&&ko.applyBindingsToNode(e,{validationElement:t()})},update:function(){}};var a=ko.bindingHandlers.value.init;ko.bindingHandlers.value.init=function(e,t,n,r,i){return a(e,t,n),ko.bindingHandlers.validationCore.init(e,t,n,r,i)},ko.bindingHandlers.validationMessage={update:function(e,t){var n=t(),r=i.getConfigOptions(e);ko.utils.unwrapObservable(n);var s=!1,o=!1;n.extend({validatable:!0}),s=n.isModified(),o=n.isValid(),ko.bindingHandlers.text.update(e,function(){return!r.messagesOnModified||s?o?null:n.error:null}),ko.bindingHandlers.visible.update(e,function(){return s?!o:!1})}},ko.bindingHandlers.validationElement={update:function(e,t){var n=t(),r=i.getConfigOptions(e);ko.utils.unwrapObservable(n);var s=!1,o=!1;n.extend({validatable:!0}),s=n.isModified(),o=n.isValid(),ko.bindingHandlers.css.update(e,function(){var e={},t=s?!o:!1;return r.decorateElement||(t=!1),e[r.errorElementClass]=t,e})}},ko.bindingHandlers.validationOptions={init:function(e,t){var r=ko.utils.unwrapObservable(t());if(r){var s=ko.utils.extend({},n);ko.utils.extend(s,r),i.setDomData(e,s)}}},ko.extenders.validation=function(e,t){return ko.utils.arrayForEach(i.isArray(t)?t:[t],function(t){ko.validation.addAnonymousRule(e,t)}),e},ko.extenders.validatable=function(e,t){if(t&&!i.isValidatable(e)){e.error=null,e.rules=ko.observableArray(),e.isValidating=ko.observable(!1),e.__valid__=ko.observable(!0),e.isModified=ko.observable(!1);var n=ko.computed(function(){return e(),e.rules(),ko.validation.validateObservable(e),!0});e.isValid=ko.computed(function(){return e.__valid__()});var r=e.subscribe(function(){e.isModified(!0)});e._disposeValidation=function(){e.isValid.dispose(),e.rules.removeAll(),e.isModified._subscriptions.change=[],e.isValidating._subscriptions.change=[],e.__valid__._subscriptions.change=[],r.dispose(),n.dispose(),delete e.rules,delete e.error,delete e.isValid,delete e.isValidating,delete e.__valid__,delete e.isModified}}else!1===t&&i.isValidatable(e)&&e._disposeValidation&&e._disposeValidation();return e},ko.validation.validateObservable=function(t){for(var n=0,r,i,s=t.rules(),o=s.length;n<o;n++)if(i=s[n],!i.condition||i.condition())if(r=ko.validation.rules[i.rule],r.async||i.async)e(t,r,i);else{var u;u=t,r.validator(u(),void 0===i.params?!0:i.params)?u=!0:(u.error=ko.validation.formatMessage(i.message||r.message,i.params),u.__valid__(!1),u=!1);if(!u)return!1}return t.error=null,t.__valid__(!0),!0},ko.validatedObservable=function(e){if(!ko.validation.utils.isObject(e))return ko.observable(e).extend({validatable:!0});var t=ko.observable(e);return t.errors=ko.validation.group(e),t.isValid=ko.computed(function(){return 0===t.errors().length}),t},ko.validation.localize=function(e){for(var t in e)ko.validation.rules.hasOwnProperty(t)&&(ko.validation.rules[t].message=e[t])},ko.applyBindingsWithValidation=function(e,t,n){var r=arguments.length,i,s;2<r?(i=t,s=n):2>r?i=document.body:arguments[1].nodeType?i=t:s=arguments[1],ko.validation.init(),s&&ko.validation.utils.setDomData(i,s),ko.applyBindings(e,t)};var f=ko.applyBindings;ko.applyBindings=function(e,t){ko.validation.init(),f(e,t)}})();