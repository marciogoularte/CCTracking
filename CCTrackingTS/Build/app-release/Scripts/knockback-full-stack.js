(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){if(e instanceof x)return e;if(!(this instanceof x))return new x(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.6.0";var T=x.each=x.forEach=function(e,t,r){if(e==null)return e;if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else{var o=x.keys(e);for(var i=0,s=o.length;i<s;i++)if(t.call(r,e[o[i]],o[i],e)===n)return}return e};x.map=x.collect=function(e,t,n){var r=[];return e==null?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},x.filter=x.select=function(e,t,n){var r=[];return e==null?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return e==null?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return e==null?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};x.contains=x.include=function(e,t){return e==null?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,x.property(t))},x.where=function(e,t){return x.filter(e,x.matches(t))},x.findWhere=function(e,t){return x.find(e,x.matches(t))},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var r=-Infinity,i=-Infinity;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;u>i&&(r=e,i=u)}),r},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var r=Infinity,i=Infinity;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;u<i&&(r=e,i=u)}),r},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r},x.sample=function(e,t,n){return t==null||n?(e.length!==+e.length&&(e=x.values(e)),e[x.random(e.length-1)]):x.shuffle(e).slice(0,Math.max(0,t))};var k=function(e){return e==null?x.identity:x.isFunction(e)?e:x.property(e)};x.sortBy=function(e,t,n){return t=k(t),x.pluck(x.map(e,function(e,r,i){return{value:e,index:r,criteria:t.call(n,e,r,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var L=function(e){return function(t,n,r){var i={};return n=k(n),T(t,function(s,o){var u=n.call(r,s,o,t);e(i,u,s)}),i}};x.groupBy=L(function(e,t,n){x.has(e,t)?e[t].push(n):e[t]=[n]}),x.indexBy=L(function(e,t,n){e[t]=n}),x.countBy=L(function(e,t){x.has(e,t)?e[t]++:e[t]=1}),x.sortedIndex=function(e,t,n,r){n=k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return e==null?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return e==null?void 0:t==null||n?e[0]:t<0?[]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},x.last=function(e,t,n){return e==null?void 0:t==null||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.partition=function(e,t){var n=[],r=[];return T(e,function(e){(t(e)?n:r).push(e)}),[n,r]},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){if(t?!r||o[o.length-1]!==n:!x.contains(o,n))o.push(n),s.push(e[r])}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.contains(t,e)})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e);for(var n=0;n<e;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){var n=0,r=t.slice();for(var i=0,s=r.length;i<s;i++)r[i]===x&&(r[i]=arguments[n++]);while(n<arguments.length)r.push(arguments[n++]);return e.apply(this,r)}},x.bindAll=function(e){var t=u.call(arguments,1);if(t.length===0)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:x.now(),o=null,s=e.apply(r,i),r=i=null};return function(){var f=x.now();!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0?(clearTimeout(o),o=null,u=f,s=e.apply(r,i),r=i=null):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i,s,o,u,a=function(){var f=x.now()-o;f<t?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i),s=i=null))};return function(){s=this,i=arguments,o=x.now();var f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i),s=i=null),u}},x.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},x.wrap=function(e,t){return x.partial(t,e)},x.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},x.keys=function(e){if(!x.isObject(e))return[];if(E)return E(e);var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=e[t[i]];return r},x.pairs=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},x.invert=function(e){var t={},n=x.keys(e);for(var r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u)&&"constructor"in e&&"constructor"in t)return!1;n.push(e),r.push(t);var a=0,l=!0;if(i=="[object Array]"){a=e.length,l=a==t.length;if(l)while(a--)if(!(l=M(e[a],t[a],n,r)))break}else{for(var c in e)if(x.has(e,c)){a++;if(!(l=x.has(t,c)&&M(e[c],t[c],n,r)))break}if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(e==null)return!0;if(x.isArray(e)||x.isString(e))return e.length===0;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&e.nodeType===1},x.isArray=w||function(e){return f.call(e)=="[object Array]"},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),typeof /./!="function"&&(x.isFunction=function(e){return typeof e=="function"}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||f.call(e)=="[object Boolean]"},x.isNull=function(e){return e===null},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.constant=function(e){return function(){return e}},x.property=function(e){return function(t){return t[e]}},x.matches=function(e){return function(t){if(t===e)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0}},x.times=function(e,t,n){var r=Array(Math.max(0,e));for(var i=0;i<e;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},x.now=Date.now||function(){return(new Date).getTime()};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(e==null)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),typeof define=="function"&&define.amd&&define("underscore",[],function(){return x})}).call(this),function(e,t){if(typeof define=="function"&&define.amd)define(["underscore","jquery","exports"],function(n,r,i){e.Backbone=t(e,i,n,r)});else if(typeof exports!="undefined"){var n=require("underscore");t(e,exports,n)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,r){var i=e.Backbone,s=[],o=s.push,u=s.slice,a=s.splice;t.VERSION="1.1.2",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var f=t.Events={on:function(e,t,n){if(!c(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,r){if(!c(this,"once",e,[t,r])||!t)return this;var i=this,s=n.once(function(){i.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,r)},off:function(e,t,r){var i,s,o,u,a,f,l,h;if(!this._events||!c(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;u=e?[e]:n.keys(this._events);for(a=0,f=u.length;a<f;a++){e=u[a];if(o=this._events[e]){this._events[e]=i=[];if(t||r)for(l=0,h=o.length;l<h;l++)s=o[l],(t&&t!==s.callback&&t!==s.callback._callback||r&&r!==s.context)&&i.push(s);i.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=u.call(arguments,1);if(!c(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&h(n,t),r&&h(r,arguments),this},stopListening:function(e,t,r){var i=this._listeningTo;if(!i)return this;var s=!t&&!r;!r&&typeof t=="object"&&(r=this),e&&((i={})[e._listenId]=e);for(var o in i)e=i[o],e.off(t,r,this),(s||n.isEmpty(e._events))&&delete this._listeningTo[o];return this}},l=/\s+/,c=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(l.test(n)){var s=n.split(l);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},h=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t);return}},p={listenTo:"on",listenToOnce:"once"};n.each(p,function(e,t){f[t]=function(t,r,i){var s=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=n.uniqueId("l"));return s[o]=t,!i&&typeof r=="object"&&(i=this),t[e](r,i,this),this}}),f.bind=f.on,f.unbind=f.off,n.extend(t,f);var d=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{}),r=n.defaults({},r,n.result(this,"defaults")),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(d.prototype,f,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,r){var i,s,o,u,a,f,l,c;if(e==null)return this;typeof e=="object"?(s=e,r=t):(s={})[e]=t,r||(r={});if(!this._validate(s,r))return!1;o=r.unset,a=r.silent,u=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=n.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(i in s)t=s[i],n.isEqual(c[i],t)||u.push(i),n.isEqual(l[i],t)?delete this.changed[i]:this.changed[i]=t,o?delete c[i]:c[i]=t;if(!a){u.length&&(this._pending=r);for(var h=0,p=u.length;h<p;h++)this.trigger("change:"+u[h],this,c[u[h]],r)}if(f)return this;if(!a)while(this._pending)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,r=!1,i=this._changing?this._previousAttributes:this.attributes;for(var s in e){if(n.isEqual(i[s],t=e[s]))continue;(r||(r={}))[s]=t}return r},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,r=e.success;return e.success=function(n){if(!t.set(t.parse(n,e),e))return!1;r&&r(t,n,e),t.trigger("sync",t,n,e)},I(this,e),this.sync("read",this,e)},save:function(e,t,r){var i,s,o,u=this.attributes;e==null||typeof e=="object"?(i=e,r=t):(i={})[e]=t,r=n.extend({validate:!0},r);if(i&&!r.wait){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;i&&r.wait&&(this.attributes=n.extend({},u,i)),r.parse===void 0&&(r.parse=!0);var a=this,f=r.success;return r.success=function(e){a.attributes=u;var t=a.parse(e,r);r.wait&&(t=n.extend(i||{},t));if(n.isObject(t)&&!a.set(t,r))return!1;f&&f(a,e,r),a.trigger("sync",a,e,r)},I(this,r),s=this.isNew()?"create":r.patch?"patch":"update",s==="patch"&&(r.attrs=i),o=this.sync(s,this,r),i&&r.wait&&(this.attributes=u),o},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(n){(e.wait||t.isNew())&&i(),r&&r(t,n,e),t.isNew()||t.trigger("sync",t,n,e)};if(this.isNew())return e.success(),!1;I(this,e);var s=this.sync("delete",this,e);return e.wait||i(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||F();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return r?(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];n.each(v,function(e){d.prototype[e]=function(){var t=u.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var m=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,remove:!1};n.extend(m.prototype,f,{model:d,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,y))},remove:function(e,t){var r=!n.isArray(e);e=r?[e]:n.clone(e),t||(t={});var i,s,o,u;for(i=0,s=e.length;i<s;i++){u=e[i]=this.get(e[i]);if(!u)continue;delete this._byId[u.id],delete this._byId[u.cid],o=this.indexOf(u),this.models.splice(o,1),this.length--,t.silent||(t.index=o,u.trigger("remove",u,this,t)),this._removeReference(u,t)}return r?e[0]:e},set:function(e,t){t=n.defaults({},t,g),t.parse&&(e=this.parse(e,t));var r=!n.isArray(e);e=r?e?[e]:[]:n.clone(e);var i,s,o,u,a,f,l,c=t.at,h=this.model,p=this.comparator&&c==null&&t.sort!==!1,v=n.isString(this.comparator)?this.comparator:null,m=[],y=[],b={},w=t.add,E=t.merge,S=t.remove,x=!p&&w&&S?[]:!1;for(i=0,s=e.length;i<s;i++){a=e[i]||{},a instanceof d?o=u=a:o=a[h.prototype.idAttribute||"id"];if(f=this.get(o))S&&(b[f.cid]=!0),E&&(a=a===u?u.attributes:a,t.parse&&(a=f.parse(a,t)),f.set(a,t),p&&!l&&f.hasChanged(v)&&(l=!0)),e[i]=f;else if(w){u=e[i]=this._prepareModel(a,t);if(!u)continue;m.push(u),this._addReference(u,t)}u=f||u,x&&(u.isNew()||!b[u.id])&&x.push(u),b[u.id]=!0}if(S){for(i=0,s=this.length;i<s;++i)b[(u=this.models[i]).cid]||y.push(u);y.length&&this.remove(y,t)}if(m.length||x&&x.length){p&&(l=!0),this.length+=m.length;if(c!=null)for(i=0,s=m.length;i<s;i++)this.models.splice(c+i,0,m[i]);else{x&&(this.models.length=0);var T=x||m;for(i=0,s=T.length;i<s;i++)this.models.push(T[i])}}l&&this.sort({silent:!0});if(!t.silent){for(i=0,s=m.length;i<s;i++)(u=m[i]).trigger("add",u,this,t);(l||x&&x.length)&&this.trigger("sort",this,t)}return r?e[0]:e},reset:function(e,t){t||(t={});for(var r=0,i=this.models.length;r<i;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return u.apply(this.models,arguments)},get:function(e){return e==null?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t(r,n,e),r.trigger("sync",r,n,e)},I(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var r=this,i=t.success;return t.success=function(e,n){t.wait&&r.add(e,t),i&&i(e,n,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof d)return e;t=t?n.clone(t):{},t.collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_addReference:function(e,t){this._byId[e.cid]=e,e.id!=null&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(b,function(e){m.prototype[e]=function(){var t=u.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var w=["groupBy","countBy","sortBy","indexBy"];n.each(w,function(e){m.prototype[e]=function(t,r){var i=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,i,r)}});var E=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,x)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];n.extend(E.prototype,f,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var r=e[t];n.isFunction(r)||(r=this[e[t]]);if(!r)continue;var i=t.match(S),s=i[1],o=i[2];r=n.bind(r,this),s+=".delegateEvents"+this.cid,o===""?this.$el.on(s,r):this.$el.on(s,o,r)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(!this.el){var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var r=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(r,!1)}else this.setElement(n.result(this,"el"),!1)}}),t.sync=function(e,r,i){var s=N[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};i.url||(o.url=n.result(r,"url")||F()),i.data==null&&r&&(e==="create"||e==="update"||e==="patch")&&(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{});if(i.emulateHTTP&&(s==="PUT"||s==="DELETE"||s==="PATCH")){o.type="POST",i.emulateJSON&&(o.data._method=s);var u=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",s);if(u)return u.apply(this,arguments)}}o.type!=="GET"&&!i.emulateJSON&&(o.processData=!1),o.type==="PATCH"&&T&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,a,i),a};var T=typeof window!="undefined"&&!!window.ActiveXObject&&(!window.XMLHttpRequest||!(new XMLHttpRequest).dispatchEvent),N={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var C=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},k=/\((.*?)\)/g,L=/(\(\?)?:\w+/g,A=/\*\w+/g,O=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(C.prototype,f,{initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);s.execute(i,o),s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(!this.routes)return;this.routes=n.result(this,"routes");var e,t=n.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(O,"\\$&").replace(k,"(?:$1)?").replace(L,function(e,t){return t?e:"([^/?]+)"}).replace(A,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var M=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},_=/^[#\/]|\s+$/g,D=/^\/+|\/+$/g,P=/msie [\w.]+/,H=/\/$/,B=/#.*$/;M.started=!1,n.extend(M.prototype,f,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(H,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(_,"")},start:function(e){if(M.started)throw new Error("Backbone.history has already been started");M.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var r=this.getFragment(),i=document.documentMode,s=P.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(D,"/");if(s&&this._wantsHashChange){var o=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(r)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=r;var u=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&u.hash&&(this.fragment=this.getHash().replace(_,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),M.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(e,t){if(!M.started)return!1;if(!t||t===!0)t={trigger:!!t};var n=this.root+(e=this.getFragment(e||""));e=e.replace(B,"");if(this.fragment===e)return;this.fragment=e,e===""&&n!=="/"&&(n=n.slice(0,-1));if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}if(t.trigger)return this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new M;var j=function(e,t){var r=this,i;e&&n.has(e,"constructor")?i=e.constructor:i=function(){return r.apply(this,arguments)},n.extend(i,r,t);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};d.extend=m.extend=C.extend=E.extend=M.extend=j;var F=function(){throw new Error('A "url" property or function must be specified')},I=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}};return t}),function(){var DEBUG=!0;(function(undefined){var window=this||(0,eval)("this"),document=window.document,navigator=window.navigator,jQuery=window.jQuery,JSON=window.JSON;(function(e){if(typeof require=="function"&&typeof exports=="object"&&typeof module=="object"){var t=module.exports||exports;e(t)}else typeof define=="function"&&define.amd?define(["exports"],e):e(window.ko={})})(function(e){function r(e,t){var r=e===null||typeof e in n;return r?e===t:!1}function i(e,t){var n;return function(){n||(n=setTimeout(function(){n=undefined,e()},t))}}function s(e,t){var n;return function(){clearTimeout(n),n=setTimeout(e,t)}}function o(e){var n=this;return e&&t.utils.objectForEach(e,function(e,r){var i=t.extenders[e];typeof i=="function"&&(n=i(n,r)||n)}),n}function d(e){t.bindingHandlers[e]={init:function(n,r,i,s,o){var u=function(){var t={};return t[e]=r(),t};return t.bindingHandlers.event.init.call(this,n,u,i,s,o)}}}function g(e,n,r,i){t.bindingHandlers[e]={init:function(e,s,o,u,a){var f,l;return t.computed(function(){var o=t.utils.unwrapObservable(s()),u=!r!=!o,c=!l,h=c||n||u!==f;h&&(c&&t.computedContext.getDependenciesCount()&&(l=t.utils.cloneNodes(t.virtualElements.childNodes(e),!0)),u?(c||t.virtualElements.setDomNodeChildren(e,t.utils.cloneNodes(l)),t.applyBindingsToDescendants(i?i(a,o):a,e)):t.virtualElements.emptyNode(e),f=u)},null,{disposeWhenNodeIsRemoved:e}),{controlsDescendantBindings:!0}}},t.expressionRewriting.bindingRewriteValidators[e]=!1,t.virtualElements.allowedBindings[e]=!0}var t=typeof e!="undefined"?e:{};t.exportSymbol=function(e,n){var r=e.split("."),i=t;for(var s=0;s<r.length-1;s++)i=i[r[s]];i[r[r.length-1]]=n},t.exportProperty=function(e,t,n){e[t]=n},t.version="3.1.0",t.exportSymbol("version",t.version),t.utils=function(){function e(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function n(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function r(e,t){return e.__proto__=t,e}function h(e,n){if(t.utils.tagNameLower(e)!=="input"||!e.type)return!1;if(n.toLowerCase()!="click")return!1;var r=e.type;return r=="checkbox"||r=="radio"}var i={__proto__:[]}instanceof Array,s={},o={},u=navigator&&/Firefox\/2/i.test(navigator.userAgent)?"KeyboardEvent":"UIEvents";s[u]=["keyup","keydown","keypress"],s.MouseEvents=["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave"],e(s,function(e,t){if(t.length)for(var n=0,r=t.length;n<r;n++)o[t[n]]=e});var a={propertychange:!0},f=document&&function(){var e=3,t=document.createElement("div"),n=t.getElementsByTagName("i");while(t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->",n[0]);return e>4?e:undefined}(),l=f===6,c=f===7;return{fieldsIncludedWithJsonPost:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],arrayForEach:function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)},arrayIndexOf:function(e,t){if(typeof Array.prototype.indexOf=="function")return Array.prototype.indexOf.call(e,t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},arrayFirst:function(e,t,n){for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r))return e[r];return null},arrayRemoveItem:function(e,n){var r=t.utils.arrayIndexOf(e,n);r>0?e.splice(r,1):r===0&&e.shift()},arrayGetDistinctValues:function(e){e=e||[];var n=[];for(var r=0,i=e.length;r<i;r++)t.utils.arrayIndexOf(n,e[r])<0&&n.push(e[r]);return n},arrayMap:function(e,t){e=e||[];var n=[];for(var r=0,i=e.length;r<i;r++)n.push(t(e[r],r));return n},arrayFilter:function(e,t){e=e||[];var n=[];for(var r=0,i=e.length;r<i;r++)t(e[r],r)&&n.push(e[r]);return n},arrayPushAll:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,r=t.length;n<r;n++)e.push(t[n]);return e},addOrRemoveItem:function(e,n,r){var i=t.utils.arrayIndexOf(t.utils.peekObservable(e),n);i<0?r&&e.push(n):r||e.splice(i,1)},canSetPrototype:i,extend:n,setPrototypeOf:r,setPrototypeOfOrExtend:i?r:n,objectForEach:e,objectMap:function(e,t){if(!e)return e;var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r],r,e));return n},emptyDomNode:function(e){while(e.firstChild)t.removeNode(e.firstChild)},moveCleanedNodesToContainerElement:function(e){var n=t.utils.makeArray(e),r=document.createElement("div");for(var i=0,s=n.length;i<s;i++)r.appendChild(t.cleanNode(n[i]));return r},cloneNodes:function(e,n){for(var r=0,i=e.length,s=[];r<i;r++){var o=e[r].cloneNode(!0);s.push(n?t.cleanNode(o):o)}return s},setDomNodeChildren:function(e,n){t.utils.emptyDomNode(e);if(n)for(var r=0,i=n.length;r<i;r++)e.appendChild(n[r])},replaceDomNodes:function(e,n){var r=e.nodeType?[e]:e;if(r.length>0){var i=r[0],s=i.parentNode;for(var o=0,u=n.length;o<u;o++)s.insertBefore(n[o],i);for(var o=0,u=r.length;o<u;o++)t.removeNode(r[o])}},fixUpContinuousNodeArray:function(e,t){if(e.length){t=t.nodeType===8&&t.parentNode||t;while(e.length&&e[0].parentNode!==t)e.shift();if(e.length>1){var n=e[0],r=e[e.length-1];e.length=0;while(n!==r){e.push(n),n=n.nextSibling;if(!n)return}e.push(r)}}return e},setOptionNodeSelectionState:function(e,t){f<7?e.setAttribute("selected",t):e.selected=t},stringTrim:function(e){return e===null||e===undefined?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},stringTokenize:function(e,n){var r=[],i=(e||"").split(n);for(var s=0,o=i.length;s<o;s++){var u=t.utils.stringTrim(i[s]);u!==""&&r.push(u)}return r},stringStartsWith:function(e,t){return e=e||"",t.length>e.length?!1:e.substring(0,t.length)===t},domNodeIsContainedBy:function(e,t){if(e===t)return!0;if(e.nodeType===11)return!1;if(t.contains)return t.contains(e.nodeType===3?e.parentNode:e);if(t.compareDocumentPosition)return(t.compareDocumentPosition(e)&16)==16;while(e&&e!=t)e=e.parentNode;return!!e},domNodeIsAttachedToDocument:function(e){return t.utils.domNodeIsContainedBy(e,e.ownerDocument.documentElement)},anyDomNodeIsAttachedToDocument:function(e){return!!t.utils.arrayFirst(e,t.utils.domNodeIsAttachedToDocument)},tagNameLower:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},registerEventHandler:function(e,n,r){var i=f&&a[n];if(!i&&jQuery)jQuery(e).bind(n,r);else if(!i&&typeof e.addEventListener=="function")e.addEventListener(n,r,!1);else{if(typeof e.attachEvent=="undefined")throw new Error("Browser doesn't support addEventListener or attachEvent");var s=function(t){r.call(e,t)},o="on"+n;e.attachEvent(o,s),t.utils.domNodeDisposal.addDisposeCallback(e,function(){e.detachEvent(o,s)})}},triggerEvent:function(e,t){if(!e||!e.nodeType)throw new Error("element must be a DOM node when calling triggerEvent");var n=h(e,t);if(jQuery&&!n)jQuery(e).trigger(t);else if(typeof document.createEvent=="function"){if(typeof e.dispatchEvent!="function")throw new Error("The supplied element doesn't support dispatchEvent");var r=o[t]||"HTMLEvents",i=document.createEvent(r);i.initEvent(t,!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(i)}else if(n&&e.click)e.click();else{if(typeof e.fireEvent=="undefined")throw new Error("Browser doesn't support triggering events");e.fireEvent("on"+t)}},unwrapObservable:function(e){return t.isObservable(e)?e():e},peekObservable:function(e){return t.isObservable(e)?e.peek():e},toggleDomNodeCssClass:function(e,n,r){if(n){var i=/\S+/g,s=e.className.match(i)||[];t.utils.arrayForEach(n.match(i),function(e){t.utils.addOrRemoveItem(s,e,r)}),e.className=s.join(" ")}},setTextContent:function(e,n){var r=t.utils.unwrapObservable(n);if(r===null||r===undefined)r="";var i=t.virtualElements.firstChild(e);!i||i.nodeType!=3||t.virtualElements.nextSibling(i)?t.virtualElements.setDomNodeChildren(e,[e.ownerDocument.createTextNode(r)]):i.data=r,t.utils.forceRefresh(e)},setElementName:function(e,t){e.name=t;if(f<=7)try{e.mergeAttributes(document.createElement("<input name='"+e.name+"'/>"),!1)}catch(n){}},forceRefresh:function(e){if(f>=9){var t=e.nodeType==1?e:e.parentNode;t.style&&(t.style.zoom=t.style.zoom)}},ensureSelectElementIsRenderedCorrectly:function(e){if(f){var t=e.style.width;e.style.width=0,e.style.width=t}},range:function(e,n){e=t.utils.unwrapObservable(e),n=t.utils.unwrapObservable(n);var r=[];for(var i=e;i<=n;i++)r.push(i);return r},makeArray:function(e){var t=[];for(var n=0,r=e.length;n<r;n++)t.push(e[n]);return t},isIe6:l,isIe7:c,ieVersion:f,getFormFields:function(e,n){var r=t.utils.makeArray(e.getElementsByTagName("input")).concat(t.utils.makeArray(e.getElementsByTagName("textarea"))),i=typeof n=="string"?function(e){return e.name===n}:function(e){return n.test(e.name)},s=[];for(var o=r.length-1;o>=0;o--)i(r[o])&&s.push(r[o]);return s},parseJson:function(e){if(typeof e=="string"){e=t.utils.stringTrim(e);if(e)return JSON&&JSON.parse?JSON.parse(e):(new Function("return "+e))()}return null},stringifyJson:function(e,n,r){if(!JSON||!JSON.stringify)throw new Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return JSON.stringify(t.utils.unwrapObservable(e),n,r)},postJson:function(n,r,i){i=i||{};var s=i.params||{},o=i.includeFields||this.fieldsIncludedWithJsonPost,u=n;if(typeof n=="object"&&t.utils.tagNameLower(n)==="form"){var a=n;u=a.action;for(var f=o.length-1;f>=0;f--){var l=t.utils.getFormFields(a,o[f]);for(var c=l.length-1;c>=0;c--)s[l[c].name]=l[c].value}}r=t.utils.unwrapObservable(r);var h=document.createElement("form");h.style.display="none",h.action=u,h.method="post";for(var p in r){var d=document.createElement("input");d.name=p,d.value=t.utils.stringifyJson(t.utils.unwrapObservable(r[p])),h.appendChild(d)}e(s,function(e,t){var n=document.createElement("input");n.name=e,n.value=t,h.appendChild(n)}),document.body.appendChild(h),i.submitter?i.submitter(h):h.submit(),setTimeout(function(){h.parentNode.removeChild(h)},0)}}}(),t.exportSymbol("utils",t.utils),t.exportSymbol("utils.arrayForEach",t.utils.arrayForEach),t.exportSymbol("utils.arrayFirst",t.utils.arrayFirst),t.exportSymbol("utils.arrayFilter",t.utils.arrayFilter),t.exportSymbol("utils.arrayGetDistinctValues",t.utils.arrayGetDistinctValues),t.exportSymbol("utils.arrayIndexOf",t.utils.arrayIndexOf),t.exportSymbol("utils.arrayMap",t.utils.arrayMap),t.exportSymbol("utils.arrayPushAll",t.utils.arrayPushAll),t.exportSymbol("utils.arrayRemoveItem",t.utils.arrayRemoveItem),t.exportSymbol("utils.extend",t.utils.extend),t.exportSymbol("utils.fieldsIncludedWithJsonPost",t.utils.fieldsIncludedWithJsonPost),t.exportSymbol("utils.getFormFields",t.utils.getFormFields),t.exportSymbol("utils.peekObservable",t.utils.peekObservable),t.exportSymbol("utils.postJson",t.utils.postJson),t.exportSymbol("utils.parseJson",t.utils.parseJson),t.exportSymbol("utils.registerEventHandler",t.utils.registerEventHandler),t.exportSymbol("utils.stringifyJson",t.utils.stringifyJson),t.exportSymbol("utils.range",t.utils.range),t.exportSymbol("utils.toggleDomNodeCssClass",t.utils.toggleDomNodeCssClass),t.exportSymbol("utils.triggerEvent",t.utils.triggerEvent),t.exportSymbol("utils.unwrapObservable",t.utils.unwrapObservable),t.exportSymbol("utils.objectForEach",t.utils.objectForEach),t.exportSymbol("utils.addOrRemoveItem",t.utils.addOrRemoveItem),t.exportSymbol("unwrap",t.utils.unwrapObservable),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments),e=n.shift();return function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}}),t.utils.domData=new function(){function r(r,i){var s=r[t],o=s&&s!=="null"&&n[s];if(!o){if(!i)return undefined;s=r[t]="ko"+e++,n[s]={}}return n[s]}var e=0,t="__ko__"+(new Date).getTime(),n={};return{get:function(e,t){var n=r(e,!1);return n===undefined?undefined:n[t]},set:function(e,t,n){if(n===undefined&&r(e,!1)===undefined)return;var i=r(e,!0);i[t]=n},clear:function(e){var r=e[t];return r?(delete n[r],e[t]=null,!0):!1},nextKey:function(){return e++ +t}}},t.exportSymbol("utils.domData",t.utils.domData),t.exportSymbol("utils.domData.clear",t.utils.domData.clear),t.utils.domNodeDisposal=new function(){function i(n,r){var i=t.utils.domData.get(n,e);return i===undefined&&r&&(i=[],t.utils.domData.set(n,e,i)),i}function s(n){t.utils.domData.set(n,e,undefined)}function o(e){var n=i(e,!1);if(n){n=n.slice(0);for(var s=0;s<n.length;s++)n[s](e)}t.utils.domData.clear(e),t.utils.domNodeDisposal.cleanExternalData(e),r[e.nodeType]&&u(e)}function u(e){var t,n=e.firstChild;while(t=n)n=t.nextSibling,t.nodeType===8&&o(t)}var e=t.utils.domData.nextKey(),n={1:!0,8:!0,9:!0},r={1:!0,9:!0};return{addDisposeCallback:function(e,t){if(typeof t!="function")throw new Error("Callback must be a function");i(e,!0).push(t)},removeDisposeCallback:function(e,n){var r=i(e,!1);r&&(t.utils.arrayRemoveItem(r,n),r.length==0&&s(e))},cleanNode:function(e){if(n[e.nodeType]){o(e);if(r[e.nodeType]){var i=[];t.utils.arrayPushAll(i,e.getElementsByTagName("*"));for(var s=0,u=i.length;s<u;s++)o(i[s])}}return e},removeNode:function(e){t.cleanNode(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){jQuery&&typeof jQuery["cleanData"]=="function"&&jQuery.cleanData([e])}}},t.cleanNode=t.utils.domNodeDisposal.cleanNode,t.removeNode=t.utils.domNodeDisposal.removeNode,t.exportSymbol("cleanNode",t.cleanNode),t.exportSymbol("removeNode",t.removeNode),t.exportSymbol("utils.domNodeDisposal",t.utils.domNodeDisposal),t.exportSymbol("utils.domNodeDisposal.addDisposeCallback",t.utils.domNodeDisposal.addDisposeCallback),t.exportSymbol("utils.domNodeDisposal.removeDisposeCallback",t.utils.domNodeDisposal.removeDisposeCallback),function(){function n(e){var n=t.utils.stringTrim(e).toLowerCase(),r=document.createElement("div"),i=n.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!n.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!n.indexOf("<td")||!n.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""],s="ignored<div>"+i[1]+e+i[2]+"</div>";typeof window["innerShiv"]=="function"?r.appendChild(window.innerShiv(s)):r.innerHTML=s;while(i[0]--)r=r.lastChild;return t.utils.makeArray(r.lastChild.childNodes)}function r(e){if(jQuery.parseHTML)return jQuery.parseHTML(e)||[];var t=jQuery.clean([e]);if(t&&t[0]){var n=t[0];while(n.parentNode&&n.parentNode.nodeType!==11)n=n.parentNode;n.parentNode&&n.parentNode.removeChild(n)}return t}var e=/^(\s*)<!--(.*?)-->/;t.utils.parseHtmlFragment=function(e){return jQuery?r(e):n(e)},t.utils.setHtml=function(e,n){t.utils.emptyDomNode(e),n=t.utils.unwrapObservable(n);if(n!==null&&n!==undefined){typeof n!="string"&&(n=n.toString());if(jQuery)jQuery(e).html(n);else{var r=t.utils.parseHtmlFragment(n);for(var i=0;i<r.length;i++)e.appendChild(r[i])}}}}(),t.exportSymbol("utils.parseHtmlFragment",t.utils.parseHtmlFragment),t.exportSymbol("utils.setHtml",t.utils.setHtml),t.memoization=function(){function n(){return((1+Math.random())*4294967296|0).toString(16).substring(1)}function r(){return n()+n()}function i(e,n){if(!e)return;if(e.nodeType==8){var r=t.memoization.parseMemoText(e.nodeValue);r!=null&&n.push({domNode:e,memoId:r})}else if(e.nodeType==1)for(var s=0,o=e.childNodes,u=o.length;s<u;s++)i(o[s],n)}var e={};return{memoize:function(t){if(typeof t!="function")throw new Error("You can only pass a function to ko.memoization.memoize()");var n=r();return e[n]=t,"<!--[ko_memo:"+n+"]-->"},unmemoize:function(t,n){var r=e[t];if(r===undefined)throw new Error("Couldn't find any memo with ID "+t+". Perhaps it's already been unmemoized.");try{return r.apply(null,n||[]),!0}finally{delete e[t]}},unmemoizeDomNodeAndDescendants:function(e,n){var r=[];i(e,r);for(var s=0,o=r.length;s<o;s++){var u=r[s].domNode,a=[u];n&&t.utils.arrayPushAll(a,n),t.memoization.unmemoize(r[s].memoId,a),u.nodeValue="",u.parentNode&&u.parentNode.removeChild(u)}},parseMemoText:function(e){var t=e.match(/^\[ko_memo\:(.*?)\]$/);return t?t[1]:null}}}(),t.exportSymbol("memoization",t.memoization),t.exportSymbol("memoization.memoize",t.memoization.memoize),t.exportSymbol("memoization.unmemoize",t.memoization.unmemoize),t.exportSymbol("memoization.parseMemoText",t.memoization.parseMemoText),t.exportSymbol("memoization.unmemoizeDomNodeAndDescendants",t.memoization.unmemoizeDomNodeAndDescendants),t.extenders={throttle:function(e,n){e.throttleEvaluation=n;var r=null;return t.dependentObservable({read:e,write:function(t){clearTimeout(r),r=setTimeout(function(){e(t)},n)}})},rateLimit:function(e,t){var n,r,o;typeof t=="number"?n=t:(n=t.timeout,r=t.method),o=r=="notifyWhenChangesStop"?s:i,e.limit(function(e){return o(e,n)})},notify:function(e,t){e.equalityComparer=t=="always"?null:r}};var n={"undefined":1,"boolean":1,number:1,string:1};t.exportSymbol("extenders",t.extenders),t.subscription=function(e,n,r){this.target=e,this.callback=n,this.disposeCallback=r,this.isDisposed=!1,t.exportProperty(this,"dispose",this.dispose)},t.subscription.prototype.dispose=function(){this.isDisposed=!0,this.disposeCallback()},t.subscribable=function(){t.utils.setPrototypeOfOrExtend(this,t.subscribable.fn),this._subscriptions={}};var u="change",a={subscribe:function(e,n,r){var i=this;r=r||u;var s=n?e.bind(n):e,o=new t.subscription(i,s,function(){t.utils.arrayRemoveItem(i._subscriptions[r],o)});return i.peek&&i.peek(),i._subscriptions[r]||(i._subscriptions[r]=[]),i._subscriptions[r].push(o),o},notifySubscribers:function(e,n){n=n||u;if(this.hasSubscriptionsForEvent(n))try{t.dependencyDetection.begin();for(var r=this._subscriptions[n].slice(0),i=0,s;s=r[i];++i)s.isDisposed||s.callback(e)}finally{t.dependencyDetection.end()}},limit:function(e){var n=this,r=t.isObservable(n),i,s,o,a="beforeChange";n._origNotifySubscribers||(n._origNotifySubscribers=n.notifySubscribers,n.notifySubscribers=function(e,t){!t||t===u?n._rateLimitedChange(e):t===a?n._rateLimitedBeforeChange(e):n._origNotifySubscribers(e,t)});var f=e(function(){r&&o===n&&(o=n()),i=!1,n.isDifferent(s,o)&&n._origNotifySubscribers(s=o)});n._rateLimitedChange=function(e){i=!0,o=e,f()},n._rateLimitedBeforeChange=function(e){i||(s=e,n._origNotifySubscribers(e,a))}},hasSubscriptionsForEvent:function(e){return this._subscriptions[e]&&this._subscriptions[e].length},getSubscriptionsCount:function(){var e=0;return t.utils.objectForEach(this._subscriptions,function(t,n){e+=n.length}),e},isDifferent:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:o};t.exportProperty(a,"subscribe",a.subscribe),t.exportProperty(a,"extend",a.extend),t.exportProperty(a,"getSubscriptionsCount",a.getSubscriptionsCount),t.utils.canSetPrototype&&t.utils.setPrototypeOf(a,Function.prototype),t.subscribable.fn=a,t.isSubscribable=function(e){return e!=null&&typeof e.subscribe=="function"&&typeof e["notifySubscribers"]=="function"},t.exportSymbol("subscribable",t.subscribable),t.exportSymbol("isSubscribable",t.isSubscribable),t.computedContext=t.dependencyDetection=function(){function i(){return++r}function s(t){e.push(n),n=t}function o(){n=e.pop()}var e=[],n,r=0;return{begin:s,end:o,registerDependency:function(e){if(n){if(!t.isSubscribable(e))throw new Error("Only subscribable things can act as dependencies");n.callback(e,e._id||(e._id=i()))}},ignore:function(e,t,n){try{return s(),e.apply(t,n||[])}finally{o()}},getDependenciesCount:function(){if(n)return n.computed.getDependenciesCount()},isInitial:function(){if(n)return n.isInitial}}}(),t.exportSymbol("computedContext",t.computedContext),t.exportSymbol("computedContext.getDependenciesCount",t.computedContext.getDependenciesCount),t.exportSymbol("computedContext.isInitial",t.computedContext.isInitial),t.observable=function(e){function r(){return arguments.length>0?(r.isDifferent(n,arguments[0])&&(r.valueWillMutate(),n=arguments[0],DEBUG&&(r._latestValue=n),r.valueHasMutated()),this):(t.dependencyDetection.registerDependency(r),n)}var n=e;return t.subscribable.call(r),t.utils.setPrototypeOfOrExtend(r,t.observable.fn),DEBUG&&(r._latestValue=n),r.peek=function(){return n},r.valueHasMutated=function(){r.notifySubscribers(n)},r.valueWillMutate=function(){r.notifySubscribers(n,"beforeChange")},t.exportProperty(r,"peek",r.peek),t.exportProperty(r,"valueHasMutated",r.valueHasMutated),t.exportProperty(r,"valueWillMutate",r.valueWillMutate),r},t.observable.fn={equalityComparer:r};var f=t.observable.protoProperty="__ko_proto__";t.observable.fn[f]=t.observable,t.utils.canSetPrototype&&t.utils.setPrototypeOf(t.observable.fn,t.subscribable.fn),t.hasPrototype=function(e,n){return e===null||e===undefined||e[f]===undefined?!1:e[f]===n?!0:t.hasPrototype(e[f],n)},t.isObservable=function(e){return t.hasPrototype(e,t.observable)},t.isWriteableObservable=function(e){return typeof e=="function"&&e[f]===t.observable?!0:typeof e=="function"&&e[f]===t.dependentObservable&&e.hasWriteFunction?!0:!1},t.exportSymbol("observable",t.observable),t.exportSymbol("isObservable",t.isObservable),t.exportSymbol("isWriteableObservable",t.isWriteableObservable),t.observableArray=function(e){e=e||[];if(typeof e=="object"&&"length"in e){var n=t.observable(e);return t.utils.setPrototypeOfOrExtend(n,t.observableArray.fn),n.extend({trackArrayChanges:!0})}throw new Error("The argument passed when initializing an observable array must be an array, or null, or undefined.")},t.observableArray.fn={remove:function(e){var n=this.peek(),r=[],i=typeof e=="function"&&!t.isObservable(e)?e:function(t){return t===e};for(var s=0;s<n.length;s++){var o=n[s];i(o)&&(r.length===0&&this.valueWillMutate(),r.push(o),n.splice(s,1),s--)}return r.length&&this.valueHasMutated(),r},removeAll:function(e){if(e===undefined){var n=this.peek(),r=n.slice(0);return this.valueWillMutate(),n.splice(0,n.length),this.valueHasMutated(),r}return e?this.remove(function(n){return t.utils.arrayIndexOf(e,n)>=0}):[]},destroy:function(e){var n=this.peek(),r=typeof e=="function"&&!t.isObservable(e)?e:function(t){return t===e};this.valueWillMutate();for(var i=n.length-1;i>=0;i--){var s=n[i];r(s)&&(n[i]._destroy=!0)}this.valueHasMutated()},destroyAll:function(e){return e===undefined?this.destroy(function(){return!0}):e?this.destroy(function(n){return t.utils.arrayIndexOf(e,n)>=0}):[]},indexOf:function(e){var n=this();return t.utils.arrayIndexOf(n,e)},replace:function(e,t){var n=this.indexOf(e);n>=0&&(this.valueWillMutate(),this.peek()[n]=t,this.valueHasMutated())}},t.utils.arrayForEach(["pop","push","reverse","shift","sort","splice","unshift"],function(e){t.observableArray.fn[e]=function(){var t=this.peek();this.valueWillMutate(),this.cacheDiffForKnownOperation(t,e,arguments);var n=t[e].apply(t,arguments);return this.valueHasMutated(),n}}),t.utils.arrayForEach(["slice"],function(e){t.observableArray.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}}),t.utils.canSetPrototype&&t.utils.setPrototypeOf(t.observableArray.fn,t.observable.fn),t.exportSymbol("observableArray",t.observableArray);var l="arrayChange";t.extenders.trackArrayChanges=function(e){function o(){if(n)return;n=!0;var t=e.notifySubscribers;e.notifySubscribers=function(e,n){return(!n||n===u)&&++i,t.apply(this,arguments)};var s=[].concat(e.peek()||[]);r=null,e.subscribe(function(t){t=[].concat(t||[]);if(e.hasSubscriptionsForEvent(l)){var n=a(s,t);n.length&&e.notifySubscribers(n,l)}s=t,r=null,i=0})}function a(e,n){if(!r||i>1)r=t.utils.compareArrays(e,n,{sparse:!0});return r}if(e.cacheDiffForKnownOperation)return;var n=!1,r=null,i=0,s=e.subscribe;e.subscribe=e.subscribe=function(e,t,n){return n===l&&o(),s.apply(this,arguments)},e.cacheDiffForKnownOperation=function(e,s,o){function c(e,t,n){return u[u.length]={status:e,value:t,index:n}}if(!n||i)return;var u=[],a=e.length,f=o.length,l=0;switch(s){case"push":l=a;case"unshift":for(var h=0;h<f;h++)c("added",o[h],l+h);break;case"pop":l=a-1;case"shift":a&&c("deleted",e[l],l);break;case"splice":var p=Math.min(Math.max(0,o[0]<0?a+o[0]:o[0]),a),d=f===1?a:Math.min(p+(o[1]||0),a),v=p+f-2,m=Math.max(d,v),g=[],y=[];for(var h=p,b=2;h<m;++h,++b)h<d&&y.push(c("deleted",e[h],h)),h<v&&g.push(c("added",o[b],h));t.utils.findMovesInArrayComparison(y,g);break;default:return}r=u}},t.computed=t.dependentObservable=function(e,n,r){function l(e,t){S[t]||(S[t]=e.subscribe(h),++x)}function c(){a=!0,t.utils.objectForEach(S,function(e,t){t.dispose()}),S={},x=0,s=!1}function h(){var e=d.throttleEvaluation;e&&e>=0?(clearTimeout(T),T=setTimeout(p,e)):d._evalRateLimited?d._evalRateLimited():p()}function p(){if(o)return;if(a)return;if(w&&w()){if(!u){E();return}}else u=!1;o=!0;try{var e=S,r=x;t.dependencyDetection.begin({callback:function(t,n){a||(r&&e[n]?(S[n]=e[n],++x,delete e[n],--r):l(t,n))},computed:d,isInitial:!x}),S={},x=0;try{var c=n?f.call(n):f()}finally{t.dependencyDetection.end(),r&&t.utils.objectForEach(e,function(e,t){t.dispose()}),s=!1}d.isDifferent(i,c)&&(d.notifySubscribers(i,"beforeChange"),i=c,DEBUG&&(d._latestValue=i),(!d._evalRateLimited||d.throttleEvaluation)&&d.notifySubscribers(i))}finally{o=!1}x||E()}function d(){if(arguments.length>0){if(typeof g!="function")throw new Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return g.apply(n,arguments),this}return s&&p(),t.dependencyDetection.registerDependency(d),i}function v(){return s&&!x&&p(),i}function m(){return s||x>0}var i,s=!0,o=!1,u=!1,a=!1,f=e;f&&typeof f=="object"?(r=f,f=r.read):(r=r||{},f||(f=r.read));if(typeof f!="function")throw new Error("Pass a function that returns the value of the ko.computed");var g=r.write,y=r.disposeWhenNodeIsRemoved||r.disposeWhenNodeIsRemoved||null,b=r.disposeWhen||r.disposeWhen,w=b,E=c,S={},x=0,T=null;n||(n=r.owner),t.subscribable.call(d),t.utils.setPrototypeOfOrExtend(d,t.dependentObservable.fn),d.peek=v,d.getDependenciesCount=function(){return x},d.hasWriteFunction=typeof r.write=="function",d.dispose=function(){E()},d.isActive=m;var N=d.limit;return d.limit=function(e){N.call(d,e),d._evalRateLimited=function(){d._rateLimitedBeforeChange(i),s=!0,d._rateLimitedChange(d)}},t.exportProperty(d,"peek",d.peek),t.exportProperty(d,"dispose",d.dispose),t.exportProperty(d,"isActive",d.isActive),t.exportProperty(d,"getDependenciesCount",d.getDependenciesCount),y&&(u=!0,y.nodeType&&(w=function(){return!t.utils.domNodeIsAttachedToDocument(y)||b&&b()})),r.deferEvaluation!==!0&&p(),y&&m()&&y.nodeType&&(E=function(){t.utils.domNodeDisposal.removeDisposeCallback(y,E),c()},t.utils.domNodeDisposal.addDisposeCallback(y,E)),d},t.isComputed=function(e){return t.hasPrototype(e,t.dependentObservable)};var c=t.observable.protoProperty;t.dependentObservable[c]=t.observable,t.dependentObservable.fn={equalityComparer:r},t.dependentObservable.fn[c]=t.dependentObservable,t.utils.canSetPrototype&&t.utils.setPrototypeOf(t.dependentObservable.fn,t.subscribable.fn),t.exportSymbol("dependentObservable",t.dependentObservable),t.exportSymbol("computed",t.dependentObservable),t.exportSymbol("isComputed",t.isComputed),function(){function n(e,t,s){s=s||new i,e=t(e);var o=typeof e=="object"&&e!==null&&e!==undefined&&!(e instanceof Date)&&!(e instanceof String)&&!(e instanceof Number)&&!(e instanceof Boolean);if(!o)return e;var u=e instanceof Array?[]:{};return s.save(e,u),r(e,function(r){var i=t(e[r]);switch(typeof i){case"boolean":case"number":case"string":case"function":u[r]=i;break;case"object":case"undefined":var o=s.get(i);u[r]=o!==undefined?o:n(i,t,s)}}),u}function r(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n);typeof e["toJSON"]=="function"&&t("toJSON")}else for(var r in e)t(r)}function i(){this.keys=[],this.values=[]}var e=10;t.toJS=function(r){if(arguments.length==0)throw new Error("When calling ko.toJS, pass the object you want to convert.");return n(r,function(n){for(var r=0;t.isObservable(n)&&r<e;r++)n=n();return n})},t.toJSON=function(e,n,r){var i=t.toJS(e);return t.utils.stringifyJson(i,n,r)},i.prototype={constructor:i,save:function(e,n){var r=t.utils.arrayIndexOf(this.keys,e);r>=0?this.values[r]=n:(this.keys.push(e),this.values.push(n))},get:function(e){var n=t.utils.arrayIndexOf(this.keys,e);return n>=0?this.values[n]:undefined}}}(),t.exportSymbol("toJS",t.toJS),t.exportSymbol("toJSON",t.toJSON),function(){var e="__ko__hasDomDataOptionValue__";t.selectExtensions={readValue:function(n){switch(t.utils.tagNameLower(n)){case"option":if(n[e]===!0)return t.utils.domData.get(n,t.bindingHandlers.options.optionValueDomDataKey);return t.utils.ieVersion<=7?n.getAttributeNode("value")&&n.getAttributeNode("value").specified?n.value:n.text:n.value;case"select":return n.selectedIndex>=0?t.selectExtensions.readValue(n.options[n.selectedIndex]):undefined;default:return n.value}},writeValue:function(n,r,i){switch(t.utils.tagNameLower(n)){case"option":switch(typeof r){case"string":t.utils.domData.set(n,t.bindingHandlers.options.optionValueDomDataKey,undefined),e in n&&delete n[e],n.value=r;break;default:t.utils.domData.set(n,t.bindingHandlers.options.optionValueDomDataKey,r),n[e]=!0,n.value=typeof r=="number"?r:""}break;case"select":if(r===""||r===null)r=undefined;var s=-1;for(var o=0,u=n.options.length,a;o<u;++o){a=t.selectExtensions.readValue(n.options[o]);if(a==r||a==""&&r===undefined){s=o;break}}if(i||s>=0||r===undefined&&n.size>1)n.selectedIndex=s;break;default:if(r===null||r===undefined)r="";n.value=r}}}}(),t.exportSymbol("selectExtensions",t.selectExtensions),t.exportSymbol("selectExtensions.readValue",t.selectExtensions.readValue),t.exportSymbol("selectExtensions.writeValue",t.selectExtensions.writeValue),t.expressionRewriting=function(){function r(r){if(t.utils.arrayIndexOf(e,r)>=0)return!1;var i=r.match(n);return i===null?!1:i[1]?"Object("+i[1]+")"+i[2]:r}function p(e){var n=t.utils.stringTrim(e);n.charCodeAt(0)===123&&(n=n.slice(1,-1));var r=[],i=n.match(l),s,o,u=0;if(i){i.push(",");for(var a=0,f;f=i[a];++a){var p=f.charCodeAt(0);if(p===44){if(u<=0){s&&r.push(o?{key:s,value:o.join("")}:{unknown:s}),s=o=u=0;continue}}else if(p===58){if(!o)continue}else if(p===47&&a&&f.length>1){var d=i[a-1].match(c);d&&!h[d[0]]&&(n=n.substr(n.indexOf(f)+1),i=n.match(l),i.push(","),a=-1,f="/")}else if(p===40||p===123||p===91)++u;else if(p===41||p===125||p===93)--u;else if(!s&&!o){s=p===34||p===39?f.slice(1,-1):f;continue}o?o.push(f):o=[f]}}return r}function v(e,n){function i(e,n){function f(t){return t&&t.preprocess?n=t.preprocess(n,e,i):!0}var a;if(!f(t.getBindingHandler(e)))return;d[e]&&(a=r(n))&&o.push("'"+e+"':function(_z){"+a+"=_z}"),u&&(n="function(){return "+n+" }"),s.push("'"+e+"':"+n)}n=n||{};var s=[],o=[],u=n.valueAccessors,a=typeof e=="string"?p(e):e;return t.utils.arrayForEach(a,function(e){i(e.key||e.unknown,e.value)}),o.length&&i("_ko_property_writers","{"+o.join(",")+" }"),s.join(",")}var e=["true","false","null","undefined"],n=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,i='"(?:[^"\\\\]|\\\\.)*"',s="'(?:[^'\\\\]|\\\\.)*'",o="/(?:[^/\\\\]|\\\\.)*/w*",u=",\"'{}()/:[\\]",a="[^\\s:,/][^"+u+"]*[^\\s"+u+"]",f="[^\\s]",l=RegExp(i+"|"+s+"|"+o+"|"+a+"|"+f,"g"),c=/[\])"'A-Za-z0-9_$]+$/,h={"in":1,"return":1,"typeof":1},d={};return{bindingRewriteValidators:[],twoWayBindings:d,parseObjectLiteral:p,preProcessBindings:v,keyValueArrayContainsKey:function(e,t){for(var n=0;n<e.length;n++)if(e[n]["key"]==t)return!0;return!1},writeValueToProperty:function(e,n,r,i,s){if(!e||!t.isObservable(e)){var o=n.get("_ko_property_writers");o&&o[r]&&o[r](i)}else t.isWriteableObservable(e)&&(!s||e.peek()!==i)&&e(i)}}}(),t.exportSymbol("expressionRewriting",t.expressionRewriting),t.exportSymbol("expressionRewriting.bindingRewriteValidators",t.expressionRewriting.bindingRewriteValidators),t.exportSymbol("expressionRewriting.parseObjectLiteral",t.expressionRewriting.parseObjectLiteral),t.exportSymbol("expressionRewriting.preProcessBindings",t.expressionRewriting.preProcessBindings),t.exportSymbol("expressionRewriting._twoWayBindings",t.expressionRewriting.twoWayBindings),t.exportSymbol("jsonExpressionRewriting",t.expressionRewriting),t.exportSymbol("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",t.expressionRewriting.preProcessBindings),function(){function s(t){return t.nodeType==8&&n.test(e?t.text:t.nodeValue)}function o(t){return t.nodeType==8&&r.test(e?t.text:t.nodeValue)}function u(e,t){var n=e,r=1,i=[];while(n=n.nextSibling){if(o(n)){r--;if(r===0)return i}i.push(n),s(n)&&r++}if(!t)throw new Error("Cannot find closing comment tag to match: "+e.nodeValue);return null}function a(e,t){var n=u(e,t);return n?n.length>0?n[n.length-1].nextSibling:e.nextSibling:null}function f(e){var t=e.firstChild,n=null;if(t)do if(n)n.push(t);else if(s(t)){var r=a(t,!0);r?t=r:n=[t]}else o(t)&&(n=[t]);while(t=t.nextSibling);return n}var e=document&&document.createComment("test").text==="<!--test-->",n=e?/^<!--\s*ko(?:\s+([\s\S]+))?\s*-->$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,r=e?/^<!--\s*\/ko\s*-->$/:/^\s*\/ko\s*$/,i={ul:!0,ol:!0};t.virtualElements={allowedBindings:{},childNodes:function(e){return s(e)?u(e):e.childNodes},emptyNode:function(e){if(!s(e))t.utils.emptyDomNode(e);else{var n=t.virtualElements.childNodes(e);for(var r=0,i=n.length;r<i;r++)t.removeNode(n[r])}},setDomNodeChildren:function(e,n){if(!s(e))t.utils.setDomNodeChildren(e,n);else{t.virtualElements.emptyNode(e);var r=e.nextSibling;for(var i=0,o=n.length;i<o;i++)r.parentNode.insertBefore(n[i],r)}},prepend:function(e,t){s(e)?e.parentNode.insertBefore(t,e.nextSibling):e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)},insertAfter:function(e,n,r){r?s(e)?e.parentNode.insertBefore(n,r.nextSibling):r.nextSibling?e.insertBefore(n,r.nextSibling):e.appendChild(n):t.virtualElements.prepend(e,n)},firstChild:function(e){return s(e)?!e.nextSibling||o(e.nextSibling)?null:e.nextSibling:e.firstChild},nextSibling:function(e){return s(e)&&(e=a(e)),e.nextSibling&&o(e.nextSibling)?null:e.nextSibling},hasBindingValue:s,virtualNodeBindingValue:function(t){var r=(e?t.text:t.nodeValue).match(n);return r?r[1]:null},normaliseVirtualElementDomStructure:function(e){if(!i[t.utils.tagNameLower(e)])return;var n=e.firstChild;if(n)do if(n.nodeType===1){var r=f(n);if(r){var s=n.nextSibling;for(var o=0;o<r.length;o++)s?e.insertBefore(r[o],s):e.appendChild(r[o])}}while(n=n.nextSibling)}}}(),t.exportSymbol("virtualElements",t.virtualElements),t.exportSymbol("virtualElements.allowedBindings",t.virtualElements.allowedBindings),t.exportSymbol("virtualElements.emptyNode",t.virtualElements.emptyNode),t.exportSymbol("virtualElements.insertAfter",t.virtualElements.insertAfter),t.exportSymbol("virtualElements.prepend",t.virtualElements.prepend),t.exportSymbol("virtualElements.setDomNodeChildren",t.virtualElements.setDomNodeChildren),function(){function n(e,t,n){var i=e+(n&&n.valueAccessors||"");return t[i]||(t[i]=r(e,n))}function r(e,n){var r=t.expressionRewriting.preProcessBindings(e,n),i="with($context){with($data||{}){return{"+r+"}}}";return new Function("$context","$element",i)}var e="data-bind";t.bindingProvider=function(){this.bindingCache={}},t.utils.extend(t.bindingProvider.prototype,{nodeHasBindings:function(n){switch(n.nodeType){case 1:return n.getAttribute(e)!=null;case 8:return t.virtualElements.hasBindingValue(n);default:return!1}},getBindings:function(e,t){var n=this.getBindingsString(e,t);return n?this.parseBindingsString(n,t,e):null},getBindingAccessors:function(e,t){var n=this.getBindingsString(e,t);return n?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null},getBindingsString:function(n,r){switch(n.nodeType){case 1:return n.getAttribute(e);case 8:return t.virtualElements.virtualNodeBindingValue(n);default:return null}},parseBindingsString:function(e,t,r,i){try{var s=n(e,this.bindingCache,i);return s(t,r)}catch(o){throw o.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+o.message,o}}}),t.bindingProvider.instance=new t.bindingProvider}(),t.exportSymbol("bindingProvider",t.bindingProvider),function(){function n(e){return function(){return e}}function r(e){return e()}function i(e){return t.utils.objectMap(t.dependencyDetection.ignore(e),function(t,n){return function(){return e()[n]}})}function s(e,r,s){return typeof e=="function"?i(e.bind(null,r,s)):t.utils.objectMap(e,n)}function o(e,t){return i(this.getBindings.bind(this,e,t))}function u(e){var n=t.virtualElements.allowedBindings[e];if(!n)throw new Error("The binding '"+e+"' cannot be used with virtual elements")}function a(e,n,r){var i,s=t.virtualElements.firstChild(n),o=t.bindingProvider.instance,u=o.preprocessNode;if(u){while(i=s)s=t.virtualElements.nextSibling(i),u.call(o,i);s=t.virtualElements.firstChild(n)}while(i=s)s=t.virtualElements.nextSibling(i),f(e,i,r)}function f(n,r,i){var s=!0,o=r.nodeType===1;o&&t.virtualElements.normaliseVirtualElementDomStructure(r);var u=o&&i||t.bindingProvider.instance.nodeHasBindings(r);u&&(s=h(r,null,n,i).shouldBindDescendants),s&&!e[t.utils.tagNameLower(r)]&&a(n,r,!o)}function c(e){var n=[],r={},i=[];return t.utils.objectForEach(e,function s(o){if(!r[o]){var u=t.getBindingHandler(o);u&&(u.after&&(i.push(o),t.utils.arrayForEach(u.after,function(n){if(e[n]){if(t.utils.arrayIndexOf(i,n)!==-1)throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+i.join(", "));s(n)}}),i.length--),n.push({key:o,handler:u})),r[o]=!0}}),n}function h(e,n,i,s){var a=t.utils.domData.get(e,l);if(!n){if(a)throw Error("You cannot apply bindings multiple times to the same element.");t.utils.domData.set(e,l,!0)}!a&&s&&t.storedBindingContextForNode(e,i);var f;if(n&&typeof n!="function")f=n;else{var h=t.bindingProvider.instance,p=h.getBindingAccessors||o,d=t.dependentObservable(function(){return f=n?n(i,e):p.call(h,e,i),f&&i._subscribable&&i._subscribable(),f},null,{disposeWhenNodeIsRemoved:e});if(!f||!d.isActive())d=null}var v;if(f){var m=d?function(e){return function(){return r(d()[e])}}:function(e){return f[e]};function g(){return t.utils.objectMap(d?d():f,r)}g.get=function(e){return f[e]&&r(m(e))},g.has=function(e){return e in f};var y=c(f);t.utils.arrayForEach(y,function(n){var r=n.handler.init,s=n.handler.update,o=n.key;e.nodeType===8&&u(o);try{typeof r=="function"&&t.dependencyDetection.ignore(function(){var t=r(e,m(o),g,i.$data,i);if(t&&t.controlsDescendantBindings){if(v!==undefined)throw new Error("Multiple bindings ("+v+" and "+o+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");v=o}}),typeof s=="function"&&t.dependentObservable(function(){s(e,m(o),g,i.$data,i)},null,{disposeWhenNodeIsRemoved:e})}catch(a){throw a.message='Unable to process binding "'+o+": "+f[o]+'"\nMessage: '+a.message,a}})}return{shouldBindDescendants:v===undefined}}function d(e){return e&&e instanceof t.bindingContext?e:new t.bindingContext(e)}t.bindingHandlers={};var e={script:!0};t.getBindingHandler=function(e){return t.bindingHandlers[e]},t.bindingContext=function(e,n,r,i){function s(){var s=a?e():e,o=t.utils.unwrapObservable(s);return n?(n._subscribable&&n._subscribable(),t.utils.extend(u,n),l&&(u._subscribable=l)):(u.$parents=[],u.$root=o,u.ko=t),u.$rawData=s,u.$data=o,r&&(u[r]=o),i&&i(u,n,o),u.$data}function o(){return f&&!t.utils.anyDomNodeIsAttachedToDocument(f)}var u=this,a=typeof e=="function"&&!t.isObservable(e),f,l=t.dependentObservable(s,null,{disposeWhen:o,disposeWhenNodeIsRemoved:!0});l.isActive()&&(u._subscribable=l,l.equalityComparer=null,f=[],l._addNode=function(e){f.push(e),t.utils.domNodeDisposal.addDisposeCallback(e,function(e){t.utils.arrayRemoveItem(f,e),f.length||(l.dispose(),u._subscribable=l=undefined)})})},t.bindingContext.prototype.createChildContext=function(e,n,r){return new t.bindingContext(e,this,n,function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),r&&r(e)})},t.bindingContext.prototype.extend=function(e){return new t.bindingContext(this._subscribable||this.$data,this,null,function(n,r){n.$rawData=r.$rawData,t.utils.extend(n,typeof e=="function"?e():e)})};var l=t.utils.domData.nextKey(),p=t.utils.domData.nextKey();t.storedBindingContextForNode=function(e,n){if(arguments.length!=2)return t.utils.domData.get(e,p);t.utils.domData.set(e,p,n),n._subscribable&&n._subscribable._addNode(e)},t.applyBindingAccessorsToNode=function(e,n,r){return e.nodeType===1&&t.virtualElements.normaliseVirtualElementDomStructure(e),h(e,n,d(r),!0)},t.applyBindingsToNode=function(e,n,r){var i=d(r);return t.applyBindingAccessorsToNode(e,s(n,i,e),i)},t.applyBindingsToDescendants=function(e,t){(t.nodeType===1||t.nodeType===8)&&a(d(e),t,!0)},t.applyBindings=function(e,t){!jQuery&&window.jQuery&&(jQuery=window.jQuery);if(t&&t.nodeType!==1&&t.nodeType!==8)throw new Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||window.document.body,f(d(e),t,!0)},t.contextFor=function(e){switch(e.nodeType){case 1:case 8:var n=t.storedBindingContextForNode(e);if(n)return n;if(e.parentNode)return t.contextFor(e.parentNode)}return undefined},t.dataFor=function(e){var n=t.contextFor(e);return n?n.$data:undefined},t.exportSymbol("bindingHandlers",t.bindingHandlers),t.exportSymbol("applyBindings",t.applyBindings),t.exportSymbol("applyBindingsToDescendants",t.applyBindingsToDescendants),t.exportSymbol("applyBindingAccessorsToNode",t.applyBindingAccessorsToNode),t.exportSymbol("applyBindingsToNode",t.applyBindingsToNode),t.exportSymbol("contextFor",t.contextFor),t.exportSymbol("dataFor",t.dataFor)}();var h={"class":"className","for":"htmlFor"};t.bindingHandlers.attr={update:function(e,n,r){var i=t.utils.unwrapObservable(n())||{};t.utils.objectForEach(i,function(n,r){r=t.utils.unwrapObservable(r);var i=r===!1||r===null||r===undefined;i&&e.removeAttribute(n),t.utils.ieVersion<=8&&n in h?(n=h[n],i?e.removeAttribute(n):e[n]=r):i||e.setAttribute(n,r.toString()),n==="name"&&t.utils.setElementName(e,i?"":r.toString())})}},function(){t.bindingHandlers.checked={after:["value","attr"],init:function(e,n,r){function i(){return r.has("checkedValue")?t.utils.unwrapObservable(r.get("checkedValue")):e.value}function s(){var s=e.checked,o=c?i():s;if(t.computedContext.isInitial())return;if(a&&!s)return;var u=t.dependencyDetection.ignore(n);f?l!==o?(s&&(t.utils.addOrRemoveItem(u,o,!0),t.utils.addOrRemoveItem(u,l,!1)),l=o):t.utils.addOrRemoveItem(u,o,s):t.expressionRewriting.writeValueToProperty(u,r,"checked",o,!0)}function o(){var r=t.utils.unwrapObservable(n());f?e.checked=t.utils.arrayIndexOf(r,i())>=0:u?e.checked=r:e.checked=i()===r}var u=e.type=="checkbox",a=e.type=="radio";if(!u&&!a)return;var f=u&&t.utils.unwrapObservable(n())instanceof Array,l=f?i():undefined,c=a||f;a&&!e.name&&t.bindingHandlers.uniqueName.init(e,function(){return!0}),t.computed(s,null,{disposeWhenNodeIsRemoved:e}),t.utils.registerEventHandler(e,"click",s),t.computed(o,null,{disposeWhenNodeIsRemoved:e})}},t.expressionRewriting.twoWayBindings.checked=!0,t.bindingHandlers.checkedValue={update:function(e,n){e.value=t.utils.unwrapObservable(n())}}}();var p="__ko__cssValue";t.bindingHandlers.css={update:function(e,n){var r=t.utils.unwrapObservable(n());typeof r=="object"?t.utils.objectForEach(r,function(n,r){r=t.utils.unwrapObservable(r),t.utils.toggleDomNodeCssClass(e,n,r)}):(r=String(r||""),t.utils.toggleDomNodeCssClass(e,e[p],!1),e[p]=r,t.utils.toggleDomNodeCssClass(e,r,!0))}},t.bindingHandlers.enable={update:function(e,n){var r=t.utils.unwrapObservable(n());r&&e.disabled?e.removeAttribute("disabled"):!r&&!e.disabled&&(e.disabled=!0)}},t.bindingHandlers.disable={update:function(e,n){t.bindingHandlers.enable.update(e,function(){return!t.utils.unwrapObservable(n())})}},t.bindingHandlers.event={init:function(e,n,r,i,s){var o=n()||{};t.utils.objectForEach(o,function(o){typeof o=="string"&&t.utils.registerEventHandler(e,o,function(e){var u,a=n()[o];if(!a)return;try{var f=t.utils.makeArray(arguments);i=s.$data,f.unshift(i),u=a.apply(i,f)}finally{u!==!0&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}var l=r.get(o+"Bubble")!==!1;l||(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())})})}},t.bindingHandlers.foreach={makeTemplateValueAccessor:function(e){return function(){var n=e(),r=t.utils.peekObservable(n);return!r||typeof r.length=="number"?{foreach:n,templateEngine:t.nativeTemplateEngine.instance}:(t.utils.unwrapObservable(n),{foreach:r.data,as:r.as,includeDestroyed:r.includeDestroyed,afterAdd:r.afterAdd,beforeRemove:r.beforeRemove,afterRender:r.afterRender,beforeMove:r.beforeMove,afterMove:r.afterMove,templateEngine:t.nativeTemplateEngine.instance})}},init:function(e,n,r,i,s){return t.bindingHandlers.template.init(e,t.bindingHandlers.foreach.makeTemplateValueAccessor(n))},update:function(e,n,r,i,s){return t.bindingHandlers.template.update(e,t.bindingHandlers.foreach.makeTemplateValueAccessor(n),r,i,s)}},t.expressionRewriting.bindingRewriteValidators.foreach=!1,t.virtualElements.allowedBindings.foreach=!0;var v="__ko_hasfocusUpdating",m="__ko_hasfocusLastValue";t.bindingHandlers.hasfocus={init:function(e,n,r){var i=function(i){e[v]=!0;var s=e.ownerDocument;if("activeElement"in s){var o;try{o=s.activeElement}catch(u){o=s.body}i=o===e}var a=n();t.expressionRewriting.writeValueToProperty(a,r,"hasfocus",i,!0),e[m]=i,e[v]=!1},s=i.bind(null,!0),o=i.bind(null,!1);t.utils.registerEventHandler(e,"focus",s),t.utils.registerEventHandler(e,"focusin",s),t.utils.registerEventHandler(e,"blur",o),t.utils.registerEventHandler(e,"focusout",o)},update:function(e,n){var r=!!t.utils.unwrapObservable(n());!e[v]&&e[m]!==r&&(r?e.focus():e.blur(),t.dependencyDetection.ignore(t.utils.triggerEvent,null,[e,r?"focusin":"focusout"]))}},t.expressionRewriting.twoWayBindings.hasfocus=!0,t.bindingHandlers.hasFocus=t.bindingHandlers.hasfocus,t.expressionRewriting.twoWayBindings.hasFocus=!0,t.bindingHandlers.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,n){t.utils.setHtml(e,n())}},g("if"),g("ifnot",!1,!0),g("with",!0,!1,function(e,t){return e.createChildContext(t)});var y={};t.bindingHandlers.options={init:function(e){if(t.utils.tagNameLower(e)!=="select")throw new Error("options binding applies only to SELECT elements");while(e.length>0)e.remove(0);return{controlsDescendantBindings:!0}},update:function(e,n,r){function i(){return t.utils.arrayFilter(e.options,function(e){return e.selected})}function p(e,t,n){var r=typeof t;return r=="function"?t(e):r=="string"?e[t]:n}function v(n,i,s){s.length&&(h=s[0].selected?[t.selectExtensions.readValue(s[0])]:[],d=!0);var o=e.ownerDocument.createElement("option");if(n===y)t.utils.setTextContent(o,r.get("optionsCaption")),t.selectExtensions.writeValue(o,undefined);else{var u=p(n,r.get("optionsValue"),n);t.selectExtensions.writeValue(o,t.utils.unwrapObservable(u));var a=p(n,r.get("optionsText"),u);t.utils.setTextContent(o,a)}return[o]}function m(n,r){if(h.length){var i=t.utils.arrayIndexOf(h,t.selectExtensions.readValue(r[0]))>=0;t.utils.setOptionNodeSelectionState(r[0],i),d&&!i&&t.dependencyDetection.ignore(t.utils.triggerEvent,null,[e,"change"])}}var s=e.length==0,o=!s&&e.multiple?e.scrollTop:null,u=t.utils.unwrapObservable(n()),a=r.get("optionsIncludeDestroyed"),f={},l,c,h;e.multiple?h=t.utils.arrayMap(i(),t.selectExtensions.readValue):h=e.selectedIndex>=0?[t.selectExtensions.readValue(e.options[e.selectedIndex])]:[],u&&(typeof u.length=="undefined"&&(u=[u]),c=t.utils.arrayFilter(u,function(e){return a||e===undefined||e===null||!t.utils.unwrapObservable(e._destroy)}),r.has("optionsCaption")&&(l=t.utils.unwrapObservable(r.get("optionsCaption")),l!==null&&l!==undefined&&c.unshift(y)));var d=!1;f.beforeRemove=function(t){e.removeChild(t)};var g=m;r.has("optionsAfterRender")&&(g=function(e,n){m(e,n),t.dependencyDetection.ignore(r.get("optionsAfterRender"),null,[n[0],e!==y?e:undefined])}),t.utils.setDomNodeChildrenFromArrayMapping(e,c,v,f,g),t.dependencyDetection.ignore(function(){if(r.get("valueAllowUnset")&&r.has("value"))t.selectExtensions.writeValue(e,t.utils.unwrapObservable(r.get("value")),!0);else{var n;e.multiple?n=h.length&&i().length<h.length:n=h.length&&e.selectedIndex>=0?t.selectExtensions.readValue(e.options[e.selectedIndex])!==h[0]:h.length||e.selectedIndex>=0,n&&t.utils.triggerEvent(e,"change")}}),t.utils.ensureSelectElementIsRenderedCorrectly(e),o&&Math.abs(o-e.scrollTop)>20&&(e.scrollTop=o)}},t.bindingHandlers.options.optionValueDomDataKey=t.utils.domData.nextKey(),t.bindingHandlers.selectedOptions={after:["options","foreach"],init:function(e,n,r){t.utils.registerEventHandler(e,"change",function(){var i=n(),s=[];t.utils.arrayForEach(e.getElementsByTagName("option"),function(e){e.selected&&s.push(t.selectExtensions.readValue(e))}),t.expressionRewriting.writeValueToProperty(i,r,"selectedOptions",s)})},update:function(e,n){if(t.utils.tagNameLower(e)!="select")throw new Error("values binding applies only to SELECT elements");var r=t.utils.unwrapObservable(n());r&&typeof r.length=="number"&&t.utils.arrayForEach(e.getElementsByTagName("option"),function(e){var n=t.utils.arrayIndexOf(r,t.selectExtensions.readValue(e))>=0;t.utils.setOptionNodeSelectionState(e,n)})}},t.expressionRewriting.twoWayBindings.selectedOptions=!0,t.bindingHandlers.style={update:function(e,n){var r=t.utils.unwrapObservable(n()||{});t.utils.objectForEach(r,function(n,r){r=t.utils.unwrapObservable(r),e.style[n]=r||""})}},t.bindingHandlers.submit={init:function(e,n,r,i,s){if(typeof n()!="function")throw new Error("The value for a submit binding must be a function");t.utils.registerEventHandler(e,"submit",function(t){var r,i=n();try{r=i.call(s.$data,e)}finally{r!==!0&&(t.preventDefault?t.preventDefault():t.returnValue=!1)}})}},t.bindingHandlers.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,n){t.utils.setTextContent(e,n())}},t.virtualElements.allowedBindings.text=!0,t.bindingHandlers.uniqueName={init:function(e,n){if(n()){var r="ko_unique_"+ ++t.bindingHandlers.uniqueName.currentIndex;t.utils.setElementName(e,r)}}},t.bindingHandlers.uniqueName.currentIndex=0,t.bindingHandlers.value={after:["options","foreach"],init:function(e,n,r){var i=["change"],s=r.get("valueUpdate"),o=!1;s&&(typeof s=="string"&&(s=[s]),t.utils.arrayPushAll(i,s),i=t.utils.arrayGetDistinctValues(i));var u=function(){o=!1;var i=n(),s=t.selectExtensions.readValue(e);t.expressionRewriting.writeValueToProperty(i,r,"value",s)},a=t.utils.ieVersion&&e.tagName.toLowerCase()=="input"&&e.type=="text"&&e.autocomplete!="off"&&(!e.form||e.form.autocomplete!="off");a&&t.utils.arrayIndexOf(i,"propertychange")==-1&&(t.utils.registerEventHandler(e,"propertychange",function(){o=!0}),t.utils.registerEventHandler(e,"focus",function(){o=!1}),t.utils.registerEventHandler(e,"blur",function(){o&&u()})),t.utils.arrayForEach(i,function(n){var r=u;t.utils.stringStartsWith(n,"after")&&(r=function(){setTimeout(u,0)},n=n.substring("after".length)),t.utils.registerEventHandler(e,n,r)})},update:function(e,n,r){var i=t.utils.unwrapObservable(n()),s=t.selectExtensions.readValue(e),o=i!==s;if(o)if(t.utils.tagNameLower(e)==="select"){var u=r.get("valueAllowUnset"),a=function(){t.selectExtensions.writeValue(e,i,u)};a(),!u&&i!==t.selectExtensions.readValue(e)?t.dependencyDetection.ignore(t.utils.triggerEvent,null,[e,"change"]):setTimeout(a,0)}else t.selectExtensions.writeValue(e,i)}},t.expressionRewriting.twoWayBindings.value=!0,t.bindingHandlers.visible={update:function(e,n){var r=t.utils.unwrapObservable(n()),i=e.style.display!="none";r&&!i?e.style.display="":!r&&i&&(e.style.display="none")}},d("click"),t.templateEngine=function(){},t.templateEngine.prototype.renderTemplateSource=function(e,t,n){throw new Error("Override renderTemplateSource")},t.templateEngine.prototype.createJavaScriptEvaluatorBlock=function(e){throw new Error("Override createJavaScriptEvaluatorBlock")},t.templateEngine.prototype.makeTemplateSource=function(e,n){if(typeof e=="string"){n=n||document;var r=n.getElementById(e);if(!r)throw new Error("Cannot find template with ID "+e);return new t.templateSources.domElement(r)}if(e.nodeType==1||e.nodeType==8)return new t.templateSources.anonymousTemplate(e);throw new Error("Unknown template type: "+e)},t.templateEngine.prototype.renderTemplate=function(e,t,n,r){var i=this.makeTemplateSource(e,r);return this.renderTemplateSource(i,t,n)},t.templateEngine.prototype.isTemplateRewritten=function(e,t){return this.allowTemplateRewriting===!1?!0:this.makeTemplateSource(e,t).data("isRewritten")},t.templateEngine.prototype.rewriteTemplate=function(e,t,n){var r=this.makeTemplateSource(e,n),i=t(r.text());r.text(i),r.data("isRewritten",!0)},t.exportSymbol("templateEngine",t.templateEngine),t.templateRewriting=function(){function r(e){var n=t.expressionRewriting.bindingRewriteValidators;for(var r=0;r<e.length;r++){var i=e[r].key;if(n.hasOwnProperty(i)){var s=n[i];if(typeof s=="function"){var o=s(e[r].value);if(o)throw new Error(o)}else if(!s)throw new Error("This template engine does not support the '"+i+"' binding within its templates")}}}function i(e,n,i,s){var o=t.expressionRewriting.parseObjectLiteral(e);r(o);var u=t.expressionRewriting.preProcessBindings(o,{valueAccessors:!0}),a="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+u+" } })()},'"+i.toLowerCase()+"')";return s.createJavaScriptEvaluatorBlock(a)+n}var e=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,n=/<!--\s*ko\b\s*([\s\S]*?)\s*-->/g;return{ensureTemplateIsRewritten:function(e,n,r){n.isTemplateRewritten(e,r)||n.rewriteTemplate(e,function(e){return t.templateRewriting.memoizeBindingAttributeSyntax(e,n)},r)},memoizeBindingAttributeSyntax:function(t,r){return t.replace(e,function(){return i(arguments[4],arguments[1],arguments[2],r)}).replace(n,function(){return i(arguments[1],"<!-- ko -->","#comment",r)})},applyMemoizedBindingsToNextSibling:function(e,n){return t.memoization.memoize(function(r,i){var s=r.nextSibling;s&&s.nodeName.toLowerCase()===n&&t.applyBindingAccessorsToNode(s,e,i)})}}}(),t.exportSymbol("__tr_ambtns",t.templateRewriting.applyMemoizedBindingsToNextSibling),function(){t.templateSources={},t.templateSources.domElement=function(e){this.domElement=e},t.templateSources.domElement.prototype.text=function(){var e=t.utils.tagNameLower(this.domElement),n=e==="script"?"text":e==="textarea"?"value":"innerHTML";if(arguments.length==0)return this.domElement[n];var r=arguments[0];n==="innerHTML"?t.utils.setHtml(this.domElement,r):this.domElement[n]=r};var e=t.utils.domData.nextKey()+"_";t.templateSources.domElement.prototype.data=function(n){if(arguments.length===1)return t.utils.domData.get(this.domElement,e+n);t.utils.domData.set(this.domElement,e+n,arguments[1])};var n=t.utils.domData.nextKey();t.templateSources.anonymousTemplate=function(e){this.domElement=e},t.templateSources.anonymousTemplate.prototype=new t.templateSources.domElement,t.templateSources.anonymousTemplate.prototype.constructor=t.templateSources.anonymousTemplate,t.templateSources.anonymousTemplate.prototype.text=function(){if(arguments.length==0){var e=t.utils.domData.get(this.domElement,n)||{};return e.textData===undefined&&e.containerData&&(e.textData=e.containerData.innerHTML),e.textData}var r=arguments[0];t.utils.domData.set(this.domElement,n,{textData:r})},t.templateSources.domElement.prototype.nodes=function(){if(arguments.length==0){var e=t.utils.domData.get(this.domElement,n)||{};return e.containerData}var r=arguments[0];t.utils.domData.set(this.domElement,n,{containerData:r})},t.exportSymbol("templateSources",t.templateSources),t.exportSymbol("templateSources.domElement",t.templateSources.domElement),t.exportSymbol("templateSources.anonymousTemplate",t.templateSources.anonymousTemplate)}(),function(){function n(e,n,r){var i,s=e,o=t.virtualElements.nextSibling(n);while(s&&(i=s)!==o)s=t.virtualElements.nextSibling(i),r(i,s)}function r(e,r){if(e.length){var i=e[0],s=e[e.length-1],o=i.parentNode,u=t.bindingProvider.instance,a=u.preprocessNode;if(a){n(i,s,function(e,t){var n=e.previousSibling,r=a.call(u,e);r&&(e===i&&(i=r[0]||t),e===s&&(s=r[r.length-1]||n))}),e.length=0;if(!i)return;i===s?e.push(i):(e.push(i,s),t.utils.fixUpContinuousNodeArray(e,o))}n(i,s,function(e){(e.nodeType===1||e.nodeType===8)&&t.applyBindings(r,e)}),n(i,s,function(e){(e.nodeType===1||e.nodeType===8)&&t.memoization.unmemoizeDomNodeAndDescendants(e,[r])}),t.utils.fixUpContinuousNodeArray(e,o)}}function i(e){return e.nodeType?e:e.length>0?e[0]:null}function s(n,s,o,u,a){a=a||{};var f=n&&i(n),l=f&&f.ownerDocument,c=a.templateEngine||e;t.templateRewriting.ensureTemplateIsRewritten(o,c,l);var h=c.renderTemplate(o,u,a,l);if(typeof h.length!="number"||h.length>0&&typeof h[0].nodeType!="number")throw new Error("Template engine must return an array of DOM nodes");var p=!1;switch(s){case"replaceChildren":t.virtualElements.setDomNodeChildren(n,h),p=!0;break;case"replaceNode":t.utils.replaceDomNodes(n,h),p=!0;break;case"ignoreTargetNode":break;default:throw new Error("Unknown renderMode: "+s)}return p&&(r(h,u),a.afterRender&&t.dependencyDetection.ignore(a.afterRender,null,[h,u.$data])),h}function u(e,n){var r=t.utils.domData.get(e,o);r&&typeof r.dispose=="function"&&r.dispose(),t.utils.domData.set(e,o,n&&n.isActive()?n:undefined)}var e;t.setTemplateEngine=function(n){if(!(n==undefined||n instanceof t.templateEngine))throw new Error("templateEngine must inherit from ko.templateEngine");e=n},t.renderTemplate=function(n,r,o,u,a){o=o||{};if((o["templateEngine"]||e)==undefined)throw new Error("Set a template engine before calling renderTemplate");a=a||"replaceChildren";if(u){var f=i(u),l=function(){return!f||!t.utils.domNodeIsAttachedToDocument(f)},c=f&&a=="replaceNode"?f.parentNode:f;return t.dependentObservable(function(){var e=r&&r instanceof t.bindingContext?r:new t.bindingContext(t.utils.unwrapObservable(r)),l=t.isObservable(n)?n():typeof n=="function"?n(e.$data,e):n,c=s(u,a,l,e,o);a=="replaceNode"&&(u=c,f=i(u))},null,{disposeWhen:l,disposeWhenNodeIsRemoved:c})}return t.memoization.memoize(function(e){t.renderTemplate(n,r,o,e,"replaceNode")})},t.renderTemplateForEach=function(e,n,i,o,u){var a,f=function(t,n){a=u.createChildContext(t,i.as,function(e){e.$index=n});var r=typeof e=="function"?e(t,a):e;return s(null,"ignoreTargetNode",r,a,i)},l=function(e,t,n){r(t,a),i.afterRender&&i.afterRender(t,e)};return t.dependentObservable(function(){var e=t.utils.unwrapObservable(n)||[];typeof e.length=="undefined"&&(e=[e]);var r=t.utils.arrayFilter(e,function(e){return i.includeDestroyed||e===undefined||e===null||!t.utils.unwrapObservable(e._destroy)});t.dependencyDetection.ignore(t.utils.setDomNodeChildrenFromArrayMapping,null,[o,r,f,i,l])},null,{disposeWhenNodeIsRemoved:o})};var o=t.utils.domData.nextKey();t.bindingHandlers.template={init:function(e,n){var r=t.utils.unwrapObservable(n());if(typeof r=="string"||r.name)t.virtualElements.emptyNode(e);else{var i=t.virtualElements.childNodes(e),s=t.utils.moveCleanedNodesToContainerElement(i);(new t.templateSources.anonymousTemplate(e)).nodes(s)}return{controlsDescendantBindings:!0}},update:function(e,n,r,i,s){var o=n(),a,f=t.utils.unwrapObservable(o),l=!0,c=null,h;typeof f=="string"?(h=o,f={}):(h=f.name,"if"in f&&(l=t.utils.unwrapObservable(f["if"])),l&&"ifnot"in f&&(l=!t.utils.unwrapObservable(f.ifnot)),a=t.utils.unwrapObservable(f.data));if("foreach"in f){var p=l&&f.foreach||[];c=t.renderTemplateForEach(h||e,p,f,e,s)}else if(!l)t.virtualElements.emptyNode(e);else{var d="data"in f?s.createChildContext(a,f.as):s;c=t.renderTemplate(h||e,d,f,e)}u(e,c)}},t.expressionRewriting.bindingRewriteValidators.template=function(e){var n=t.expressionRewriting.parseObjectLiteral(e);return n.length==1&&n[0].unknown?null:t.expressionRewriting.keyValueArrayContainsKey(n,"name")?null:"This template engine does not support anonymous templates nested within its templates"},t.virtualElements.allowedBindings.template=!0}(),t.exportSymbol("setTemplateEngine",t.setTemplateEngine),t.exportSymbol("renderTemplate",t.renderTemplate),t.utils.findMovesInArrayComparison=function(e,t,n){if(e.length&&t.length){var r,i,s,o,u;for(r=i=0;(!n||r<n)&&(o=e[i]);++i){for(s=0;u=t[s];++s)if(o.value===u.value){o.moved=u.index,u.moved=o.index,t.splice(s,1),r=s=0;break}r+=s}}},t.utils.compareArrays=function(){function r(t,r,s){return s=typeof s=="boolean"?{dontLimitMoves:s}:s||{},t=t||[],r=r||[],t.length<=r.length?i(t,r,e,n,s):i(r,t,n,e,s)}function i(e,n,r,i,s){var o=Math.min,u=Math.max,a=[],f,l=e.length,c,h=n.length,p=h-l||1,d=l+h+1,v,m,g,y;for(f=0;f<=l;f++){m=v,a.push(v=[]),g=o(h,f+p),y=u(0,f-1);for(c=y;c<=g;c++)if(!c)v[c]=f+1;else if(!f)v[c]=c+1;else if(e[f-1]===n[c-1])v[c]=m[c-1];else{var b=m[c]||d,w=v[c-1]||d;v[c]=o(b,w)+1}}var E=[],S,x=[],T=[];for(f=l,c=h;f||c;)S=a[f][c]-1,c&&S===a[f][c-1]?x.push(E[E.length]={status:r,value:n[--c],index:c}):f&&S===a[f-1][c]?T.push(E[E.length]={status:i,value:e[--f],index:f}):(--c,--f,s.sparse||E.push({status:"retained",value:n[c]}));return t.utils.findMovesInArrayComparison(x,T,l*10),E.reverse()}var e="added",n="deleted";return r}(),t.exportSymbol("utils.compareArrays",t.utils.compareArrays),function(){function e(e,n,r,i,s){var o=[],u=t.dependentObservable(function(){var u=n(r,s,t.utils.fixUpContinuousNodeArray(o,e))||[];o.length>0&&(t.utils.replaceDomNodes(o,u),i&&t.dependencyDetection.ignore(i,null,[r,u,s])),o.length=0,t.utils.arrayPushAll(o,u)},null,{disposeWhenNodeIsRemoved:e,disposeWhen:function(){return!t.utils.anyDomNodeIsAttachedToDocument(o)}});return{mappedNodes:o,dependentObservable:u.isActive()?u:undefined}}var n=t.utils.domData.nextKey();t.utils.setDomNodeChildrenFromArrayMapping=function(r,i,s,o,u){function E(e,n){w=f[n],d!==n&&(y[e]=w),w.indexObservable(d++),t.utils.fixUpContinuousNodeArray(w.mappedNodes,r),h.push(w),m.push(w)}function S(e,n){if(e)for(var r=0,i=n.length;r<i;r++)n[r]&&t.utils.arrayForEach(n[r].mappedNodes,function(t){e(t,r,n[r].arrayEntry)})}i=i||[],o=o||{};var a=t.utils.domData.get(r,n)===undefined,f=t.utils.domData.get(r,n)||[],l=t.utils.arrayMap(f,function(e){return e.arrayEntry}),c=t.utils.compareArrays(l,i,o.dontLimitMoves),h=[],p=0,d=0,v=[],m=[],g=[],y=[],b=[],w;for(var x=0,T,N;T=c[x];x++){N=T.moved;switch(T.status){case"deleted":N===undefined&&(w=f[p],w.dependentObservable&&w.dependentObservable.dispose(),v.push.apply(v,t.utils.fixUpContinuousNodeArray(w.mappedNodes,r)),o.beforeRemove&&(g[x]=w,m.push(w))),p++;break;case"retained":E(x,p++);break;case"added":N!==undefined?E(x,N):(w={arrayEntry:T.value,indexObservable:t.observable(d++)},h.push(w),m.push(w),a||(b[x]=w))}}S(o.beforeMove,y),t.utils.arrayForEach(v,o.beforeRemove?t.cleanNode:t.removeNode);for(var x=0,C=t.virtualElements.firstChild(r),k,L;w=m[x];x++){w.mappedNodes||t.utils.extend(w,e(r,s,w.arrayEntry,u,w.indexObservable));for(var A=0;L=w.mappedNodes[A];C=L.nextSibling,k=L,A++)L!==C&&t.virtualElements.insertAfter(r,L,k);!w.initialized&&u&&(u(w.arrayEntry,w.mappedNodes,w.indexObservable),w.initialized=!0)}S(o.beforeRemove,g),S(o.afterMove,y),S(o.afterAdd,b),t.utils.domData.set(r,n,h)}}(),t.exportSymbol("utils.setDomNodeChildrenFromArrayMapping",t.utils.setDomNodeChildrenFromArrayMapping),t.nativeTemplateEngine=function(){this.allowTemplateRewriting=!1},t.nativeTemplateEngine.prototype=new t.templateEngine,t.nativeTemplateEngine.prototype.constructor=t.nativeTemplateEngine,t.nativeTemplateEngine.prototype.renderTemplateSource=function(e,n,r){var i=!(t.utils.ieVersion<9),s=i?e.nodes:null,o=s?e.nodes():null;if(o)return t.utils.makeArray(o.cloneNode(!0).childNodes);var u=e.text();return t.utils.parseHtmlFragment(u)},t.nativeTemplateEngine.instance=new t.nativeTemplateEngine,t.setTemplateEngine(t.nativeTemplateEngine.instance),t.exportSymbol("nativeTemplateEngine",t.nativeTemplateEngine),function(){t.jqueryTmplTemplateEngine=function(){function t(){if(e<2)throw new Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.")}function n(e,t,n){return jQuery.tmpl(e,t,n)}var e=this.jQueryTmplVersion=function(){if(!jQuery||!jQuery.tmpl)return 0;try{if(jQuery.tmpl.tag.tmpl.open.toString().indexOf("__")>=0)return 2}catch(e){}return 1}();this.renderTemplateSource=function(e,r,i){i=i||{},t();var s=e.data("precompiled");if(!s){var o=e.text()||"";o="{{ko_with $item.koBindingContext}}"+o+"{{/ko_with}}",s=jQuery.template(null,o),e.data("precompiled",s)}var u=[r.$data],a=jQuery.extend({koBindingContext:r},i.templateOptions),f=n(s,u,a);return f.appendTo(document.createElement("div")),jQuery.fragments={},f},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){document.write("<script type='text/html' id='"+e+"'>"+t+"<"+"/script>")},e>0&&(jQuery.tmpl.tag.ko_code={open:"__.push($1 || '');"},jQuery.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},t.jqueryTmplTemplateEngine.prototype=new t.templateEngine,t.jqueryTmplTemplateEngine.prototype.constructor=t.jqueryTmplTemplateEngine;var e=new t.jqueryTmplTemplateEngine;e.jQueryTmplVersion>0&&t.setTemplateEngine(e),t.exportSymbol("jqueryTmplTemplateEngine",t.jqueryTmplTemplateEngine)}()})})()}(),function(){return function(e){typeof define=="function"&&define.amd?define(["require","underscore","backbone","knockout"],e):typeof exports=="object"?module.exports=module.exports=e.call(this,require):this.kb=e.call(this,typeof require!="undefined"?require:undefined)}(function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z=function(e,t){return function(){return e.apply(t,arguments)}},W=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};b=function(){function e(){}return e.VERSION="0.18.6",e.TYPE_UNKNOWN=0,e.TYPE_SIMPLE=1,e.TYPE_ARRAY=2,e.TYPE_MODEL=3,e.TYPE_COLLECTION=4,e.wasReleased=function(e){return!e||e.__kb_released},e.isReleaseable=function(t,n){var r,i;n==null&&(n=0);if(!t||t!==Object(t)||t.__kb_released)return!1;if(w.isObservable(t)||t instanceof e.ViewModel)return!0;if(typeof t=="function"||t instanceof e.Model||t instanceof e.Collection)return!1;if(typeof t.dispose=="function"||typeof t.destroy=="function"||typeof t.release=="function")return!0;if(n<1)for(r in t){i=t[r];if(r!=="__kb"&&e.isReleaseable(i,n+1))return!0}return!1},e.release=function(t){var n,r,i;if(!e.isReleaseable(t))return;if(S.isArray(t)){for(r in t)i=t[r],e.isReleaseable(i)&&(t[r]=null,e.release(i));return}t.__kb_released=!0;if(w.isObservable(t)&&S.isArray(n=P(t))){if(t.__kb_is_co||t.__kb_is_o&&t.valueType()===o)t.destroy?t.destroy():t.dispose&&t.dispose();else if(n.length)for(r in n)i=n[r],e.isReleaseable(i)&&(n[r]=null,e.release(i))}else typeof t.release=="function"?t.release():typeof t.destroy=="function"?t.destroy():typeof t.dispose=="function"?t.dispose():w.isObservable(t)||this.releaseKeys(t)},e.releaseKeys=function(t){var n,r;for(n in t)r=t[n],n!=="__kb"&&e.isReleaseable(r)&&(t[n]=null,e.release(r))},e.releaseOnNodeRemove=function(t,n){return t||I(this,"missing view model"),n||I(this,"missing node"),w.utils.domNodeDisposal.addDisposeCallback(n,function(){return e.release(t)})},e.renderTemplate=function(t,n,r){var i,s;return r==null&&(r={}),typeof document=="undefined"||document===null?typeof console!="undefined"&&console!==null?console.log("renderTemplate: document is undefined"):void 0:(i=document.createElement("div"),s=w.renderTemplate(t,n,r,i,"replaceChildren"),i.children.length===1&&(i=i.children[0]),e.releaseOnNodeRemove(n,i),s.dispose(),n.afterRender&&!r.afterRender&&n.afterRender(i),i)},e.applyBindings=function(t,n){return w.applyBindings(t,n),e.releaseOnNodeRemove(t,n)},e.getValue=function(t,n,r){if(!t)return;return S.isFunction(t[n])&&e.orm.useFunction(t,n)?t[n]():r?t.get.apply(t,S.map([n].concat(r),function(e){return P(e)})):t.get(n)},e.setValue=function(t,n,r){var i;if(!t)return;return S.isFunction(t[n])&&e.orm.useFunction(t,n)?t[n](r):((i={})[n]=r,t.set(i))},e}(),f=b.TYPE_UNKNOWN,a=b.TYPE_SIMPLE,s=b.TYPE_ARRAY,u=b.TYPE_MODEL,o=b.TYPE_COLLECTION,b.ko=w=this.ko||e("knockout");if(this.Parse)S=this.Parse._;else if(!(S=this._)){B=["lodash","underscore"];for(C=0,M=B.length;C<M;C++){k=B[C];try{S=e(k)}catch(X){}finally{if(S)break}}}b._=S,this.Parse?(b.Parse=this.Parse,b.Collection=this.Parse.Collection,b.Model=this.Parse.Object,b.Events=this.Parse.Events):(b.Backbone=this.Backbone||e("backbone"),b.Collection=b.Backbone.Collection,b.Model=b.Backbone.Model,b.Events=b.Backbone.Events),c=function(){function e(){this.adapters=[]}return e.prototype.initialize=function(){return this.adapters=S.select(this.adapters,function(e){return e.isAvailable()}),this.initialized=!0},e.prototype.addAdapter=function(e){return this.adapters.push(e),this.initialized=!1},e.prototype.keys=function(e){return this._call("keys",arguments)},e.prototype.bind=function(e){return this._call("bind",arguments)},e.prototype.useFunction=function(e){return this._call("useFunction",arguments)},e.prototype._call=function(e,t){var n,r,i,s,o;if(!this.adapters.length)return;this.initialized||this.initialize(),o=this.adapters;for(i=0,s=o.length;i<s;i++){n=o[i];if(n[e]&&(r=n[e].apply(n,t)))return r}},e}(),b.orm=new c,p=function(){function t(){}return t.prototype.isAvailable=function(){var t,n;try{((t=b.Backbone)!=null?t.RelationalModel:void 0)||(typeof e=="function"?e("backbone-relational"):void 0)}catch(r){}return(n=b.Backbone)!=null?!!n.RelationalModel:!!void 0},t.prototype.relationType=function(e,t){var n;return e instanceof b.Backbone.RelationalModel?(n=S.find(e.getRelations(),function(e){return e.key===t}))?n.collectionType||S.isArray(n.keyContents)?o:u:null:null},t.prototype.bind=function(e,t,n,r){var i,s,u,a,f,l;if(!(a=this.relationType(e,t)))return null;u=function(e){return!b.statistics||b.statistics.addModelEvent({name:"update (relational)",model:e,key:t,path:r}),n()},s=Backbone.Relation.prototype.sanitizeOptions?["update","add","remove"]:["change","add","remove"];if(a===o)for(f=0,l=s.length;f<l;f++)i=s[f],e.bind(""+i+":"+t,u);else e.bind(""+s[0]+":"+t,u);return function(){var n,r;if(a===o)for(n=0,r=s.length;n<r;n++)i=s[n],e.unbind(""+i+":"+t,u);else e.unbind(""+s[0]+":"+t,u)}},t}(),b.orm.addAdapter(new p),h=function(){function t(){}return t.prototype.isAvailable=function(){var t,n;try{((t=b.Backbone)!=null?t.AssociatedModel:void 0)||(typeof e=="function"?e("backbone-associations"):void 0)}catch(r){}return(n=b.Backbone)!=null?!!n.AssociatedModel:!!void 0},t.prototype.keys=function(e){return e instanceof b.Backbone.AssociatedModel?S.map(e.relations,function(e){return e.key}):null},t.prototype.relationType=function(e,t){var n;return e instanceof b.Backbone.AssociatedModel?(n=S.find(e.relations,function(e){return e.key===t}))?n.type==="Many"?o:u:null:null},t}(),b.orm.addAdapter(new h),d=function(){function t(){}return t.prototype.isAvailable=function(){try{(typeof window!="undefined"&&window!==null?window.Supermodel:void 0)||(typeof e=="function"?e("supermodel"):void 0)}catch(t){}return typeof window!="undefined"&&window!==null?!!window.Supermodel:!!void 0},t.prototype.keys=function(e){return e instanceof Supermodel.Model?S.keys(e.constructor.associations()):null},t.prototype.relationType=function(e,t){var n;return e instanceof Supermodel.Model?(n=e.constructor.associations()[t])?n.add?o:u:null:null},t.prototype.bind=function(e,t,n,r){var i,s;if(!(s=this.relationType(e,t)))return null;i=function(e,i){var s,o;return!b.statistics||b.statistics.addModelEvent({name:"update (supermodel)",model:e,key:t,path:r}),o=e.constructor.associations()[t],s=e[o.store],e[o.store]=i,n(i),e[o.store]=s};if(s===u)return e.bind("associate:"+t,i),function(){return e.unbind("associate:"+t,i)}},t.prototype.useFunction=function(e,t){return!!this.relationType(e,t)},t}(),b.orm.addAdapter(new d),F=function(e,t){throw""+(S.isString(e)?e:e.constructor.name)+": "+t+" is missing"},I=function(e,t){throw""+(S.isString(e)?e:e.constructor.name)+": "+t+" is unexpected"},O=function(e,t,n){var r;return this._legacy_warnings||(this._legacy_warnings={}),(r=this._legacy_warnings)[e]||(r[e]=0),this._legacy_warnings[e]++,typeof console!="undefined"&&console!==null?console.warn("warning: '"+e+"' has been deprecated (will be removed in Knockback after "+t+"). "+n+"."):void 0},T=Array.prototype.splice,R=w.utils.unwrapObservable,P=function(e){return w.isObservable(e)?e.peek?e.peek():b.ignore(function(){return e()}):e},H=b._publishMethods=function(e,t,n){var r,i,s;for(i=0,s=n.length;i<s;i++)r=n[i],e[r]=b._.bind(t[r],t)},y=function(e,t){var n,r;for(n in t)r=t[n],e[n]=r;return e};var V=function(){},J=function(e,t,n){var r;return t&&t.hasOwnProperty("constructor")?r=t.constructor:r=function(){e.apply(this,arguments)},y(r,e),V.prototype=e.prototype,r.prototype=new V,t&&y(r.prototype,t),n&&y(r,n),r.prototype.constructor=r,r.__super__=e.prototype,r},K=function(e,t){var n=J(this,e,t);return n.extend=this.extend,n};return b.extend=K,U=function(e,t,n){return arguments.length===2?e&&e.__kb&&e.__kb.hasOwnProperty(t)?e.__kb[t]:void 0:(e||I(this,"no obj for wrapping "+t),e.__kb||(e.__kb={}),e.__kb[t]=n,n)},x=function(e,t){return T.call(e,1,0,t),e},q=function(e){var t,n,r;if(!e)return e;if(e.__kb)return"object"in e.__kb?e.__kb.object:e;if(S.isArray(e))return S.map(e,function(e){return q(e)});if(S.isObject(e)&&e.constructor==={}.constructor){n={};for(t in e)r=e[t],n[t]=q(r);return n}return e},_=function(e,t,n){return e[t]||(e[t]=[]),S.isArray(n)||(n=[n]),e[t]=e[t].length?S.union(e[t],n):n,e},D=function(e,t,n){return e[t]||(e[t]={}),S.extend(e[t],n)},L=function(e){var t,n,r,i;n={};for(r=0,i=e.length;r<i;r++)t=e[r],n[t]={key:t};return n},N=function(e){var t,n,r,i;n={},e={options:e};while(e.options){i=e.options;for(t in i){r=i[t];switch(t){case"internals":case"requires":case"excludes":case"statics":_(n,t,r);break;case"keys":S.isObject(r)&&!S.isArray(r)||S.isObject(n[t])&&!S.isArray(n[t])?(S.isObject(r)||(r=[r]),S.isArray(r)&&(r=L(r)),S.isArray(n[t])&&(n[t]=L(n[t])),D(n,t,r)):_(n,t,r);break;case"factories":S.isFunction(r)?n[t]=r:D(n,t,r);break;case"static_defaults":D(n,t,r);break;case"options":break;default:n[t]=r}}e=e.options}return n},b.utils=function(){function e(){}return e.wrappedObservable=function(e,t){return U.apply(this,x(arguments,"observable"))},e.wrappedObject=function(e,t){return U.apply(this,x(arguments,"object"))},e.wrappedModel=function(e,t){return arguments.length===1?(t=U(e,"object"),S.isUndefined(t)?e:t):U(e,"object",t)},e.wrappedStore=function(e,t){return U.apply(this,x(arguments,"store"))},e.wrappedStoreIsOwned=function(e,t){return U.apply(this,x(arguments,"store_is_owned"))},e.wrappedFactory=function(e,t){return U.apply(this,x(arguments,"factory"))},e.wrappedEventWatcher=function(e,t){return U.apply(this,x(arguments,"event_watcher"))},e.wrappedEventWatcherIsOwned=function(e,t){return U.apply(this,x(arguments,"event_watcher_is_owned"))},e.wrappedDestroy=function(e){var t;if(!e.__kb)return;return e.__kb.event_watcher&&e.__kb.event_watcher.releaseCallbacks(e),t=e.__kb,e.__kb=null,t.observable&&(t.observable.destroy=t.observable.release=null,this.wrappedDestroy(t.observable),t.observable=null),t.factory=null,t.event_watcher_is_owned&&t.event_watcher.destroy(),t.event_watcher=null,t.store_is_owned&&t.store.destroy(),t.store=null},e.valueType=function(e){return e?e.__kb_is_o?e.valueType():e.__kb_is_co||e instanceof b.Collection?o:e instanceof b.ViewModel||e instanceof b.Model?u:S.isArray(e)?s:a:f},e.pathJoin=function(e,t){return(e?e[e.length-1]!=="."?""+e+".":e:"")+t},e.optionsPathJoin=function(e,t){return S.defaults({path:this.pathJoin(e.path,t)},e)},e.inferCreator=function(e,t,n,r,i){var s;return t&&(s=t.creatorForPath(e,n)),s?s:e?e instanceof b.Model?b.ViewModel:e instanceof b.Collection?b.CollectionObservable:null:null},e.createFromDefaultCreator=function(e,t){return e instanceof b.Model?b.viewModel(e,t):e instanceof b.Collection?b.collectionObservable(e,t):S.isArray(e)?w.observableArray(e):w.observable(e)},e.hasModelSignature=function(e){return e&&e.attributes&&!e.models&&typeof e.get=="function"&&typeof e.trigger=="function"},e.hasCollectionSignature=function(e){return e&&e.models&&typeof e.get=="function"&&typeof e.trigger=="function"},e.collapseOptions=N,e}(),b.ignore=((j=w.dependencyDetection)!=null?j.ignore:void 0)||function(e,t,n){var r;return r=null,w.dependentObservable(function(){return r=e.apply(t,n||[])}).dispose(),r},b.Factory=function(){function e(e){this.parent_factory=e,this.paths={}}return e.useOptionsOrCreate=function(e,t,n){var r;return e.factory&&(!e.factories||e.factories&&e.factory.hasPathMappings(e.factories,n))?b.utils.wrappedFactory(t,e.factory):(r=b.utils.wrappedFactory(t,new b.Factory(e.factory)),e.factories&&r.addPathMappings(e.factories,n),r)},e.prototype.hasPath=function(e){return this.paths.hasOwnProperty(e)||this.parent_factory&&this.parent_factory.hasPath(e)},e.prototype.addPathMapping=function(e,t){return this.paths[e]=t},e.prototype.addPathMappings=function(e,t){var n,r;for(r in e)n=e[r],this.paths[b.utils.pathJoin(t,r)]=n},e.prototype.hasPathMappings=function(e,t){var n,r,i,s;n=!0;for(s in e)r=e[s],n&=(i=this.creatorForPath(null,b.utils.pathJoin(t,s)))&&r===i;return n},e.prototype.creatorForPath=function(e,t){var n;if(n=this.paths[t])return n.view_model?n.view_model:n;if(this.parent_factory)if(n=this.parent_factory.creatorForPath(e,t))return n;return null},e}(),b.Store=function(){function e(){this.observable_records=[],this.replaced_observables=[]}return e.useOptionsOrCreate=function(e,t,n){return e.store?(e.store.register(t,n,e),b.utils.wrappedStore(n,e.store)):(b.utils.wrappedStoreIsOwned(n,!0),b.utils.wrappedStore(n,new b.Store))},e.prototype.destroy=function(){return this.clear()},e.prototype.clear=function(){var e,t,n,r;r=this.observable_records.splice(0,this.observable_records.length);for(t=0,n=r.length;t<n;t++)e=r[t],b.release(e.observable);b.release(this.replaced_observables)},e.prototype.compact=function(){var e,t,n,r,i;n=[],r=this.observable_records;for(e in r)t=r[e],((i=t.observable)!=null?i.__kb_released:void 0)&&n.push(t);n.length&&(this.observable_records=S.difference(this.observable_records,n))},e.prototype.register=function(e,t,n){var r;if(!t)return;if(w.isObservable(t)||t.__kb_is_co)return;return b.utils.wrappedObject(t,e),e||(t.__kb_null=!0),r=n.creator?n.creator:n.path&&n.factory?n.factory.creatorForPath(e,n.path):null,r||(r=t.constructor),this.observable_records.push({obj:e,observable:t,creator:r}),t},e.prototype.findIndex=function(e,t){var n,r,i,s;i=[];if(!e||e instanceof b.Model){s=this.observable_records;for(n in s){r=s[n];if(!r.observable)continue;if(r.observable.__kb_released){i.push(r);continue}if(!e&&!r.observable.__kb_null||e&&(r.observable.__kb_null||r.obj!==e))continue;if(r.creator===t||r.creator.create&&r.creator.create===t.create)return i.length?(this.observable_records=S.difference(this.observable_records,i),S.indexOf(this.observable_records,r)):n}}return i.length&&(this.observable_records=S.difference(this.observable_records,i)),-1},e.prototype.find=function(e,t){var n;return(n=this.findIndex(e,t))<0?null:this.observable_records[n].observable},e.prototype.isRegistered=function(e){var t,n,r,i;i=this.observable_records;for(n=0,r=i.length;n<r;n++){t=i[n];if(t.observable===e)return!0}return!1},e.prototype.findOrCreate=function(e,t){var n,r;return t.store=this,t.creator||(t.creator=b.utils.inferCreator(e,t.factory,t.path)),!t.creator&&e instanceof b.Model&&(t.creator=b.ViewModel),n=t.creator,n?n.models_only?e:(n&&(r=this.find(e,n)),r?r:(r=b.ignore(function(i){return function(){return n.create?r=n.create(e,t):r=new n(e,t),r||w.observable(null)}}(this)),w.isObservable(r)||this.isRegistered(r)||this.register(e,r,t),r)):b.utils.createFromDefaultCreator(e,t)},e.prototype.findOrReplace=function(e,t,n){var r,i;return e||I(this,"obj missing"),(r=this.findIndex(e,t))<0?this.register(e,n,{creator:t}):(i=this.observable_records[r],b.utils.wrappedObject(i.observable)===e||I(this,"different object"),i.observable!==n&&(i.observable.constructor===n.constructor||I(this,"replacing different type"),this.replaced_observables.push(i.observable),i.observable=n),n)},e}(),b.EventWatcher=function(){function e(e,t,n){this._onModelUnloaded=z(this._onModelUnloaded,this),this._onModelLoaded=z(this._onModelLoaded,this),this.__kb||(this.__kb={}),this.__kb.callbacks={},this.__kb._onModelLoaded=S.bind(this._onModelLoaded,this),this.__kb._onModelUnloaded=S.bind(this._onModelUnloaded,this),n&&this.registerCallbacks(t,n),e?this.emitter(e):this.ee=null}return e.useOptionsOrCreate=function(e,t,n,r){return e.event_watcher?(e.event_watcher.emitter()!==t&&e.event_watcher.model_ref!==t&&I(this,"emitter not matching"),b.utils.wrappedEventWatcher(n,e.event_watcher).registerCallbacks(n,r)):(b.utils.wrappedEventWatcherIsOwned(n,!0),b.utils.wrappedEventWatcher(n,new b.EventWatcher(t)).registerCallbacks(n,r))},e.prototype.destroy=function(){return this.emitter(null),this.__kb.callbacks=null,b.utils.wrappedDestroy(this)},e.prototype.emitter=function(e){var t,n,r,i,s,o,u,a;if(arguments.length===0||this.ee===e)return this.ee;this.model_ref&&(this.model_ref.unbind("loaded",this.__kb._onModelLoaded),this.model_ref.unbind("unloaded",this.__kb._onModelUnloaded),this.model_ref.release(),this.model_ref=null),b.Backbone&&b.Backbone.ModelRef&&e instanceof b.Backbone.ModelRef?(this.model_ref=e,this.model_ref.retain(),this.model_ref.bind("loaded",this.__kb._onModelLoaded),this.model_ref.bind("unloaded",this.__kb._onModelUnloaded),e=this.model_ref.model()):delete this.model_ref,s=this.ee,this.ee=e,a=this.__kb.callbacks;for(n in a){t=a[n],s&&s.unbind(n,t.fn),e&&this.ee.bind(n,t.fn),i=t.list;for(o=0,u=i.length;o<u;o++)r=i[o],r.emitter&&r.emitter(this.ee)}return e},e.prototype.registerCallbacks=function(e,t){var n,r,i,s,o,u,a,f;e||F(this,"obj"),t||F(this,"info"),s=t.event_selector?t.event_selector:"change",i=s.split(" ");for(a=0,f=i.length;a<f;a++){r=i[a];if(!r)continue;n=this.__kb.callbacks[r],n||(u=[],n={list:u,fn:function(e){return function(e){var t,n,i;for(n=0,i=u.length;n<i;n++){t=u[n];if(t.update&&!t.rel_fn){if(e&&t.key&&e.hasChanged&&!e.hasChanged(R(t.key)))continue;!b.statistics||b.statistics.addModelEvent({name:r,model:e,key:t.key,path:t.path}),t.update()}}return null}}(this)},this.__kb.callbacks[r]=n,this.ee&&this.ee.bind(r,n.fn)),o=S.defaults({obj:e},t),n.list.push(o)}this.ee&&(W.call(i,"change")>=0&&(o.unbind_fn=b.orm.bind(this.ee,o.key,o.update,o.path)),o.emitter(this.ee)&&o.emitter)},e.prototype.releaseCallbacks=function(e){var t,n,r,i,s,o;if(!this.__kb.callbacks||!this.ee)return;s=this.__kb.callbacks;for(n in s){t=s[n],o=t.list;for(r in o){i=o[r];if(i.obj!==e)continue;t.list.splice(r,1),i.unbind_fn&&(i.unbind_fn(),i.unbind_fn=null),!b.wasReleased(e)&&i.emitter&&i.emitter(null);return}}},e.prototype._onModelLoaded=function(e){var t,n,r,i,s,o,u;this.ee=e,o=this.__kb.callbacks;for(n in o){t=o[n],e.bind(n,t.fn),u=t.list;for(i=0,s=u.length;i<s;i++)r=u[i],r.unbind_fn=b.orm.bind(e,r.key,r.update,r.path),r.emitter&&r.emitter(e)}},e.prototype._onModelUnloaded=function(e){var t,n,r,i,s,o,u;this.ee=null,u=this.__kb.callbacks;for(n in u){t=u[n],e.unbind(n,t.fn),i=t.list;for(s=0,o=i.length;s<o;s++)r=i[s],r.unbind_fn&&(r.unbind_fn(),r.unbind_fn=null),r.emitter&&r.emitter(null)}},e}(),b.emitterObservable=function(e,t){return new b.EventWatcher(e,t)},b.Observable=function(){function e(e,t,n){return this._vm=n!=null?n:{},b.ignore(function(n){return function(){var r,i,s;return t||F(n,"options"),S.isString(t)||w.isObservable(t)?r=n.create_options={key:t}:r=n.create_options=N(t),n.key=r.key,delete r.key,n.key||F(n,"key"),!r.args||(n.args=r.args,delete r.args),!r.read||(n.read=r.read,delete r.read),!r.write||(n.write=r.write,delete r.write),i=r.event_watcher,delete r.event_watcher,n._vo=w.observable(null),n._model=w.observable(),s=b.utils.wrappedObservable(n,w.dependentObservable({read:function(){var e,t,r,i,s,o;s=n._model(),o=t=[n.key].concat(n.args||[]);for(r=0,i=o.length;r<i;r++)e=o[r],R(e);return n.read?n.update(n.read.apply(n._vm,t)):S.isUndefined(s)||b.ignore(function(){return n.update(b.getValue(s,P(n.key),n.args))}),R(n._vo())},write:function(e){return b.ignore(function(){var t,r;return t=q(e),r=P(n._model),n.write?(n.write.call(n._vm,t),e=b.getValue(r,P(n.key),n.args)):r&&b.setValue(r,P(n.key),t),n.update(e)})},owner:n._vm})),s.__kb_is_o=!0,r.store=b.utils.wrappedStore(s,r.store),r.path=b.utils.pathJoin(r.path,n.key),r.factories&&(typeof r.factories=="function"||r.factories.create)?(r.factory=b.utils.wrappedFactory(s,new b.Factory(r.factory)),r.factory.addPathMapping(r.path,r.factories)):r.factory=b.Factory.useOptionsOrCreate(r,s,r.path),delete r.factories,H(s,n,["value","valueType","destroy"]),s.model=n.model=w.dependentObservable({read:function(){return R(n._model)},write:function(e){return b.ignore(function(){var t;if(n.__kb_released||P(n._model)===e)return;t=b.getValue(e,P(n.key),n.args),n._model(e);if(!e)return n.update(null);if(!S.isUndefined(t))return n.update(t)})}}),b.EventWatcher.useOptionsOrCreate({event_watcher:i},e,n,{emitter:n.model,update:S.bind(n.update,n),key:n.key,path:r.path}),n.__kb_value||n.update(),b.LocalizedObservable&&r.localizer&&(s=new r.localizer(s),delete r.localizer),b.DefaultObservable&&r.hasOwnProperty("default")&&(s=b.defaultObservable(s,r["default"]),delete r["default"]),s}}(this))}return e.prototype.destroy=function(){var e;return e=b.utils.wrappedObservable(this),this.__kb_released=!0,b.release(this.__kb_value),this.__kb_value=null,this.model.dispose(),this.model=e.model=null,b.utils.wrappedDestroy(this)},e.prototype.value=function(){return this.__kb_value},e.prototype.valueType=function(){var e;return e=b.getValue(P(this._model),P(this.key)),this.value_type||this._updateValueObservable(e),this.value_type},e.prototype.update=function(e){var t,n;if(this.__kb_released)return;arguments.length||(e=b.getValue(P(this._model),P(this.key))),e!==void 0||(e=null),t=b.utils.valueType(e);if(!this.__kb_value||this.__kb_value.__kb_released||this.__kb_value.__kb_null&&e)this.__kb_value=void 0,this.value_type=void 0;n=this.__kb_value;if(S.isUndefined(this.value_type)||this.value_type!==t&&t!==f)return this.value_type===o&&t===s?n(e):this._updateValueObservable(e);if(this.value_type===u){if(typeof n.model=="function"){if(n.model()!==e)return n.model(e)}else if(b.utils.wrappedObject(n)!==e)return this._updateValueObservable(e)}else if(this.value_type===o){if(n.collection()!==e)return n.collection(e)}else if(n()!==e)return n(e)},e.prototype._updateValueObservable=function(e){var t,n,r,i;return t=this.create_options,t.creator=b.utils.inferCreator(e,t.factory,t.path,P(this._model),this.key),this.value_type=f,n=t.creator,r=this.__kb_value,this.__kb_value=void 0,r&&b.release(r),n?t.store?i=t.store.findOrCreate(e,t):n.models_only?(i=e,this.value_type=a):n.create?i=n.create(e,t):i=new n(e,t):S.isArray(e)?(this.value_type=s,i=w.observableArray(e)):(this.value_type=a,i=w.observable(e)),this.value_type===f&&(w.isObservable(i)?i.__kb_is_co?this.value_type=o:this.value_type=a:(this.value_type=u,typeof i.model!="function"&&b.utils.wrappedObject(i,e))),this.__kb_value=i,this._vo(i)},e}(),b.observable=function(e,t,n){return new b.Observable(e,t,n)},b.ViewModel=function(){function e(e,t,n){return b.ignore(function(r){return function(){var i,s,o,u,a,f,l,c,h,p;!e||e instanceof b.Model||typeof e.get=="function"&&typeof e.bind=="function"||I(r,"not a model"),t||(t={}),n||(n={}),S.isArray(t)?t={keys:t}:t=N(t),r.__kb||(r.__kb={}),r.__kb.vm_keys={},r.__kb.model_keys={},r.__kb.view_model=S.isUndefined(n)?r:n,!t.internals||(r.__kb.internals=t.internals),!t.excludes||(r.__kb.excludes=t.excludes),!t.statics||(r.__kb.statics=t.statics),!t.static_defaults||(r.__kb.static_defaults=t.static_defaults),b.Store.useOptionsOrCreate(t,e,r),r.__kb.path=t.path,b.Factory.useOptionsOrCreate(t,r,t.path),h=U(r,"_mdl",w.observable()),r.model=w.dependentObservable({read:function(){return h(),b.utils.wrappedObject(r)},write:function(e){return b.ignore(function(){var t,n,i,s;if(b.utils.wrappedObject(r)===e)return;if(r.__kb_null){!e||I(r,"model set on shared null");return}b.utils.wrappedObject(r,e),t=b.utils.wrappedEventWatcher(r);if(!t){h(e);return}t.emitter(e),r.__kb.keys||!e||!e.attributes||(n=S.keys(e.attributes),e&&(s=b.orm.keys(e))&&(n=S.union(n,s)),i=S.difference(n,S.keys(r.__kb.model_keys)),i&&r.createObservables(e,i)),h(e)})}}),o=b.utils.wrappedEventWatcher(r,new b.EventWatcher(e,r,{emitter:r.model})),u=t.requires,r.__kb.internals&&(u=S.union(u||[],r.__kb.internals)),e&&(l=b.orm.keys(e))&&(u=S.union(u||[],l));if(t.keys)if(S.isObject(t.keys)&&!S.isArray(t.keys)){a={},p=t.keys;for(c in p)f=p[c],a[S.isString(f)?f:f.key?f.key:c]=!0;r.__kb.keys=S.keys(a)}else r.__kb.keys=t.keys,u=u?S.union(u,r.__kb.keys):S.clone(r.__kb.keys);else s=o.emitter(),s&&s.attributes&&(i=S.keys(s.attributes),u=u?S.union(u,i):i);return u&&r.__kb.excludes&&(u=S.difference(u,r.__kb.excludes)),u&&r.__kb.statics&&(u=S.difference(u,r.__kb.statics)),S.isObject(t.keys)&&!S.isArray(t.keys)&&r.mapObservables(e,t.keys),S.isObject(t.requires)&&!S.isArray(t.requires)&&r.mapObservables(e,t.requires),!t.mappings||r.mapObservables(e,t.mappings),!u||r.createObservables(e,u),!r.__kb.statics||r.createObservables(e,r.__kb.statics,!0),!b.statistics||b.statistics.register("ViewModel",r),r}}(this))}return e.extend=b.extend,e.prototype.destroy=function(){var e;if(this.__kb.view_model!==this)for(e in this.__kb.vm_keys)this.__kb.view_model[e]=null;return this.__kb.view_model=null,b.releaseKeys(this),b.utils.wrappedDestroy(this),!b.statistics||b.statistics.unregister("ViewModel",this)},e.prototype.shareOptions=function(){return{store:b.utils.wrappedStore(this),factory:b.utils.wrappedFactory(this)}},e.prototype.createObservables=function(e,t,n){var r,i,s,o,u,a;n?s=this.__kb.static_defaults||{}:r={store:b.utils.wrappedStore(this),factory:b.utils.wrappedFactory(this),path:this.__kb.path,event_watcher:b.utils.wrappedEventWatcher(this)};for(u=0,a=t.length;u<a;u++){i=t[u],o=this.__kb.internals&&S.contains(this.__kb.internals,i)?"_"+i:i;if(this[o])continue;this.__kb.vm_keys[o]=this.__kb.model_keys[i]=!0,n?e.has(o)?this[o]=this.__kb.view_model[o]=e.get(o):o in s&&(this[o]=this.__kb.view_model[o]=s[o]):(r.key=i,this[o]=this.__kb.view_model[o]=b.observable(e,r,this))}},e.prototype.mapObservables=function(e,t){var n,r,i;n={store:b.utils.wrappedStore(this),factory:b.utils.wrappedFactory(this),path:this.__kb.path,event_watcher:b.utils.wrappedEventWatcher(this)};for(i in t){r=t[i];if(this[i])continue;r=S.isString(r)?{key:r}:S.clone(r),r.key||(r.key=i),this.__kb.vm_keys[i]=this.__kb.model_keys[r.key]=!0,this[i]=this.__kb.view_model[i]=b.observable(e,S.defaults(r,n),this)}},e}(),b.viewModel=function(e,t,n){return new b.ViewModel(e,t,n)},r=0,t=-1,n=1,b.compare=function(e,i){return S.isString(e)?e.localeCompare(""+i):S.isString(i)?i.localeCompare(""+e):e===i?r:e<i?t:n},b.CollectionObservable=function(){function e(e,t){return b.ignore(function(n){return function(){var r,i,s;return!S.isUndefined(t)||e instanceof b.Collection?S.isArray(e)&&(e=new b.Collection(e)):(s=[new b.Collection,e],e=s[0],t=s[1]),t||(t={}),i=b.utils.wrappedObservable(n,w.observableArray([])),i.__kb_is_co=!0,n.in_edit=0,n.__kb||(n.__kb={}),n.__kb._onCollectionChange=S.bind(n._onCollectionChange,n),t=N(t),t.auto_compact&&(n.auto_compact=!0),t.sort_attribute?n._comparator=w.observable(n._attributeComparator(t.sort_attribute)):n._comparator=w.observable(t.comparator),t.filters?n._filters=w.observableArray(S.isArray(t.filters)?t.filters:t.filters?[t.filters]:void 0):n._filters=w.observableArray([]),r=n.create_options={store:b.Store.useOptionsOrCreate(t,e,i)},n.path=t.path,r.factory=b.utils.wrappedFactory(i,n._shareOrCreateFactory(t)),r.path=b.utils.pathJoin(t.path,"models"),r.creator=r.factory.creatorForPath(null,r.path),r.creator&&(n.models_only=r.creator.models_only),H(i,n,["destroy","shareOptions","filters","comparator","sortAttribute","viewModelByModel","hasViewModels"]),n._collection=w.observable(e),i.collection=n.collection=w.dependentObservable({read:function(){return n._collection()},write:function(e){return b.ignore(function(){var t;if((t=n._collection())===e)return;return t&&t.unbind("all",n.__kb._onCollectionChange),e&&e.bind("all",n.__kb._onCollectionChange),n._collection(e)})}}),e&&e.bind("all",n.__kb._onCollectionChange),n._mapper=w.dependentObservable(function(){var e,t,r,s,o,u,a,f;e=n._comparator(),s=n._filters();if(s)for(a=0,f=s.length;a<f;a++)r=s[a],R(r);t=n._collection();if(n.in_edit)return;return i=b.utils.wrappedObservable(n),t&&(o=t.models),!o||t.models.length===0?u=[]:(o=S.filter(o,function(e){return!s.length||n._selectModel(e)}),e?u=S.map(o,function(e){return n._createViewModel(e)}).sort(e):n.models_only?u=s.length?o:o.slice():u=S.map(o,function(e){return n._createViewModel(e)})),n.in_edit++,i(u),n.in_edit--}),i.subscribe(S.bind(n._onObservableArrayChange,n)),!b.statistics||b.statistics.register("CollectionObservable",n),i}}(this))}return e.extend=b.extend,e.prototype.destroy=function(){var e,t,n;return n=b.utils.wrappedObservable(this),t=this._collection(),t&&(t.unbind("all",this.__kb._onCollectionChange),e=n(),e.splice(0,e.length)),this.collection.dispose(),this._collection=n.collection=this.collection=null,this._mapper.dispose(),this._mapper=null,b.release(this._filters),this._filters=null,this._comparator(null),this._comparator=null,this.create_options=null,n.collection=null,b.utils.wrappedDestroy(this),!b.statistics||b.statistics.unregister("CollectionObservable",this)},e.prototype.shareOptions=function(){var e;return e=b.utils.wrappedObservable(this),{store:b.utils.wrappedStore(e),factory:b.utils.wrappedFactory(e)}},e.prototype.filters=function(e){return e?this._filters(S.isArray(e)?e:[e]):this._filters([])},e.prototype.comparator=function(e){return this._comparator(e)},e.prototype.sortAttribute=function(e){return this._comparator(e?this._attributeComparator(e):null)},e.prototype.viewModelByModel=function(e){var t;return this.models_only?null:(t=e.hasOwnProperty(e.idAttribute)?e.idAttribute:"cid",S.find(P(b.utils.wrappedObservable(this)),function(n){var r;return(n!=null?(r=n.__kb)!=null?r.object:void 0:void 0)?n.__kb.object[t]===e[t]:!1}))},e.prototype.hasViewModels=function(){return!this.models_only},e.prototype.compact=function(){return b.ignore(function(e){return function(){var t;t=b.utils.wrappedObservable(e);if(!b.utils.wrappedStoreIsOwned(t))return;return b.utils.wrappedStore(t).clear(),e._collection.notifySubscribers(e._collection())}}(this))},e.prototype._shareOrCreateFactory=function(e){var t,n,r,i;t=b.utils.pathJoin(e.path,"models"),r=e.factories;if(i=e.factory)if((n=i.creatorForPath(null,t))&&(!r||r.models===n)){if(!r)return i;if(i.hasPathMappings(r,e.path))return i}return i=new b.Factory(e.factory),r&&i.addPathMappings(r,e.path),i.creatorForPath(null,t)||(e.hasOwnProperty("models_only")?e.models_only?i.addPathMapping(t,{models_only:!0}):i.addPathMapping(t,b.ViewModel):e.view_model?i.addPathMapping(t,e.view_model):e.create?i.addPathMapping(t,{create:e.create}):i.addPathMapping(t,b.ViewModel)),i},e.prototype._onCollectionChange=function(e,t){return b.ignore(function(n){return function(){var r,i,s,o;if(n.in_edit)return;switch(e){case"reset":n.auto_compact?n.compact():n._collection.notifySubscribers(n._collection());break;case"sort":case"resort":n._collection.notifySubscribers(n._collection());break;case"new":case"add":if(!n._selectModel(t))return;s=b.utils.wrappedObservable(n),r=n._collection();if(r.indexOf(t)===-1)return;if(o=n.viewModelByModel(t))return;n.in_edit++,o=n._createViewModel(t),(i=n._comparator())?(s().push(o),s.sort(i)):s.splice(r.indexOf(t),0,o),n.in_edit--;break;case"remove":case"destroy":n._onModelRemove(t);break;case"change":if(!n._selectModel(t))n._onModelRemove(t);else{o=n.models_only?t:n.viewModelByModel(t);if(o){if(i=n._comparator())s=b.utils.wrappedObservable(n),n.in_edit++,s.sort(i),n.in_edit--}else n._onCollectionChange("add",t)}}}}(this))},e.prototype._onModelRemove=function(e){var t,n;n=this.models_only?e:this.viewModelByModel(e);if(!n)return;return t=b.utils.wrappedObservable(this),this.in_edit++,t.remove(n),this.in_edit--},e.prototype._onObservableArrayChange=function(e){return b.ignore(function(t){return function(){var n,r,i,s,o,u,a,f,l;if(t.in_edit)return;t.models_only&&(!e.length||b.utils.hasModelSignature(e[0]))||!t.models_only&&(!e.length||S.isObject(e[0])&&!b.utils.hasModelSignature(e[0]))||I(t,"incorrect type passed"),o=b.utils.wrappedObservable(t),n=P(t._collection),r=P(t._filters).length;if(!n)return;a=e;if(t.models_only)s=S.filter(e,function(e){return!r||t._selectModel(e)});else{!r||(a=[]),s=[];for(f=0,l=e.length;f<l;f++){u=e[f],i=b.utils.wrappedObject(u);if(r){if(!t._selectModel(i))continue;a.push(u)}t.create_options.store.findOrReplace(i,t.create_options.creator,u),s.push(i)}}t.in_edit++,e.length===a.length||o(a),S.isEqual(n.models,s)||n.reset(s),t.in_edit--}}(this))},e.prototype._attributeComparator=function(e){var t;return t=function(t,n){var r;return r=R(e),b.compare(t.get(r),n.get(r))},this.models_only?t:function(e,n){return t(b.utils.wrappedModel(e),b.utils.wrappedModel(n))}},e.prototype._createViewModel=function(e){return this.models_only?e:this.create_options.store.findOrCreate(e,this.create_options)},e.prototype._selectModel=function(e){var t,n,r,i,s;n=P(this._filters);for(r=0,i=n.length;r<i;r++){t=n[r],t=P(t);if(S.isFunction(t)){if(!t(e))return!1}else if(S.isArray(t)){if(s=e.id,W.call(t,s)<0)return!1}else if(e.id!==t)return!1}return!0},e}(),b.collectionObservable=function(e,t){return new b.CollectionObservable(e,t)},b.RECUSIVE_AUTO_INJECT=!0,w.bindingHandlers.inject={init:function(e,t,n,r){return b.Inject.inject(R(t()),r,e,t,n)}},b.Inject=function(){function e(){}return e.inject=function(e,t,n,r,i,s){var o,u,a;return o=function(e){var o,u,a;if(S.isFunction(e))t=new e(t,n,r,i),b.releaseOnNodeRemove(t,n);else{e.view_model&&(t=new e.view_model(t,n,r,i),b.releaseOnNodeRemove(t,n));for(o in e){a=e[o];if(o==="view_model")continue;o==="create"?a(t,n,r,i):S.isObject(a)&&!S.isFunction(a)?(u=s||a&&a.create?{}:t,t[o]=b.Inject.inject(a,u,n,r,i,!0)):t[o]=a}}return t},s?o(e):(u=(a=w.dependentObservable(function(){return o(e)}))(),a.dispose(),u)},e.injectViewModels=function(e){var t,n,r,i,s,o,u,a,f,l;a=[],o=function(e){var t,n,r,i,s;e.__kb_injected||e.attributes&&(t=S.find(e.attributes,function(e){return e.name==="kb-inject"}))&&(e.__kb_injected=!0,a.push({el:e,view_model:{},binding:t.value})),s=e.childNodes;for(r=0,i=s.length;r<i;r++)n=s[r],o(n)},!e&&typeof document!="undefined"&&document!==null&&(e=document),o(e);for(f=0,l=a.length;f<l;f++){n=a[f];if(s=n.binding)s.search(/[:]/)<0||(s="{"+s+"}"),i=(new Function("","return ( "+s+" )"))(),i||(i={}),!i.options||(u=i.options,delete i.options),u||(u={}),n.view_model=b.Inject.inject(i,n.view_model,n.el,null,null,!0),t=n.view_model.afterBinding||u.afterBinding,r=n.view_model.beforeBinding||u.beforeBinding;r&&r(n.view_model,n.el,u),b.applyBindings(n.view_model,n.el,u),t&&t(n.view_model,n.el,u)}return a},e}(),A=w.applyBindings,w.applyBindings=function(e,t){var n;n=b.RECUSIVE_AUTO_INJECT?b.injectViewModels(t):[];if(!n.length)return A.apply(this,arguments)},b.injectViewModels=b.Inject.injectViewModels,typeof document!="undefined"&&document!==null&&(this.$?this.$(function(){return b.injectViewModels()}):(E=function(){return document.readyState!=="complete"?setTimeout(E,0):b.injectViewModels()})()),H=b._publishMethods,b.DefaultObservable=function(){function e(e,t){var n;return this.dv=t,n=b.utils.wrappedObservable(this,w.dependentObservable({read:function(t){return function(){var n;return(n=R(e()))?n:R(t.dv)}}(this),write:function(t){return e(t)}})),H(n,this,["destroy","setToDefault"]),n}return e.prototype.destroy=function(){return b.utils.wrappedDestroy(this)},e.prototype.setToDefault=function(){return b.utils.wrappedObservable(this)(this.dv)},e}(),b.defaultObservable=function(e,t){return new b.DefaultObservable(e,t)},b.Observable.prototype.setToDefault=function(){var e;(e=this.__kb_value)!=null&&typeof e.setToDefault=="function"&&e.setToDefault()},b.ViewModel.prototype.setToDefault=function(){var e,t;for(e in this.__kb.vm_keys)(t=this[e])!=null&&typeof t.setToDefault=="function"&&t.setToDefault()},b.utils.setToDefault=function(e){var t,n;if(!e)return;if(w.isObservable(e))typeof e.setToDefault=="function"&&e.setToDefault();else if(S.isObject(e))for(t in e)n=e[t],n&&(w.isObservable(n)||typeof n!="function")&&(t[0]!=="_"||t.search("__kb"))&&this.setToDefault(n);return e},m=Array.prototype.slice,b.toFormattedString=function(e){var t,n,r,i,s,o;s=e.slice(),n=m.call(arguments,1);for(r in n){t=n[r],o=R(t);if(S.isUndefined(o)||S.isNull(o))o="";i=e.indexOf("{"+r+"}");while(i>=0)s=s.replace("{"+r+"}",o),i=e.indexOf("{"+r+"}",i+1)}return s},b.parseFormattedString=function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d;c=t.slice(),i=0,u=0,f={};while(c.search("\\{"+i+"\\}")>=0){a=t.indexOf("{"+i+"}");while(a>=0)c=c.replace("{"+i+"}","(.*)"),f[a]=i,u++,a=t.indexOf("{"+i+"}",a+1);i++}n=i,l=new RegExp(c),o=l.exec(e),o&&o.shift();if(!o||o.length!==u){h=[];while(n-->0)h.push("");return h}d=S.sortBy(S.keys(f),function(e,t){return parseInt(e,10)}),r={};for(s in d){a=d[s],i=f[a];if(r.hasOwnProperty(i))continue;r[i]=s}p=[],i=0;while(i<n)p.push(o[r[i]]),i++;return p},b.FormattedObservable=function(){function e(e,t){var n,r;return S.isArray(t)?(e=e,r=t):r=m.call(arguments,1),n=b.utils.wrappedObservable(this,w.dependentObservable({read:function(){var n,i,s;t=[R(e)];for(i=0,s=r.length;i<s;i++)n=r[i],t.push(R(n));return b.toFormattedString.apply(null,t)},write:function(t){var n,i,s;i=b.parseFormattedString(t,R(e)),s=Math.min(r.length,i.length),n=0;while(n<s)r[n](i[n]),n++}})),n}return e.prototype.destroy=function(){return b.utils.wrappedDestroy(this)},e}(),b.formattedObservable=function(e,t){return new b.FormattedObservable(e,m.call(arguments,1))},H=b._publishMethods,b.LocalizedObservable=function(){function e(e,t,n){var r;return this.value=e,this.vm=n,t||(t={}),this.vm||(this.vm={}),this.read||F(this,"read"),b.locale_manager||F(this,"kb.locale_manager"),this.__kb||(this.__kb={}),this.__kb._onLocaleChange=S.bind(this._onLocaleChange,this),this.__kb._onChange=t.onChange,this.value&&(e=R(this.value)),this.vo=w.observable(e?this.read(e,null):null),r=b.utils.wrappedObservable(this,w.dependentObservable({read:function(e){return function(){return e.value&&R(e.value),e.vo(),e.read(R(e.value))}}(this),write:function(e){return function(t){e.write||I(e,"writing to read-only"),e.write(t,R(e.value)),e.vo(t);if(e.__kb._onChange)return e.__kb._onChange(t)}}(this),owner:this.vm})),H(r,this,["destroy","observedValue","resetToCurrent"]),b.locale_manager.bind("change",this.__kb._onLocaleChange),t.hasOwnProperty("default")&&(r=b.DefaultObservable&&w.defaultObservable(r,t["default"])),r}return e.extend=b.extend,e.prototype.destroy=function(){return b.locale_manager.unbind("change",this.__kb._onLocaleChange),this.vm=null,b.utils.wrappedDestroy(this)},e.prototype.resetToCurrent=function(){var e,t;t=b.utils.wrappedObservable(this),e=this.value?this.read(R(this.value)):null;if(t()===e)return;return t(e)},e.prototype.observedValue=function(e){if(arguments.length===0)return this.value;this.value=e,this._onLocaleChange()},e.prototype._onLocaleChange=function(){var e;e=this.read(R(this.value)),this.vo(e);if(this.__kb._onChange)return this.__kb._onChange(e)},e}(),b.localizedObservable=function(e,t,n){return new b.LocalizedObservable(e,t,n)},b.locale_manager=void 0,H=b._publishMethods,b.TriggeredObservable=function(){function e(e,t){var n;return this.event_selector=t,e||F(this,"emitter"),this.event_selector||F(this,"event_selector"),this.vo=w.observable(),n=b.utils.wrappedObservable(this,w.dependentObservable(function(e){return function(){return e.vo()}}(this))),H(n,this,["destroy"]),b.utils.wrappedEventWatcher(this,new b.EventWatcher(e,this,{emitter:S.bind(this.emitter,this),update:S.bind(this.update,this),event_selector:this.event_selector})),n}return e.prototype.destroy=function(){return b.utils.wrappedDestroy(this)},e.prototype.emitter=function(e){if(arguments.length===0||this.ee===e)return this.ee;if(this.ee=e)return this.update()},e.prototype.update=function(){if(!this.ee)return;return this.vo()!==this.ee?this.vo(this.ee):this.vo.valueHasMutated()},e}(),b.triggeredObservable=function(e,t){return new b.TriggeredObservable(e,t)},g=function(e){return e=R(e),typeof e=="function"?e.apply(null,Array.prototype.slice.call(arguments,1)):e},b.Validation=function(){function e(){}return e}(),b.valueValidator=function(e,t,n){return n==null&&(n={}),n&&typeof n!="function"||(n={}),w.dependentObservable(function(){var r,i,s,o,u,a,f,l;f={$error_count:0},i=R(e),!("disable"in n)||(s=g(n.disable)),!("enable"in n)||(s=!g(n.enable)),a=n.priorities||[],S.isArray(a)||(a=[a]),r=a.length+1;for(o in t)l=t[o],f[o]=!s&&g(l,i),f[o]&&(f.$error_count++,(u=S.indexOf(a,o)>=0)||(u=a.length),f.$active_error&&u<r?(f.$active_error=o,r=u):f.$active_error||(f.$active_error=o,r=u));return f.$enabled=!s,f.$disable=!!s,f.$valid=f.$error_count===0,f})},b.inputValidator=function(e,t,n){var r,i,s,o,u,a,f,l,c,h;n==null&&(n={}),n&&typeof n!="function"||(n={}),c=b.valid,r=$(t),(o=r.attr("name"))&&!S.isString(o)&&(o=null);if(!(i=r.attr("data-bind")))return null;u=(new Function("sc","with(sc[0]) { return { "+i+" } }"))([e]);if(!u||!u.value)return null;!u.validation_options||(S.defaults(u.validation_options,n),n=u.validation_options),i={},!c[f=r.attr("type")]||(i[f]=c[f]),!r.attr("required")||(i.required=c.required);if(u.validations){h=u.validations;for(s in h)l=h[s],i[s]=l}return a=b.valueValidator(u.value,i,n),!o&&!n.no_attach||(e["$"+o]=a),a},b.formValidator=function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d;a={},c=[],n=$(t),(i=n.attr("name"))&&!S.isString(i)&&(i=null);if(r=n.attr("data-bind"))u=(new Function("sc","with(sc[0]) { return { "+r+" } }"))([e]),f=u.validation_options;f||(f={}),f.no_attach=!!i,d=n.find("input");for(h=0,p=d.length;h<p;h++){s=d[h];if(!(o=$(s).attr("name")))continue;l=b.inputValidator(e,s,f),!l||c.push(a[o]=l)}return a.$error_count=w.dependentObservable(function(){var e,t,n;e=0;for(t=0,n=c.length;t<n;t++)l=c[t],e+=l().$error_count;return e}),a.$valid=w.dependentObservable(function(){return a.$error_count()===0}),a.$enabled=w.dependentObservable(function(){var e,t,n;e=!0;for(t=0,n=c.length;t<n;t++)l=c[t],e&=l().$enabled;return e}),a.$disabled=w.dependentObservable(function(){return!a.$enabled()}),i&&(e["$"+i]=a),a},v=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,i=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/,l=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,b.valid={required:function(e){return!e},url:function(e){return!v.test(e)},email:function(e){return!i.test(e)},number:function(e){return!l.test(e)}},b.hasChangedFn=function(e){var t,n;return n=null,t=null,function(){var r;return n!==(r=R(e))?(n=r,t=n?n.toJSON():null,!1):!n||!t?!1:!S.isEqual(n.toJSON(),t)}},b.minLengthFn=function(e){return function(t){return!t||t.length<e}},b.uniqueValueFn=function(e,t,n){return function(r){var i,s,o;return o=R(e),s=R(t),i=R(n),o&&s&&i?!!S.find(i.models,function(e){return function(e){return e!==o&&e.get(s)===r}}(this)):!1}},b.untilTrueFn=function(e,t,n){var r;return r=!1,n&&w.isObservable(n)&&n.subscribe(function(){return r=!1}),function(n){var i,s;return(i=R(t))?(r|=!!(s=i(R(n))),r?s:R(e)):R(e)}},b.untilFalseFn=function(e,t,n){var r;return r=!1,n&&w.isObservable(n)&&n.subscribe(function(){return r=!1}),function(n){var i,s;return(i=R(t))?(r|=!(s=i(R(n))),r?s:R(e)):R(e)}},b})}.call(this);