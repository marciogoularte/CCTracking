(function(e,t,n){function r(e){for(var t=[],n=0,r=e.length;n<r;n++)t[e[n]]=n;return t}function i(e,t,n){t=e.splice(t,1)[0],e.splice(n,0,t)}function s(e,t,n){for(var r=[],i=0,s=e.childNodes.length;i<s;i++)1==e.childNodes[i].nodeType&&r.push(e.childNodes[i]);t=r[t],null!==n?e.insertBefore(t,r[n]):e.appendChild(t)}$.fn.dataTableExt.oApi.fnColReorder=function(e,t,n){var u=$.fn.dataTable.Api?!0:!1,a,f,l,c,h=e.aoColumns.length,p;if(t!=n)if(0>t||t>=h)this.oApi._fnLog(e,1,"ColReorder 'from' index is out of bounds: "+t);else if(0>n||n>=h)this.oApi._fnLog(e,1,"ColReorder 'to' index is out of bounds: "+n);else{l=[],a=0;for(f=h;a<f;a++)l[a]=a;i(l,t,n);var d=r(l);a=0;for(f=e.aaSorting.length;a<f;a++)e.aaSorting[a][0]=d[e.aaSorting[a][0]];if(null!==e.aaSortingFixed){a=0;for(f=e.aaSortingFixed.length;a<f;a++)e.aaSortingFixed[a][0]=d[e.aaSortingFixed[a][0]]}a=0;for(f=h;a<f;a++){p=e.aoColumns[a],l=0;for(c=p.aDataSort.length;l<c;l++)p.aDataSort[l]=d[p.aDataSort[l]];u&&(p.idx=d[p.idx])}u&&$.each(e.aLastSort,function(t,n){e.aLastSort[t].src=d[n.src]}),a=0;for(f=h;a<f;a++)p=e.aoColumns[a],"number"==typeof p.mData&&(p.mData=d[p.mData],e.oApi._fnColumnOptions(e,a,{}));if(e.aoColumns[t].bVisible){c=this.oApi._fnColumnIndexToVisible(e,t),p=null;for(a=n<t?n:n+1;null===p&&a<h;)p=this.oApi._fnColumnIndexToVisible(e,a),a++;l=e.nTHead.getElementsByTagName("tr"),a=0;for(f=l.length;a<f;a++)s(l[a],c,p);if(null!==e.nTFoot){l=e.nTFoot.getElementsByTagName("tr"),a=0;for(f=l.length;a<f;a++)s(l[a],c,p)}a=0;for(f=e.aoData.length;a<f;a++)null!==e.aoData[a].nTr&&s(e.aoData[a].nTr,c,p)}i(e.aoColumns,t,n),i(e.aoPreSearchCols,t,n),a=0;for(f=e.aoData.length;a<f;a++)l=e.aoData[a],u?(l.anCells&&i(l.anCells,t,n),"dom"!==l.src&&$.isArray(l._aData)&&i(l._aData,t,n)):($.isArray(l._aData)&&i(l._aData,t,n),i(l._anHidden,t,n));a=0;for(f=e.aoHeader.length;a<f;a++)i(e.aoHeader[a],t,n);if(null!==e.aoFooter){a=0;for(f=e.aoFooter.length;a<f;a++)i(e.aoFooter[a],t,n)}u&&(new $.fn.dataTable.Api(e)).rows().invalidate(),a=0;for(f=h;a<f;a++)$(e.aoColumns[a].nTh).off("click.DT"),this.oApi._fnSortAttachListener(e,e.aoColumns[a].nTh,a);$(e.oInstance).trigger("column-reorder",[e,{iFrom:t,iTo:n,aiInvertMapping:d}])}},e=function(e){var s=function(t,n){var r;return e.fn.dataTable.Api?r=(new e.fn.dataTable.Api(t)).settings()[0]:t.fnSettings?r=t.fnSettings():"string"==typeof t?e.fn.dataTable.fnIsDataTable(e(t)[0])&&(r=e(t).eq(0).dataTable().fnSettings()):t.nodeName&&"table"===t.nodeName.toLowerCase()?e.fn.dataTable.fnIsDataTable(t.nodeName)&&(r=e(t.nodeName).dataTable().fnSettings()):t instanceof jQuery?e.fn.dataTable.fnIsDataTable(t[0])&&(r=t.eq(0).dataTable().fnSettings()):r=t,e.fn.dataTable.camelToHungarian&&e.fn.dataTable.camelToHungarian(s.defaults,n||{}),this.s={dt:null,init:e.extend(!0,{},s.defaults,n),fixed:0,fixedRight:0,dropCallback:null,mouse:{startX:-1,startY:-1,offsetX:-1,offsetY:-1,target:-1,targetIndex:-1,fromIndex:-1},aoTargets:[]},this.dom={drag:null,pointer:null},this.s.dt=r.oInstance.fnSettings(),this.s.dt._colReorder=this,this._fnConstruct(),r.oApi._fnCallbackReg(r,"aoDestroyCallback",e.proxy(this._fnDestroy,this),"ColReorder"),this};return s.prototype={fnReset:function(){for(var e=[],t=0,n=this.s.dt.aoColumns.length;t<n;t++)e.push(this.s.dt.aoColumns[t]._ColReorder_iOrigCol);return this._fnOrderColumns(e),this},fnGetCurrentOrder:function(){return this.fnOrder()},fnOrder:function(e){if(e===n){for(var e=[],t=0,i=this.s.dt.aoColumns.length;t<i;t++)e.push(this.s.dt.aoColumns[t]._ColReorder_iOrigCol);return e}return this._fnOrderColumns(r(e)),this},_fnConstruct:function(){var e=this,t=this.s.dt.aoColumns.length,n;this.s.init.iFixedColumns&&(this.s.fixed=this.s.init.iFixedColumns),this.s.fixedRight=this.s.init.iFixedColumnsRight?this.s.init.iFixedColumnsRight:0,this.s.init.fnReorderCallback&&(this.s.dropCallback=this.s.init.fnReorderCallback);for(n=0;n<t;n++)n>this.s.fixed-1&&n<t-this.s.fixedRight&&this._fnMouseListener(n,this.s.dt.aoColumns[n].nTh),this.s.dt.aoColumns[n]._ColReorder_iOrigCol=n;this.s.dt.oApi._fnCallbackReg(this.s.dt,"aoStateSaveParams",function(t,n){e._fnStateSave.call(e,n)},"ColReorder_State");var i=null;this.s.init.aiOrder&&(i=this.s.init.aiOrder.slice()),this.s.dt.oLoadedState&&"undefined"!=typeof this.s.dt.oLoadedState.ColReorder&&this.s.dt.oLoadedState.ColReorder.length==this.s.dt.aoColumns.length&&(i=this.s.dt.oLoadedState.ColReorder);if(i)if(e.s.dt._bInitComplete)t=r(i),e._fnOrderColumns.call(e,t);else{var s=!1;this.s.dt.aoDrawCallback.push({fn:function(){if(!e.s.dt._bInitComplete&&!s){s=!0;var t=r(i);e._fnOrderColumns.call(e,t)}},sName:"ColReorder_Pre"})}else this._fnSetColumnIndexes()},_fnOrderColumns:function(t){if(t.length!=this.s.dt.aoColumns.length)this.s.dt.oInstance.oApi._fnLog(this.s.dt,1,"ColReorder - array reorder does not match known number of columns. Skipping.");else{for(var n=0,r=t.length;n<r;n++){var s=e.inArray(n,t);n!=s&&(i(t,s,n),this.s.dt.oInstance.fnColReorder(s,n))}(""!==this.s.dt.oScroll.sX||""!==this.s.dt.oScroll.sY)&&this.s.dt.oInstance.fnAdjustColumnSizing(),this.s.dt.oInstance.oApi._fnSaveState(this.s.dt),this._fnSetColumnIndexes()}},_fnStateSave:function(t){var n,r,i,s=this.s.dt;for(n=0;n<t.aaSorting.length;n++)t.aaSorting[n][0]=s.aoColumns[t.aaSorting[n][0]]._ColReorder_iOrigCol;var o=e.extend(!0,[],t.aoSearchCols);t.ColReorder=[],n=0;for(r=s.aoColumns.length;n<r;n++)i=s.aoColumns[n]._ColReorder_iOrigCol,t.aoSearchCols[i]=o[n],t.abVisCols[i]=s.aoColumns[n].bVisible,t.ColReorder.push(i)},_fnMouseListener:function(t,n){var r=this;e(n).on("mousedown.ColReorder",function(e){e.preventDefault(),r._fnMouseDown.call(r,e,n)})},_fnMouseDown:function(r,i){var s=this,o=e(r.target).closest("th, td").offset(),u=parseInt(e(i).attr("data-column-index"),10);u!==n&&(this.s.mouse.startX=r.pageX,this.s.mouse.startY=r.pageY,this.s.mouse.offsetX=r.pageX-o.left,this.s.mouse.offsetY=r.pageY-o.top,this.s.mouse.target=this.s.dt.aoColumns[u].nTh,this.s.mouse.targetIndex=u,this.s.mouse.fromIndex=u,this._fnRegions(),e(t).on("mousemove.ColReorder",function(e){s._fnMouseMove.call(s,e)}).on("mouseup.ColReorder",function(e){s._fnMouseUp.call(s,e)}))},_fnMouseMove:function(e){if(null===this.dom.drag){if(5>Math.pow(Math.pow(e.pageX-this.s.mouse.startX,2)+Math.pow(e.pageY-this.s.mouse.startY,2),.5))return;this._fnCreateDragNode()}this.dom.drag.css({left:e.pageX-this.s.mouse.offsetX,top:e.pageY-this.s.mouse.offsetY});for(var t=!1,n=this.s.mouse.toIndex,r=1,i=this.s.aoTargets.length;r<i;r++)if(e.pageX<this.s.aoTargets[r-1].x+(this.s.aoTargets[r].x-this.s.aoTargets[r-1].x)/2){this.dom.pointer.css("left",this.s.aoTargets[r-1].x),this.s.mouse.toIndex=this.s.aoTargets[r-1].to,t=!0;break}t||(this.dom.pointer.css("left",this.s.aoTargets[this.s.aoTargets.length-1].x),this.s.mouse.toIndex=this.s.aoTargets[this.s.aoTargets.length-1].to),this.s.init.bRealtime&&n!==this.s.mouse.toIndex&&(this.s.dt.oInstance.fnColReorder(this.s.mouse.fromIndex,this.s.mouse.toIndex),this.s.mouse.fromIndex=this.s.mouse.toIndex,this._fnRegions())},_fnMouseUp:function(){e(t).off("mousemove.ColReorder mouseup.ColReorder"),null!==this.dom.drag&&(this.dom.drag.remove(),this.dom.pointer.remove(),this.dom.drag=null,this.dom.pointer=null,this.s.dt.oInstance.fnColReorder(this.s.mouse.fromIndex,this.s.mouse.toIndex),this._fnSetColumnIndexes(),(""!==this.s.dt.oScroll.sX||""!==this.s.dt.oScroll.sY)&&this.s.dt.oInstance.fnAdjustColumnSizing(),null!==this.s.dropCallback&&this.s.dropCallback.call(this),this.s.dt.oInstance.oApi._fnSaveState(this.s.dt))},_fnRegions:function(){var t=this.s.dt.aoColumns;this.s.aoTargets.splice(0,this.s.aoTargets.length),this.s.aoTargets.push({x:e(this.s.dt.nTable).offset().left,to:0});for(var n=0,r=0,i=t.length;r<i;r++)r!=this.s.mouse.fromIndex&&n++,t[r].bVisible&&this.s.aoTargets.push({x:e(t[r].nTh).offset().left+e(t[r].nTh).outerWidth(),to:n});0!==this.s.fixedRight&&this.s.aoTargets.splice(this.s.aoTargets.length-this.s.fixedRight),0!==this.s.fixed&&this.s.aoTargets.splice(0,this.s.fixed)},_fnCreateDragNode:function(){var t=""!==this.s.dt.oScroll.sX||""!==this.s.dt.oScroll.sY,n=this.s.dt.aoColumns[this.s.mouse.targetIndex].nTh,r=n.parentNode,i=r.parentNode,s=i.parentNode,o=e(n).clone();this.dom.drag=e(s.cloneNode(!1)).addClass("DTCR_clonedTable").append(i.cloneNode(!1).appendChild(r.cloneNode(!1).appendChild(o[0]))).css({position:"absolute",top:0,left:0,width:e(n).outerWidth(),height:e(n).outerHeight()}).appendTo("body"),this.dom.pointer=e("<div></div>").addClass("DTCR_pointer").css({position:"absolute",top:t?e("div.dataTables_scroll",this.s.dt.nTableWrapper).offset().top:e(this.s.dt.nTable).offset().top,height:t?e("div.dataTables_scroll",this.s.dt.nTableWrapper).height():e(this.s.dt.nTable).height()}).appendTo("body")},_fnDestroy:function(){var t,n;t=0;for(n=this.s.dt.aoDrawCallback.length;t<n;t++)if("ColReorder_Pre"===this.s.dt.aoDrawCallback[t].sName){this.s.dt.aoDrawCallback.splice(t,1);break}e(this.s.dt.nTHead).find("*").off(".ColReorder"),e.each(this.s.dt.aoColumns,function(t,n){e(n.nTh).removeAttr("data-column-index")}),this.s=this.s.dt._colReorder=null},_fnSetColumnIndexes:function(){e.each(this.s.dt.aoColumns,function(t,n){e(n.nTh).attr("data-column-index",t)})}},s.defaults={aiOrder:null,bRealtime:!1,iFixedColumns:0,iFixedColumnsRight:0,fnReorderCallback:null},s.version="1.1.1",e.fn.dataTable.ColReorder=s,e.fn.DataTable.ColReorder=s,"function"==typeof e.fn.dataTable&&"function"==typeof e.fn.dataTableExt.fnVersionCheck&&e.fn.dataTableExt.fnVersionCheck("1.9.3")?e.fn.dataTableExt.aoFeatures.push({fnInit:function(e){var t=e.oInstance;return e._colReorder?t.oApi._fnLog(e,1,"ColReorder attempted to initialise twice. Ignoring second"):(t=e.oInit,new s(e,t.colReorder||t.oColReorder||{})),null},cFeature:"R",sFeature:"ColReorder"}):alert("Warning: ColReorder requires DataTables 1.9.3 or greater - www.datatables.net/download"),e.fn.dataTable.Api&&(e.fn.dataTable.Api.register("colReorder.reset()",function(){return this.iterator("table",function(e){e._colReorder.fnReset()})}),e.fn.dataTable.Api.register("colReorder.order()",function(e){return e?this.iterator("table",function(t){t._colReorder.fnOrder(e)}):this.context.length?this.context[0]._colReorder.fnOrder():null})),s},"function"==typeof define&&define.amd?define("datatables-colreorder",["jquery","datatables"],e):jQuery&&!jQuery.fn.dataTable.ColReorder&&e(jQuery,jQuery.fn.dataTable)})(window,document);