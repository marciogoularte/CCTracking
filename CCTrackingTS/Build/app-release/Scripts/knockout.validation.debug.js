(function(){function s(e,t,n){return t.validator(e(),n.params===undefined?!0:n.params)?!0:(e.error=ko.validation.formatMessage(n.message||t.message,n.params),e.__valid__(!1),!1)}function o(e,t,n){e.isValidating(!0);var r=function(r){var i=!1,s="";if(!e.__valid__()){e.isValidating(!1);return}r.message?(i=r.isValid,s=r.message):i=r,i||(e.error=ko.validation.formatMessage(s||n.message||t.message,n.params),e.__valid__(i)),e.isValidating(!1)};t.validator(e(),n.params||!0,r)}if(typeof ko===undefined)throw"Knockout is required, please ensure it is loaded before loading this validation plug-in";var e={registerExtenders:!0,messagesOnModified:!0,messageTemplate:null,insertMessages:!0,parseInputAttributes:!1,writeInputAttributes:!1,decorateElement:!1,errorClass:null,errorElementClass:"validationElement",errorMessageClass:"validationMessage",grouping:{deep:!1,observable:!0}},t=ko.utils.extend({},e),n=["required","pattern","min","max","step"],r=function(e){window.setImmediate?window.setImmediate(e):window.setTimeout(e,0)},i=function(){var e=(new Date).getTime(),n={},r="__ko_validation__";return{isArray:function(e){return e.isArray||Object.prototype.toString.call(e)==="[object Array]"},isObject:function(e){return e!==null&&typeof e=="object"},values:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},getValue:function(e){return typeof e=="function"?e():e},hasAttribute:function(e,t){return e.getAttribute(t)!==null},isValidatable:function(e){return e.rules&&e.isValid&&e.isModified},insertAfter:function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},newId:function(){return e+=1},getConfigOptions:function(e){var n=i.contextFor(e);return n||t},setDomData:function(e,t){var s=e[r];s||(e[r]=s=i.newId()),n[s]=t},getDomData:function(e){var t=e[r];return t?n[t]:undefined},contextFor:function(e){switch(e.nodeType){case 1:case 8:var t=i.getDomData(e);if(t)return t;if(e.parentNode)return i.contextFor(e.parentNode)}return undefined},isEmptyVal:function(e){if(e===undefined)return!0;if(e===null)return!0;if(e==="")return!0}}}();ko.validation=function(){var r=0;return{utils:i,init:function(e,n){if(r>0&&!n)return;e=e||{},e.errorElementClass=e.errorElementClass||e.errorClass||t.errorElementClass,e.errorMessageClass=e.errorMessageClass||e.errorClass||t.errorMessageClass,ko.utils.extend(t,e),t.registerExtenders&&ko.validation.registerExtenders(),r=1},configure:function(e){ko.validation.init(e)},reset:function(){t=$.extend(t,e)},group:function(n,r){var r=ko.utils.extend(t.grouping,r),s=ko.observableArray([]),o=null,u=function a(e,t){var n=[],o=ko.utils.unwrapObservable(e);t=t!==undefined?t:r.deep?1:-1,ko.isObservable(e)&&(e.isValid||e.extend({validatable:!0}),s.push(e)),o&&(i.isArray(o)?n=o:i.isObject(o)&&(n=i.values(o))),t!==0&&ko.utils.arrayForEach(n,function(e){e&&!e.nodeType&&a(e,t+1)})};return r.observable?(u(n),o=ko.computed(function(){var e=[];return ko.utils.arrayForEach(s(),function(t){t.isValid()||e.push(t.error)}),e})):o=function(){var e=[];return s([]),u(n),ko.utils.arrayForEach(s(),function(t){t.isValid()||e.push(t.error)}),e},o.showAllMessages=function(e){e==undefined&&(e=!0),o(),ko.utils.arrayForEach(s(),function(t){t.isModified(e)})},n.errors=o,n.isValid=function(){return n.errors().length===0},n.isAnyMessageShown=function(){var e=!1;return o(),ko.utils.arrayForEach(s(),function(t){!t.isValid()&&t.isModified()&&(e=!0)}),e},o},formatMessage:function(e,t){return e.replace(/\{0\}/gi,t)},addRule:function(e,t){return e.extend({validatable:!0}),e.rules.push(t),e},addAnonymousRule:function(e,t){var n=i.newId();t.message===undefined&&(rulesObj.message="Error"),ko.validation.rules[n]=t,ko.validation.addRule(e,{rule:n,params:t.params})},addExtender:function(e){ko.extenders[e]=function(t,n){return n.message||n.onlyIf?ko.validation.addRule(t,{rule:e,message:n.message,params:i.isEmptyVal(n.params)?!0:n.params,condition:n.onlyIf}):ko.validation.addRule(t,{rule:e,params:n})}},registerExtenders:function(){if(t.registerExtenders)for(var e in ko.validation.rules)ko.validation.rules.hasOwnProperty(e)&&(ko.extenders[e]||ko.validation.addExtender(e))},insertValidationMessage:function(e){var t=document.createElement("SPAN");return t.className=i.getConfigOptions(e).errorMessageClass,i.insertAfter(e,t),t},parseInputValidationAttributes:function(e,t){ko.utils.arrayForEach(n,function(n){i.hasAttribute(e,n)&&ko.validation.addRule(t(),{rule:n,params:e.getAttribute(n)||!0})})},writeInputValidationAttributes:function(e,t){var r=t();if(!r||!r.rules)return;var i=r.rules();ko.utils.arrayForEach(n,function(t){var n,r=ko.utils.arrayFirst(i,function(e){return e.rule.toLowerCase()===t.toLowerCase()});if(!r)return;n=r.params,r.rule=="pattern"&&r.params instanceof RegExp&&(n=r.params.source),e.setAttribute(t,n)}),i=null}}}(),ko.validation.rules={},ko.validation.rules.required={validator:function(e,t){var n=/^\s+|\s+$/g,r;return e===undefined||e===null?!t:(r=e,typeof e=="string"&&(r=e.replace(n,"")),t&&(r+"").length>0)},message:"This field is required."},ko.validation.rules.min={validator:function(e,t){return i.isEmptyVal(e)||e>=t},message:"Please enter a value greater than or equal to {0}."},ko.validation.rules.max={validator:function(e,t){return i.isEmptyVal(e)||e<=t},message:"Please enter a value less than or equal to {0}."},ko.validation.rules.minLength={validator:function(e,t){return i.isEmptyVal(e)||e.length>=t},message:"Please enter at least {0} characters."},ko.validation.rules.maxLength={validator:function(e,t){return i.isEmptyVal(e)||e.length<=t},message:"Please enter no more than {0} characters."},ko.validation.rules.pattern={validator:function(e,t){return i.isEmptyVal(e)||e.match(t)!=null},message:"Please check this value."},ko.validation.rules.step={validator:function(e,t){return i.isEmptyVal(e)||e*100%(t*100)===0},message:"The value must increment by {0}"},ko.validation.rules.email={validator:function(e,t){return i.isEmptyVal(e)||t&&/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)},message:"Please enter a proper email address"},ko.validation.rules.date={validator:function(e,t){return i.isEmptyVal(e)||t&&!/Invalid|NaN/.test(new Date(e))},message:"Please enter a proper date"},ko.validation.rules.dateISO={validator:function(e,t){return i.isEmptyVal(e)||t&&/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(e)},message:"Please enter a proper date"},ko.validation.rules.number={validator:function(e,t){return i.isEmptyVal(e)||t&&/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(e)},message:"Please enter a number"},ko.validation.rules.digit={validator:function(e,t){return i.isEmptyVal(e)||t&&/^\d+$/.test(e)},message:"Please enter a digit"},ko.validation.rules.phoneUS={validator:function(e,t){return typeof e!="string"?!1:i.isEmptyVal(e)?!0:(e=e.replace(/\s+/g,""),t&&e.length>9&&e.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/))},message:"Please specify a valid phone number"},ko.validation.rules.equal={validator:function(e,t){var n=t;return e===i.getValue(n)},message:"Values must equal"},ko.validation.rules.notEqual={validator:function(e,t){var n=t;return e!==i.getValue(n)},message:"Please choose another value."},ko.validation.rules.unique={validator:function(e,t){var n=i.getValue(t.collection),r=i.getValue(t.externalValue),s=0;return!e||!n?!0:(ko.utils.arrayFilter(ko.utils.unwrapObservable(n),function(n){e===(t.valueAccessor?t.valueAccessor(n):n)&&s++}),s<(r!==undefined&&e!==r?1:2))},message:"Please make sure the value is unique."},function(){ko.validation.registerExtenders()}(),ko.bindingHandlers.validationCore=function(){return{init:function(e,t,n,s,o){var u=i.getConfigOptions(e);u.parseInputAttributes&&r(function(){ko.validation.parseInputValidationAttributes(e,t)});if(u.insertMessages&&i.isValidatable(t())){var a=ko.validation.insertValidationMessage(e);u.messageTemplate?ko.renderTemplate(u.messageTemplate,{field:t()},null,a,"replaceNode"):ko.applyBindingsToNode(a,{validationMessage:t()})}u.writeInputAttributes&&i.isValidatable(t())&&ko.validation.writeInputValidationAttributes(e,t),u.decorateElement&&i.isValidatable(t())&&ko.applyBindingsToNode(e,{validationElement:t()})},update:function(e,t,n,r,i){}}}(),function(){var e=ko.bindingHandlers.value.init;ko.bindingHandlers.value.init=function(t,n,r,i,s){return e(t,n,r),ko.bindingHandlers.validationCore.init(t,n,r,i,s)}}(),ko.bindingHandlers.validationMessage={update:function(e,t){var n=t(),r=i.getConfigOptions(e),s=ko.utils.unwrapObservable(n),o=null,u=!1,a=!1;n.extend({validatable:!0}),u=n.isModified(),a=n.isValid();var f=function(){return!r.messagesOnModified||u?a?null:n.error:null},l=function(){return u?!a:!1};ko.bindingHandlers.text.update(e,f),ko.bindingHandlers.visible.update(e,l)}},ko.bindingHandlers.validationElement={update:function(e,t){var n=t(),r=i.getConfigOptions(e),s=ko.utils.unwrapObservable(n),o=null,u=!1,a=!1;n.extend({validatable:!0}),u=n.isModified(),a=n.isValid();var f=function(){var e={},t=u?!a:!1;return r.decorateElement||(t=!1),e[r.errorElementClass]=t,e};ko.bindingHandlers.css.update(e,f)}},ko.bindingHandlers.validationOptions=function(){return{init:function(e,n,r,s,o){var u=ko.utils.unwrapObservable(n());if(u){var a=ko.utils.extend({},t);ko.utils.extend(a,u),i.setDomData(e,a)}}}}(),ko.extenders.validation=function(e,t){return ko.utils.arrayForEach(i.isArray(t)?t:[t],function(t){ko.validation.addAnonymousRule(e,t)}),e},ko.extenders.validatable=function(e,t){if(t&&!i.isValidatable(e)){e.error=null,e.rules=ko.observableArray(),e.isValidating=ko.observable(!1),e.__valid__=ko.observable(!0),e.isModified=ko.observable(!1);var n=ko.computed(function(){var t=e(),n=e.rules();return ko.validation.validateObservable(e),!0});e.isValid=ko.computed(function(){return e.__valid__()});var r=e.subscribe(function(){e.isModified(!0)});e._disposeValidation=function(){e.isValid.dispose(),e.rules.removeAll(),e.isModified._subscriptions.change=[],e.isValidating._subscriptions.change=[],e.__valid__._subscriptions.change=[],r.dispose(),n.dispose(),delete e.rules,delete e.error,delete e.isValid,delete e.isValidating,delete e.__valid__,delete e.isModified}}else t===!1&&i.isValidatable(e)&&e._disposeValidation&&e._disposeValidation();return e},ko.validation.validateObservable=function(e){var t=0,n,r,i=e.rules(),u=i.length;for(;t<u;t++){r=i[t];if(r.condition&&!r.condition())continue;n=ko.validation.rules[r.rule];if(n.async||r.async)o(e,n,r);else if(!s(e,n,r))return!1}return e.error=null,e.__valid__(!0),!0},ko.validatedObservable=function(e){if(!ko.validation.utils.isObject(e))return ko.observable(e).extend({validatable:!0});var t=ko.observable(e);return t.errors=ko.validation.group(e),t.isValid=ko.computed(function(){return t.errors().length===0}),t},ko.validation.localize=function(e){var t,n;for(n in e)ko.validation.rules.hasOwnProperty(n)&&(ko.validation.rules[n].message=e[n])},ko.applyBindingsWithValidation=function(e,t,n){var r=arguments.length,i,s;r>2?(i=t,s=n):r<2?i=document.body:arguments[1].nodeType?i=t:s=arguments[1],ko.validation.init(),s&&ko.validation.utils.setDomData(i,s),ko.applyBindings(e,t)};var u=ko.applyBindings;ko.applyBindings=function(e,t){ko.validation.init(),u(e,t)}})();