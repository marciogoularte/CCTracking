var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define(["require","exports","../../../App","../../../Helper","./DriverSummaryView","../../../Dtos/DriverDto","../../../DAL/Driver","marionette","jquery","knockout"],function(e,t,n,r,i,s,o){var u=e("underscore"),a=e("knockout"),f=e("knockback"),l=function(e){function t(){e.call(this),this.app=n.Application.getInstance(),this.backboneModel=new s.Models.DriverSummaryDto,this.compositeModel=new Backbone.Model,this.backboneCollection=new Backbone.Collection([]),this.collectionView=new i.DriverSummaryCollectionView({collection:this.backboneCollection}),this.backboneCollection.reset([])}return __extends(t,e),t.prototype.Show=function(){var e=this,t=o.GetAllSummary();t.done(function(t){return e.GetDrvierSummaryCompleted(t)}),this.app.MainRegion.show(this.collectionView),this.collectionView.listenTo(this.collectionView,"itemview:DriverSummaryDetail",function(t,n){return e.GetDriverDetial(n)})},t.prototype.GetDriverDetial=function(e){var t=this,n=o.GetAllDetail(e);n.done(function(e){return t.GetDriverDetailCompleted(e)})},t.prototype.GetDriverDetailCompleted=function(e){var t=e.driverList,n=[];for(var s=0;s<t.length;s++)n[s]={driverName:t[s].driverName,vehicleNo:t[s].vehicleNo,visitDate:r.FormatDateString(t[s].visitDate),visitInterval:t[s].visitInterval,bookingId:t[s].bookingId};var o=new Backbone.Collection([]),u=new i.DriverDetailCollectionView({collection:o});this.app.MainRegion.show(u),o.reset(n),location.href="#driverDetail"},t.prototype.GetDrvierSummaryCompleted=function(e){var t=e.driverList,n=[];for(var r=0;r<t.length;r++)n[r]={driverId:t[r].driverId,driverName:t[r].driverName,milage:t[r].milage,visitCount:t[r].visitCount};this.backboneCollection.reset(n)},t.prototype.Cancel=function(){window.location.href="#driverSummary"},t}(r.Controller);t.DriverSummaryCtrl=l});