var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define(["require","exports","./App","underscore","jquery","knockout","knockback","marionette","backbone","accounting"],function(e,t,n){function p(t,n,r){e(["./Booking/BookingLeft/BookingLeftCtrl"],function(e){(new e.BookingLeftCtrl).ShowModalPopup(t,n,r)})}function d(){e(["./Booking/BookingLeft/BookingLeftCtrl"],function(e){(new e.BookingLeftCtrl).ShowProgressbar()})}function v(){e(["./Booking/BookingLeft/BookingLeftCtrl"],function(e){(new e.BookingLeftCtrl).HideProgressbar()})}function m(t){e(["./Booking/BookingLeft/BookingLeftCtrl"],function(e){(new e.BookingLeftCtrl).PrintReceipt(t)})}function g(t,n){var r=null;e(["./Booking/BookingLeft/BookingLeftView"],function(e){r=new e.BusDetailModalPopupCollectionView({collection:n,model:t}),u.ModalAlertRegion.show(r)})}function y(){var e=r('[data-role="validate"]'),t=0;e.popover({placement:"bottom"}),e.on("invalid",function(){t===0&&(r("#"+this.id).popover("show"),t++)}),e.on("blur",function(){r("#"+this.id).popover("hide")});var n=function(e){return t=0,e.indexOf("#")===-1&&(e="#"+e),r(e)[0].checkValidity()};return{validate:n}}function b(e){e.push({centreId:"center-d",busId:"bus-d",driverId:"driver-d"})}function w(){alert("remove")}function E(e){return(new Date(e)).toLocaleDateString()}function S(e){return e=e.replace(/T/g," "),(new Date(e)).toLocaleDateString()+" "+(new Date(e)).toLocaleTimeString()}function x(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)"),r=n.exec(t);return r===null?"":decodeURIComponent(r[1].replace(/\+/g," "))}function T(e){return i.formatMoney(e)}function N(){return 50}function C(){return 60}function L(){u.vent.trigger("Event-PrintDocument")}function A(t,n,r,i){e(["./Print/PrintCtrl"],function(e){var s=new e.PrintCtrl;u.ModalRegion.show(s.getPrintReportView(t,n,r,i))})}function O(){var e=[],t=r(".PrintArea"),n="popup",i=n=="popup"&&!0,s="";["class","id","style","on"];var o='<meta charset="utf-8" />,<meta http-equiv="X - UA - Compatible" content="IE = edge"/>',u={mode:n,popClose:i,extraCss:s,retainAttr:e,extraHead:o};r(t).printArea(u)}var r=e("jquery"),i=e("accounting"),s=e("knockout"),o=e("knockback"),u=n.Application.getInstance();String.prototype.getOuterHTML=function(e){return r(this.toString()).find(e)[0].outerHTML},u.vent.on("Event:UpdateSummary",function(){e(["./Booking/BookingLeft/BookingLeftCtrl"],function(e){(new e.BookingLeftCtrl).Show()})}),u.vent.on("Event-PrintDocument",function(){O()}),u.vent.on("Event-BackToLogin",function(e){u.reqres.hasHandler("AppGlobalSetting")&&(u.reqres.setHandler("AppGlobalSetting",null,null),u.reqres.removeHandler("AppGlobalSetting")),e?(t.ShowModalPopup("danger","Un-Authorize Access","You are not authorize to access the page."),setTimeout(function(){window.location.href=""},3e3)):window.location.href=""}),r.extend(!0,r.fn.dataTable.defaults,{sDom:"<'row'<'col-xs-12 col-sm-12 col-md-12 hidden'l><'col-xs-12 col-sm-12 col-md-12 text-right'f>r>t<'row'<'col-xs-12 col-sm-12 col-md-12'i><'col-xs-12 col-sm-12 col-md-12 text-center'p>>",language:{search:"Filter: "}}),i.settings={currency:{symbol:"",format:"%s%v",decimal:".",thousand:",",precision:2},number:{precision:0,thousand:",",decimal:"."}};var a=function(){function e(){}return e}();t.Controller=a;var f=function(){function e(e,t){this.model=o.viewModel(e),this.bbModel=e,this.controller=t}return e}();t.ViewModel=f;var l=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{centreDesc:"",receiptNo:"",printDateAndTime:"",bookingId:"",bookingDate:"",cashReceivedFrom:"",totalAmountDue:"",userName:"",isActive:"",createdBy:"",createdDate:"",modifiedBy:"",modifiedDate:""}},t}(Backbone.Model);t.ReceiptLayoutDto=l;var c=function(e){function t(t){this.model=l,e.call(this,t)}return __extends(t,e),t}(Backbone.Collection);t.ReceiptLayoutCollection=c,function(e){var t=function(e){function t(t){e.call(this,t)}return __extends(t,e),t}(Marionette.CollectionView);e.CollectionView=t;var n=function(e){function t(t){t||(t={}),e.call(this,t)}return __extends(t,e),t}(Marionette.CompositeView);e.CompositeView=n;var i=function(e){function t(t){t||(t={}),e.call(this,t)}return __extends(t,e),t}(Marionette.ItemView);e.ItemView=i;var o=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.initialize=function(e){e.viewModel!==undefined&&(this.viewModel=e.viewModel,e.model=this.viewModel.model)},t.prototype.onShow=function(){s.applyBindings(this.viewModel,this.el)},t.prototype.onClose=function(){s.cleanNode(r(this.el)[0])},t}(i);e.MvvmView=o}(t.Views||(t.Views={}));var h=t.Views;t.ShowModalPopup=p,t.ShowProgressbar=d,t.HideProgressbar=v,t.PrintReceipt=m,t.ShowBusDetailModalPopup=g,r.ajaxSetup({beforeSend:function(e){t.ShowProgressbar(),u.reqres.hasHandler("AppGlobalSetting")&&e.setRequestHeader("AuthenticationToken",u.request("AppGlobalSetting").get("AuthenticationToken"))},complete:function(e,n){t.HideProgressbar()}}),r(document).ajaxError(function(e,t,n,r){t.status==401&&u.vent.trigger("Event-BackToLogin",!0)}),t.ValidationUtility=y,t.FormatDateString=E,t.FormatDateTimeString=S,t.GetParameterByName=x,t.FormatMoney=T,t.GetPageSize=N,t.GetNoOfDaysConfiguration=C,function(e){e[e.PatrolPump=1]="PatrolPump",e[e.Booking=2]="Booking",e[e.Maintenance=3]="Maintenance",e[e.Others=4]="Others"}(t.VisitTypes||(t.VisitTypes={}));var k=t.VisitTypes;s.bindingHandlers.numeric={init:function(e,t){r(e).on("keydown",function(e){if(e.keyCode==46||e.keyCode==8||e.keyCode==9||e.keyCode==27||e.keyCode==13||e.keyCode==65&&e.ctrlKey===!0||e.keyCode==188||e.keyCode==190||e.keyCode==110||e.keyCode>=35&&e.keyCode<=39)return;(e.shiftKey||(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105))&&e.preventDefault()})}},t.PrintDocument=L,t.PrintReport=A});