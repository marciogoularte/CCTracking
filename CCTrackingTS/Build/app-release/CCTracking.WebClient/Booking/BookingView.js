var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define(["require","exports","../Helper","marionette","jquery","jqueryUI","knockout","text!./BookingTmpl.html","text!./BookingGrid.html","text!./BokingGridRow.html"],function(e,t,n){function h(e){var t=JSON.parse(localStorage.getItem("lookupResponse")),n=r.filter(t.unionCouncil,function(t){return t.id==e});return n}function p(e){var t=JSON.parse(localStorage.getItem("lookupResponse")),n=r.filter(t.town,function(t){return t.id==e});return n}var r=e("underscore"),i=e("text!./BookingTmpl.html"),s=e("text!./BookingGrid.html"),o=e("text!./BokingGridRow.html"),u,a=function(e){function t(t,n){var r=this;e.call(this,t,n),this.model.busPointSelected.subscribe(function(){var e=h(r.model.busPointSelected().parentId);r.model.unionCouncilList(e)}),this.model.unionCouncilIdSelected.subscribe(function(){var e=p(r.model.unionCouncilIdSelected().parentId);r.model.townList(e)})}return __extends(t,e),t}(n.ViewModel);t.BookingViewModel=a;var f=function(e){function t(t){this.template=i,this.events={submit:"Save","click .jsCancel":"Cancel"},e.call(this,t)}return __extends(t,e),t.prototype.Cancel=function(){window.location.href="#viewBooking"},t.prototype.onDomRefresh=function(){var e=JSON.parse(localStorage.getItem("lookupResponse")),t=r.map(e.landmark,function(e){return{value:e.id,text:e.description,parentId:e.parentId}}),n=this.$el.find("#ddlBusPoint").selectize({options:t,create:!1,sortField:{field:"text",direction:"asc"},dropdownParent:"body"}),i=this;this.$el.find("#ddlBusPoint").on("change",function(t){var s=r.filter(e.landmark,function(e){return e.id==n[0].value});if(s[0]!=undefined){i.viewModel.model.busPointSelected(s[0]);var o=h(s[0].parentId);i.viewModel.model.unionCouncilList(o)}})},t.prototype.Save=function(e){e.preventDefault(),this.trigger("SaveBooking")},t.prototype.ExportToPdf=function(e){n.PrintReceipt(e)},t}(n.Views.MvvmView);t.BookingView=f;var l=function(e){function t(t){this.itemView=c,this.template=s.getOuterHTML("#gridTemplate"),this.itemViewContainer="tbody",e.call(this,t)}return __extends(t,e),t.prototype.onShow=function(){this.dataTable=this.$el.find("#tblBooking").dataTable({autoWidth:!1,info:!0,processing:!0,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],language:{paginate:{next:"Next",previous:"Prev"},emptyTable:"No record found!",infoEmpty:"No record found!",zeroRecords:"No record found!"},pageLength:n.GetPageSize()})},t}(n.Views.CompositeView);t.BookingCollectionView=l;var c=function(e){function t(t){var n=this;t.template=o.getOuterHTML("#rowTemplate"),t.tagName="tr",t.className="jsRowClick",t.events={"mouseover .jsShowDetail":"ShowDetail","click .jsExportToPdf":function(){n.trigger("ExportToPdf",n.model.get("id"))},"click .jsShowDetail":"ShowDetail","click .jsEditBooking":"EditBooking","click .jsEditPayment":"EditPayment","click .jsEditRefund":"EditRefund","click .jsEditExtraCharge":"EditExtraCharge"},e.call(this,t)}return __extends(t,e),t.prototype.EditBooking=function(e){e.preventDefault(),window.location.href="#editBooking",this.trigger("Event:EditBooking",this.model.get("id"))},t.prototype.EditPayment=function(e){e.preventDefault(),window.location.href="#editPayment",this.trigger("Event:EditPayment",this.model.get("id"))},t.prototype.EditRefund=function(e){e.preventDefault(),window.location.href="#editRefund",this.trigger("Event:EditRefund",this.model.get("id"))},t.prototype.EditExtraCharge=function(e){e.preventDefault(),window.location.href="#editExtraCharge",this.trigger("Event:EditExtraCharge",this.model.get("id"))},t.prototype.ShowDetail=function(){},t}(n.Views.ItemView);t.BookingItemView=c});