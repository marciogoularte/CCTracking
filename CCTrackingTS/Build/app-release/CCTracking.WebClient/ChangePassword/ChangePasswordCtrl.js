var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define(["require","exports","../App","../Helper","./ChangePasswordView","../Dtos/LoginDto","../DAL/Login","marionette","jquery","knockout","text!./ChangePassword.html"],function(e,t,n,r,i,s,o){var u=e("underscore"),a=e("knockout"),f=e("knockback"),l=function(e){function t(){e.call(this),this.app=n.Application.getInstance(),this.backboneModel=new s.Models.LoginDto,this.changePasswordViewModel=new i.ChangePasswordViewModel(this.backboneModel,this),this.changePasswordView=new i.ChangePasswordView({viewModel:this.changePasswordViewModel})}return __extends(t,e),t.prototype.Load=function(){var e=this;this.changePasswordView=new i.ChangePasswordView;var t=this.app.AppLayout;this.app.MainRegion.show(this.changePasswordView),this.changePasswordView.on("ChangePassword",function(){return e.ChangePassword(e.changePasswordViewModel.bbModel)})},t.prototype.ChangePassword=function(e){var t=this,n=$("#txtPassword").val(),i=$("#txtResetPassword").val(),s=$("#txtReEnterPassword").val();if(i!=s){r.ShowModalPopup("danger","Reset Password","New Password and Re-Enter Password are not same.<br>Please enter same password.");return}var u=this.app.request("AppGlobalSetting");e.set("userName",u.get("UserName")),e.set("password",n),e.set("changePassword",i);var a=o.ChangePasswrd(e);a.done(function(e){return t.Authenticated(e)})},t.prototype.Authenticated=function(e){var t=new Backbone.Model(e);if(t==undefined){r.ShowModalPopup("danger","Reset Password","Due to some technical reason password have not been reset successfully!<br> Pelase try later");return}if(t.get("errorMessage")!=undefined&&t.get("errorMessage").trim()!=""){r.ShowModalPopup("danger","Reset Password",t.get("errorMessage"));return}r.ShowModalPopup("success","Reset Password","Password has been reset successfully")},t}(r.Controller);t.ChangePasswordCtrl=l});