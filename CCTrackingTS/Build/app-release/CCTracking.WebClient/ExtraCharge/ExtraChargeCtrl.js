var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define(["require","exports","../App","../Helper","./ExtraChargeView","../DAL/ExtraCharges","marionette","jquery","knockout"],function(e,t,n,r,i,s){var o=e("underscore"),u=e("knockout"),a=e("knockback"),f,l=function(e){function t(){f=n.Application.getInstance(),e.call(this)}return __extends(t,e),t.prototype.EditExtraCharge=function(e){var t=this,n=s.GetById(e);n.done(function(e){t.GetByIdCompleted(e)})},t.prototype.GetByIdCompleted=function(e){var t=this;this.collection=e.extraChargesList,this.backboneModel=new Backbone.Model(this.collection[0]);var n=this.backboneModel,r=window.location.href,s=r.substring(r.indexOf("id=")+3,r.length);(n.get("id")===undefined||n.get("id")===0)&&this.InitalizeKoBinding(n),n.set("bookingId",s),n.set("busList",n.get("busList")),n.set("busSelected",""),this.view=new i.ExtraChargeView(n),this.view.on("ExtraChargesSave",function(e){return t.Save(e)}),n.set("extraChargesCollection",this.collection),f.MainRegion.show(this.view)},t.prototype.InitalizeKoBinding=function(e){e.set("extraAmountCharge",""),e.set("extraAmountReason",""),e.set("extraAmountReceipt","")},t.prototype.Save=function(e){var t=this,n=f.request("AppGlobalSetting");e.set("modifiedBy",n.get("Id")),e.set("id",$("#hdnExtraChargeId").val());var r=s.Save(e);r.done(function(e){return t.SaveCompleted(e)})},t.prototype.SaveCompleted=function(e){var t=new Backbone.Model(e);t.get("errorMessage")!=undefined&&t.get("errorMessage").trim()!=""?r.ShowModalPopup("danger","Extra Charge","Due to some technical reason payment have not been saved successfully!<br> Pelase try later"):(r.ShowModalPopup("success","Extra Charge","Record has been saved successfully with Extra Charge ID : "+e.id),location.href="#viewBooking")},t}(r.Controller);t.ExtraChargeCtrl=l});