define("CCTracking.WebClient/appMain",function(){}),define("text!CCTracking.WebClient/Home/Home.html",[],function(){return'<div>\r\n    <div id="Home">\r\n        <div class="panel panel-default">\r\n            <div class="panel-heading header-bold"><span class="fa fa-dashboard">&nbsp;</span> CC TRACKING DASHBOARD</div>\r\n            <div class="panel-body dashboard-fontSize">\r\n                <div class="row">\r\n                    <div class="col-sm-11 col-md-11" id="container">\r\n                    </div>\r\n                </div>\r\n                 <div>\r\n                    <hr />\r\n                </div>\r\n                 <div class="row">\r\n                    <div>&nbsp;</div>\r\n                </div>\r\n                <div class="row">\r\n                    <div id="SubRegion" class="col-sm-12 col-md-12">\r\n                        \r\n                    </div>\r\n                </div>\r\n                <div>\r\n                    <hr />\r\n                </div>\r\n\r\n                <!-- Start Booking Receipt -->\r\n                <div style="display: none">\r\n                    <button type="button" class="jsPrintReceipt btn btn-default" >Export to Pdf</button>\r\n                </div>\r\n                \r\n                <!-- End Booking Receipt -->\r\n               \r\n            </div>\r\n        </div>\r\n    </div>\r\n    \r\n  \r\n\r\n</div>\r\n\r\n<div>\r\n    <script type="text/html" id="gridTemplate">\r\n        <button id="btnPrintDocument" class="jsPrintDocument btn btn-default">Print</button>\r\n        <table id="tblSearch" class="table table-condensed table-bordered table-hover table-striped">\r\n            <thead>\r\n                <tr class="active">\r\n                    <th class="input-sm">Centre Name</th>\r\n                    <th class="input-sm">Booking Amount</th>\r\n                    <th class="input-sm">Maintenance</th>\r\n                    <th class="input-sm">Booking Milage</th>\r\n                    <th class="input-sm">Bookings</th>\r\n                    <th class="input-sm">Receivables</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody></tbody>\r\n            <tfoot>\r\n                <tr class="active">\r\n                    <td >Summary</td>\r\n                    <td ><%=totalBookingAmount%></td>\r\n                    <td><%=totalMaintenance%></td>\r\n                    <td ><%=totalBookingMilage%></td>\r\n                    <td ><%=totalBookings%></td>\r\n                    <td ><%=totalReceivables%></td>\r\n                </tr>\r\n            </tfoot>\r\n        </table>\r\n    </script>\r\n    <script type="text/html" id="rowTemplate">\r\n        <td class="jsShowDetail input-sm" style="cursor: hand; cursor: pointer"><%=alkhidmatCentre%></td>\r\n        <td class="input-sm"><%=bookingAmount%></td>\r\n        <td class="input-sm"><%=maintenance%></td>\r\n        <td class="input-sm"><%=bookingMilage%></td>\r\n        <td class="input-sm"><%=bookings%></td>\r\n        <td class="input-sm"><%=receivables%></td>\r\n\r\n    </script>\r\n</div>'});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Home/HomeView",["require","exports","../Helper","marionette","jquery","jqueryUI","knockout","text!./Home.html"],function(e,t,n){var r=e("underscore"),i=e("text!./Home.html"),s,o=function(e){function t(t){this.template=i.getOuterHTML("#Home");var r=new Backbone.Collection({centreDesc:"Head Office - Noor-ul-Huda Centre, Near Numayesh Chorangi",receiptNo:"112345",printDateAndTime:n.FormatDateString(Date.now()),bookingId:"140",bookingDate:"01/01/2015",cashReceivedFrom:"Mr abc",totalAmountDue:n.FormatMoney("2500"),userName:"Current logged in user"});this.events={submit:"Save","click .jsCancel":"Cancel","click .jsPrintReceipt":function(){n.PrintReceipt(r)}},e.call(this,t)}return __extends(t,e),t}(n.Views.ItemView);t.HomeItemView=o;var u=function(e){function t(t){this.itemView=a,this.template=i.getOuterHTML("#gridTemplate"),this.itemViewContainer="#tblSearch tbody",this.events={"click .jsSearch":"Search","click .jsCancel":"Cancel","click .jsPrintDocument":"PrintDoc"},this.templateHelpers={getTotalAmount:function(){return"1111"}},e.call(this,t)}return __extends(t,e),t.prototype.PrintDoc=function(){this.trigger("Event:PrintReport")},t.prototype.Search=function(e){e.preventDefault()},t}(n.Views.CompositeView);t.SearchCollectionView=u;var a=function(e){function t(t){this.template=i.getOuterHTML("#rowTemplate"),this.tagName="tr",e.call(this,t)}return __extends(t,e),t.prototype.ShowDetail=function(){},t}(n.Views.ItemView);t.SearchItemView=a});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Dtos/HomeDto",["require","exports","backbone"],function(e,t){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{id:"",bookingId:"",centreId:"",centreDesc:"",bookingAmount:"",bookingMilage:"",receivable:"",maintenance:"",profit:"",fromDate:"",toDate:"",isActive:"",createdBy:"",createdDate:"",modifiedBy:"",modifiedDate:""}},t}(Backbone.Model);e.HomeDto=t;var n=function(e){function n(n){this.model=t,e.call(this,n)}return __extends(n,e),n}(Backbone.Collection);e.HomeCollection=n})(t.Models||(t.Models={}));var n=t.Models});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/DAL/Home",["require","exports","CCTracking.WebClient/DAL/AjaxRequest","../Dtos/HomeDto"],function(e,t,n,r){function s(){var e=new i;return e.doAjaxRequest(null,"GET","Home")}function o(e){var t=new i;return t.doAjaxRequest(e,"POST","Home")}function u(){var e=new i;return e.doAjaxRequest(null,"GET","Home?a=a")}function a(e){var t=new i;return t.doAjaxRequest(null,"GET","Home?id="+e)}function f(e){var t=new i;return t.doAjaxRequest(e,"POST","Home")}var i=function(e){function t(){e.call(this,this)}return __extends(t,e),t.prototype.getResponse=function(){return new r.Models.HomeDto},t}(n.BaseDto);t.HomeDal=i,t.Load=s,t.Save=o,t.GetAll=u,t.GetById=a,t.GetByCriteria=f});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Dtos/BookingSummaryDto",["require","exports","jquery","backbone"],function(e,t){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{alkhidmatCentre:"",alkhidmatCentreId:"",bookingAmount:"",bookingMilage:"",bookings:"",receivables:"",busNo:"",busId:"",visitTypeId:"",visitType:"",visitDate:"",outTime:"",inTime:"",timeTaken:"",driver:"",averageMilage:"",currentReading:"",previusReading:"",fuelQuantity:"",fuelRate:"",pumpLocation:"",fuelingReceipt:"",createdBy:"",createdDate:"",errorMessage:"",id:"",isActive:"",modifiedBy:"",modifiedDate:"",paidAmount:"",paidBooking:"",unpaidAmount:"",unpaidBooking:""}},t}(Backbone.Model);e.BookingSummaryDto=t;var n=function(e){function n(n){this.model=t,e.call(this,n)}return __extends(n,e),n}(Backbone.Collection);e.BookingSummaryCollection=n})(t.Models||(t.Models={}));var n=t.Models});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/DAL/AdminSearch",["require","exports","CCTracking.WebClient/DAL/AjaxRequest","CCTracking.WebClient/Dtos/BookingSummaryDto","jquery"],function(e,t,n,r){function o(){var e=new s;return e.doAjaxRequest(null,"GET","BookingSummary")}function u(e){var t=new s;return t.doAjaxRequest(e,"POST","BookingSummary")}function a(){var e=new s;return e.doAjaxRequest(null,"GET","BookingSummary?a=a")}function f(e){var t=new s;return t.doAjaxRequest(null,"GET","BookingSummary?id="+e)}function l(e){var t=new s;return t.doAjaxRequest(e,"POST","BookingSummary")}var i=e("jquery"),s=function(e){function t(){e.call(this,this)}return __extends(t,e),t.prototype.getResponse=function(){return new r.Models.BookingSummaryDto},t}(n.BaseDto);t.AdminSearchDal=s,t.Load=o,t.Save=u,t.GetAll=a,t.GetById=f,t.GetByCriteria=l});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Home/HomeCtrl",["require","exports","../App","../Helper","./HomeView","../Dtos/HomeDto","../DAL/Home","../DAL/AdminSearch","marionette","jquery","knockout"],function(e,t,n,r,i,s,o,u){var a=e("underscore"),f=e("knockout"),l=function(e){function t(){e.call(this),this.app=n.Application.getInstance(),this.homeItemView=new i.HomeItemView}return __extends(t,e),t.prototype.Show=function(){var e=this;this.app.MainRegion.show(this.homeItemView);var t=new s.Models.HomeDto,n=new Date,i=new Date(n.setDate(n.getDate()-r.GetNoOfDaysConfiguration()));t.set("fromDate",r.FormatDateString(i)),t.set("toDate",r.FormatDateString(new Date));var u=o.GetByCriteria(t);u.done(function(t){e.ShowChart(t)}),this.ShowCentreSummaryReport()},t.prototype.ShowCentreSummaryReport=function(){var e=new Backbone.Model,t=new Date,n=new Date(t.setDate(t.getDate()-r.GetNoOfDaysConfiguration()));e.set("fromBookingDate",r.FormatDateString(n)),e.set("toBookingDate",r.FormatDateString(new Date)),this.GetByCriteria(e)},t.prototype.GetByCriteria=function(e){var t=this;e.get("fromBookingDate").trim()!=""&&e.set("fromBookingDate",r.FormatDateString(e.get("fromBookingDate"))),e.get("toBookingDate").trim()!=""&&e.set("toBookingDate",r.FormatDateString(e.get("toBookingDate")));var n=u.GetByCriteria(e);n.done(function(e){return t.GetByCriteriaCompleted(e)})},t.prototype.GetByCriteriaCompleted=function(e){var t=this,n=e.bookingSummaryList,s=[],o=0,u=0,a=0,f=0,l=0;for(var c=0;c<n.length;c++)s[c]={alkhidmatCentre:n[c].alkhidmatCentre,alkhidmatCentreId:n[c].alkhidmatCentreId,bookingAmount:r.FormatMoney(n[c].bookingAmount),maintenance:r.FormatMoney(n[c].maintenance),bookingMilage:r.FormatMoney(n[c].bookingMilage),bookings:n[c].bookings,receivables:r.FormatMoney(n[c].receivables)},o+=parseFloat(n[c].bookingAmount),l+=parseFloat(n[c].maintenance),u+=parseFloat(n[c].bookingMilage),a+=parseInt(n[c].bookings),f+=parseFloat(n[c].receivables);var h=new Backbone.Model({totalBookingAmount:r.FormatMoney(o),totalBookingMilage:r.FormatMoney(u),totalMaintenance:r.FormatMoney(l),totalBookings:a,totalReceivables:r.FormatMoney(f)});this.collectionView=new i.SearchCollectionView({collection:new Backbone.Collection(s),model:h}),this.collectionView.on("Event:PrintReport",function(e){r.PrintReport(new Backbone.Collection(s),t.GetHeaderList(),"Centre Specific Summary Report","Dashboard")}),this.app.SubRegion.reset(),this.app.SubRegion.show(this.collectionView)},t.prototype.GetHeaderList=function(){var e=new Backbone.Collection([{columnHeader:"Centre Name"},{columnHeader:"Booking Amount"},{columnHeader:"Maintenance"},{columnHeader:"Booking Milage"},{columnHeader:"Bookings"},{columnHeader:"Receivables"}]);return e},t.prototype.ShowChart=function(e){var t=[],n=[],r=[],i=[],s=[];a.map(e.homeList,function(e){return t.push(e.centreDesc),n.push(e.bookingAmount),r.push(e.maintenance),i.push(e.receivable),s.push(e.profit),e}),this.homeItemView.$el.find("#container").highcharts({chart:{type:"column",backgroundColor:"transparent",options3d:{enabled:!0,alpha:15,beta:15,viewDistance:25,depth:40},marginTop:80,marginRight:40},title:{text:"Booking Summary Report - Centre Wise",style:{color:"grey"}},xAxis:{categories:t},legend:{itemStyle:{color:"grey"}},yAxis:{allowDecimals:!1,min:0,title:{text:"Amount in Rs"}},tooltip:{headerFormat:"<b>{point.key}</b><br>",pointFormat:'<span style="color:{series.color}">●</span> {series.name}: {point.y}'},plotOptions:{column:{stacking:"normal",depth:40}},series:[{name:"Booking",data:n,stack:"Booking"},{name:"Maintenance",data:r,stack:"Maintenance"},{name:"Receivable",data:i,stack:"Receivable"},{name:"Profit",data:s,stack:"Profit"}]});var o=this.homeItemView.$el.find("text")[this.homeItemView.$el.find("text").length-1];o!=undefined&&(o.innerHTML="")},t}(r.Controller);t.HomeCtrl=l}),define("text!CCTracking.WebClient/Booking/BookingTmpl.html",[],function(){return'<div id="BookingMainPane">\r\n    <div class="panel panel-default">\r\n        <div class="panel-heading header-bold">\r\n            <span class="fa fa-book">&nbsp;</span> BOOKING REQUEST FORM\r\n            <div class="pull-right">\r\n                Booking ID - <span data-bind="text: model.id"></span>\r\n            </div>\r\n        </div>\r\n            <div class="panel-body">\r\n                <form id="form1">\r\n                    <table class="table table-removeTopBorder table-condensed table-hover form-group">\r\n                        <tr>\r\n                            <td colspan="2" class="header-bold">Contact Details</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Name *</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input type="text" id="txtName" maxlength="50" class="form-control input-sm" data-bind="value: model.contactName" placeholder="Contact Name"\r\n                                    required="required" data-role="validate" title="Contact Name" maxlength="200" data-content="Contact name is required" />\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Mobile *</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input type="text" id="txtMobile" maxlength="15" class="form-control input-sm" data-bind="value: model.contactMobile" placeholder="Contact Mobile"\r\n                                    required="required" data-role="validate" title="Contact Mobile" maxlength="200" data-content="Contact mobile is required" />\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Nic</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input type="text" id="txtNic" maxlength="15" class="form-control input-sm" placeholder="CNIC" data-bind="value: model.contactNic" />\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td colspan="2" class="header-bold">Deceased Info</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Name</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input type="text" id="txtDeseasedName" maxlength="50" class="form-control input-sm" placeholder="Deceased Name" data-bind="value: model.deseasedName" />\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Age</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input type="text" id="txtAge" maxlength="3" class="form-control input-sm" placeholder="Deceased Age" data-bind="value: model.deseasedAge" />\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Gender</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input type="radio" name="rbGender" value="1" data-bind="checked: model.deseasedGender" />Male\r\n                        <input type="radio" name="rbGender" value="2" data-bind="checked: model.deseasedGender" />Female\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Cause/Place of Death</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <select id="ddlCauseOfDeath" class="form-control input-sm"\r\n                                    data-bind="options: model.causeOfDeathList, optionsText: \'description\', value: model.causeOfDeathSelected">\r\n                                </select>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Address</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <textarea id="txtAddress" maxlength="500" class="form-control input-sm" data-bind="value: model.address"></textarea>\r\n                            </td>\r\n                        </tr>\r\n                        <!--<tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Landmark</td>\r\n                        <td class="col-sm-8 col-md-8">\r\n                            <select id="ddlArea" class="form-control input-sm"\r\n                                data-bind="options: model.landmarkList, optionsText:\'description\', value:model.landmarkIdSelected">\r\n                            </select>\r\n\r\n                        </td>\r\n                    </tr>-->\r\n                        <tr>\r\n                            <td colspan="2" class="header-bold">Booking Details</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Alkhidmat/Co-Partners</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <select id="ddlCentre" class="form-control input-sm"\r\n                                    data-bind="options: model.alkhidmatCentreList, optionsText: \'description\', value: model.alkhidmatCentreSelected">\r\n                                </select></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Bus Point</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <!-- <select id="ddlBusPoint11" class="form-control input-sm" \r\n                                             data-bind="options: model.busPointList, optionsText: \'description\', value: model.busPointSelected">\r\n                                     </select>-->\r\n                                <span id="txtBusPoint"></span>\r\n                                <select id="ddlBusPoint" class="form-control input-sm demo-default"></select>\r\n                                \r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Union Council</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <select id="ddlUC" class="form-control input-sm"\r\n                                    data-bind="options: model.unionCouncilList, optionsText: \'description\', value: model.unionCouncilIdSelected">\r\n                                </select>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Town</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <select id="ddlTown" class="form-control input-sm"\r\n                                    data-bind="options: model.townList, optionsText: \'description\', value: model.townIdSelected">\r\n                                </select>\r\n\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Pick-up Date *</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input type="text" id="PickupDate" placeholder="mm/dd/yyyy" class="form-control input-sm" data-bind="datepicker: {}, value: model.pickupDate"\r\n                                    required="required" data-role="validate" title="Pick-up Date" data-content="Pickup Date is required" />\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Pick-up Time *</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <!--<input type="text" title="Pick-up Time"  pattern="[0-2][0-9]:[0-5][0-9] ((am)|(pm))"  id="PickupTime" class="form-control input-sm"  />-->\r\n                                <select id="ddlPickupTime" class="form-control input-sm"\r\n                                    data-bind="options: model.pickupTimeSlotList, optionsText: \'description\', value: model.pickupTimeSlotSelected">\r\n                                </select>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Return Time *</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <select id="ddlReturnTime" class="form-control input-sm"\r\n                                    data-bind="options: model.returnTimeSlotList, optionsText: \'description\', value: model.returnTimeSlotSelected">\r\n                                </select>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Graveyard *</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <select id="ddlGraveyard" class="form-control input-sm"\r\n                                    data-bind="options: model.graveyardList, optionsText: \'description\', value: model.graveyardIdSelected">\r\n                                </select>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Funeral Prayer *</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <select id="Select2" class="form-control input-sm"\r\n                                    data-bind="options: model.prayersList, optionsText: \'description\', value: model.prayersSelected">\r\n                                </select>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Funeral Location</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input type="text" id="Text1" maxlength="500" class="form-control input-sm" placeholder="Funeral Location" data-bind="value: model.namazEJanazaLocation" />\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Masjid Name</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input type="text" id="Text2" maxlength="50" class="form-control input-sm" placeholder="Masjid Name" data-bind="value: model.masjidName" />\r\n                            </td>\r\n                        </tr>\r\n                        <!-- \r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Bus Detail</td>\r\n                        <td class="col-sm-8 col-md-8">\r\n                            <select id="ddlBusDetail" multiple class="form-control input-sm"\r\n                                data-bind="options: model.busDetailsList, optionsText:\'description\', value:model.busDetailIdSelected">                                \r\n                            </select><br />\r\n                            <a href="#" data-toggle="modal" data-target="#basicModal" class="btn-danger">Expected return time: 2 hours from now</a>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Initial Meter Reading</td>\r\n                        <td class="col-sm-8 col-md-8">\r\n                            <input type="text" id="Text1" class="form-control input-sm" placeholder="set place holder" data-bind="value: model.initialReading" />\r\n                            <br />\r\n                            (For multiple bookings please seperate entries with comma ",") \r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Final Meter Reading</td>\r\n                        <td class="col-sm-8 col-md-8">\r\n                            <input type="text" id="Text2" class="form-control input-sm" placeholder="set place holder" data-bind="value: model.finalReading" />\r\n                            <br />\r\n                            (For multiple bookings please seperate entries with comma ",") \r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Approx. Distance</td>\r\n                        <td class="col-sm-8 col-md-8">\r\n                            <input type="text" id="Text3" class="form-control input-sm" disabled="disabled" placeholder="22 km" />\r\n                        </td>\r\n                    </tr>\r\n                    -->\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Is Referral Booking</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input type="radio" name="rbIsReferralBoking" value="1" data-bind="checked: model.isReferralBooking" />Yes\r\n                                    &nbsp;\r\n                                    <input type="radio" name="rbIsReferralBoking" value="0" data-bind="checked: model.isReferralBooking" />No \r\n                           <!-- <input type="checkbox" id="chkIsReferralBooking" class="form-control input-sm"  data-bind="checked: model.isReferralBoking" />-->\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Referral Name</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input type="text" id="txtReferralName" maxlength="100" class="form-control input-sm" placeholder="Referral Name" data-bind="value: model.referralName" />\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Referral Details</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <textarea id="txtReferralDetails" maxlength="500" class="form-control input-sm" placeholder="Referral Details" data-bind="value: model.referralDetail"></textarea>\r\n                            </td>\r\n                        </tr>\r\n\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Other Details</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <textarea id="txtOtherDetails" maxlength="500" class="form-control input-sm" placeholder="Other Details" data-bind="value: model.otherDetail"></textarea>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4"></td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <button type="submit" class="btn btn-default" data-role="trigger-validation">Save</button>\r\n                                &nbsp;\r\n                        <button type="button" class="jsCancel btn btn-default">Cancel</button>\r\n                            </td>\r\n                        </tr>\r\n                    </table>\r\n                </form>\r\n            </div>        \r\n    </div>\r\n    <script type="text/javascript">\r\n        $(function () {\r\n            //var trackingApp = new TrackingApp();\r\n            //trackingApp.start();\r\n            var d = new Date();\r\n            var dateString = d.toISOString().substr(0, 10);\r\n            //alert(dateString);\r\n            $("#PickupDate").val(dateString);\r\n\r\n            $("#btnSave").bind("click", function () {\r\n\r\n            })\r\n\r\n            $("#PickupTime").bind("blur", function () {\r\n                var d1 = d = new Date("01/01/1990");\r\n                var hrs = $("#PickupTime").val();\r\n                d.setUTCHours(hrs.split(\':\')[0], hrs.split(\':\')[1]);\r\n                d1.setUTCHours(d.getUTCHours() + 3, d.getUTCMinutes());\r\n                var rhrs = d.getUTCHours() + 3 + ":" + d.getUTCMinutes();\r\n                //alert(d1.getUTCHours() + ":" + d1.getUTCMinutes());\r\n                $("#ReturnTime").val(d1.getUTCHours() + ":" + d1.getUTCMinutes());\r\n\r\n            });\r\n        });\r\n    </script>\r\n\r\n</div>\r\n'}),define("text!CCTracking.WebClient/Booking/BookingGrid.html",[],function(){return'<div>\r\n    <div id="gridTemplate">\r\n        <div class="panel panel-default">\r\n            <div class="panel-heading header-bold"><i class="fa fa-book">&nbsp;</i> View - Booking Details\r\n                <span class="pull-right"><a href="#addBooking">Add New</a> </span>\r\n            </div>\r\n            <div class="panel-body">\r\n                <table id="tblBooking" class="table table-removeTopBorder table-condensed table-bordered table-hover table-striped">\r\n                    <thead>\r\n                        <tr class="active">\r\n                            <th class="input-sm">Booking Id</th>\r\n                            <th class="input-sm">Contat Name</th>\r\n                            <th class="input-sm">Contact Mobile</th>\r\n                            <th class="input-sm">Receipt No</th>\r\n                            <th class="input-sm">Deceased Name</th>\r\n                            <th class="input-sm">Pick-up Date</th>\r\n                            <th class="input-sm">Action</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody></tbody>\r\n                    <tfoot>\r\n                        <tr class="active"><td colspan="7">&nbsp;</td></tr>\r\n                    </tfoot>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n\r\n'}),define("text!CCTracking.WebClient/Booking/BokingGridRow.html",[],function(){return'<div>\r\n    <script type="text/html" id="rowTemplate">\r\n        <td class="input-sm"><%=id%></td>        \r\n        <td class="jsShowDetail input-sm"><%=contactName %></td>\r\n        <td class="input-sm"><%=contactMobile%></td>\r\n        <td class="input-sm"><%=receiptNo%></td>\r\n        <td class="input-sm"><%=deseasedName%></td>\r\n        <td class="input-sm"><%=pickupDate%></td>        \r\n        <td class="input-sm">            \r\n            <span class="jsEditBooking edit-action fa fa-edit" title="Edit"></span>&nbsp;            \r\n            <span class="jsEditPayment edit-action fa fa-briefcase" title="Payment"></span>&nbsp;            \r\n            <span class="jsEditRefund edit-action fa fa-remove" title="Refund Booking"></span>&nbsp;            \r\n            <span class="jsEditExtraCharge edit-action fa fa-plus-circle" title="Extra Charges"></span>&nbsp;\r\n            <a href="javascript:void(0);"><span class="jsExportToPdf fa fa-print" title="Print Receipt"></span></a>\r\n        </td>        \r\n    </script>\r\n</div>'});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Booking/BookingView",["require","exports","../Helper","marionette","jquery","jqueryUI","knockout","text!./BookingTmpl.html","text!./BookingGrid.html","text!./BokingGridRow.html"],function(e,t,n){function h(e){var t=JSON.parse(localStorage.getItem("lookupResponse")),n=r.filter(t.unionCouncil,function(t){return t.id==e});return n}function p(e){var t=JSON.parse(localStorage.getItem("lookupResponse")),n=r.filter(t.town,function(t){return t.id==e});return n}var r=e("underscore"),i=e("text!./BookingTmpl.html"),s=e("text!./BookingGrid.html"),o=e("text!./BokingGridRow.html"),u,a=function(e){function t(t,n){var r=this;e.call(this,t,n),this.model.busPointSelected.subscribe(function(){var e=h(r.model.busPointSelected().parentId);r.model.unionCouncilList(e)}),this.model.unionCouncilIdSelected.subscribe(function(){var e=p(r.model.unionCouncilIdSelected().parentId);r.model.townList(e)})}return __extends(t,e),t}(n.ViewModel);t.BookingViewModel=a;var f=function(e){function t(t){this.template=i,this.events={submit:"Save","click .jsCancel":"Cancel"},e.call(this,t)}return __extends(t,e),t.prototype.Cancel=function(){window.location.href="#viewBooking"},t.prototype.onDomRefresh=function(){var e=JSON.parse(localStorage.getItem("lookupResponse")),t=r.map(e.landmark,function(e){return{value:e.id,text:e.description,parentId:e.parentId}}),n=this.$el.find("#ddlBusPoint").selectize({options:t,create:!1,sortField:{field:"text",direction:"asc"},dropdownParent:"body"}),i=this;this.$el.find("#ddlBusPoint").on("change",function(t){var s=r.filter(e.landmark,function(e){return e.id==n[0].value});if(s[0]!=undefined){i.viewModel.model.busPointSelected(s[0]);var o=h(s[0].parentId);i.viewModel.model.unionCouncilList(o)}})},t.prototype.Save=function(e){e.preventDefault(),this.trigger("SaveBooking")},t.prototype.ExportToPdf=function(e){n.PrintReceipt(e)},t}(n.Views.MvvmView);t.BookingView=f;var l=function(e){function t(t){this.itemView=c,this.template=s.getOuterHTML("#gridTemplate"),this.itemViewContainer="tbody",e.call(this,t)}return __extends(t,e),t.prototype.onShow=function(){this.dataTable=this.$el.find("#tblBooking").dataTable({autoWidth:!1,info:!0,processing:!0,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],language:{paginate:{next:"Next",previous:"Prev"},emptyTable:"No record found!",infoEmpty:"No record found!",zeroRecords:"No record found!"},pageLength:n.GetPageSize()})},t}(n.Views.CompositeView);t.BookingCollectionView=l;var c=function(e){function t(t){var n=this;t.template=o.getOuterHTML("#rowTemplate"),t.tagName="tr",t.className="jsRowClick",t.events={"mouseover .jsShowDetail":"ShowDetail","click .jsExportToPdf":function(){n.trigger("ExportToPdf",n.model.get("id"))},"click .jsShowDetail":"ShowDetail","click .jsEditBooking":"EditBooking","click .jsEditPayment":"EditPayment","click .jsEditRefund":"EditRefund","click .jsEditExtraCharge":"EditExtraCharge"},e.call(this,t)}return __extends(t,e),t.prototype.EditBooking=function(e){e.preventDefault(),window.location.href="#editBooking",this.trigger("Event:EditBooking",this.model.get("id"))},t.prototype.EditPayment=function(e){e.preventDefault(),window.location.href="#editPayment",this.trigger("Event:EditPayment",this.model.get("id"))},t.prototype.EditRefund=function(e){e.preventDefault(),window.location.href="#editRefund",this.trigger("Event:EditRefund",this.model.get("id"))},t.prototype.EditExtraCharge=function(e){e.preventDefault(),window.location.href="#editExtraCharge",this.trigger("Event:EditExtraCharge",this.model.get("id"))},t.prototype.ShowDetail=function(){},t}(n.Views.ItemView);t.BookingItemView=c});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Dtos/BookingDto",["require","exports","jquery","backbone"],function(e,t){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{id:"",contactName:"",contactMobile:"",contactNic:"",deseasedName:"",deseasedAge:"",deseasedGender:"",causeOfDeath:"",causeOfDeathSelected:"",address:"",alkhidmatCentreId:"",busPoint:"",unionCouncil:"",town:"",pickupDate:"",pickupTime:"",returnTime:"",graveyard:"",namazEJanazaHeldIn:"",namazEJanazaLocation:"",masjidName:"",otherDetail:"",isReferralBooking:"",referralName:"",referralDetail:""}},t}(Backbone.Model);e.BookingRequest=t;var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{id:"",contactName:"",contactMobile:"",contactNic:"",deseasedName:"",deseasedAge:"",deseasedGender:"",causeOfDeath:"",address:"",busPoint:"",landmarkId:"",receiptNo:"",unionCouncilId:"",townId:"",pickupDate:"",pickupTime:"",returnTime:"",graveyard:"",namazEJanazaHeldIn:"",namazEJanazaLocation:"",masjidName:"",otherDetail:"",isReferralBooking:"",referralName:"",referralDetail:""}},t}(Backbone.Model);e.BookingResponse=n;var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{id:"",bookingId:"",propertyName:"",oldValue:"",newValue:"",modifiedDate:"",createdDate:"",actualModifiedDate:"",userName:""}},t}(Backbone.Model);e.AuditBooking=r;var i=function(e){function t(t){this.model=n,e.call(this,t)}return __extends(t,e),t}(Backbone.Collection);e.BookingResponseCollection=i;var s=function(e){function t(t){this.model=r,e.call(this,t)}return __extends(t,e),t}(Backbone.Collection);e.AuditBookingResponseCollection=s})(t.Models||(t.Models={}));var n=t.Models});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/DAL/Booking",["require","exports","CCTracking.WebClient/DAL/AjaxRequest","CCTracking.WebClient/Dtos/BookingDto","jquery"],function(e,t,n,r){function o(){var e=new s;return e.doAjaxRequest(null,"GET","Booking")}function u(e){var t=new s;return t.doAjaxRequest(e,"POST","Booking")}function a(e){var t=new s;return t.doAjaxRequest(null,"GET","Booking?a="+e)}function f(e){var t=new s;return t.doAjaxRequest(null,"GET","Booking?id="+e)}function l(e){var t=new s;return t.doAjaxRequest(e,"POST","AuditBooking")}var i=e("jquery"),s=function(e){function t(){e.call(this,this)}return __extends(t,e),t.prototype.getResponse=function(){return new r.Models.BookingResponse},t}(n.BaseDto);t.BookingDal=s,t.Load=o,t.Save=u,t.GetAll=a,t.GetById=f,t.GetAllAuditBooking=l});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Booking/BookingCtrl",["require","exports","../App","../Helper","./BookingView","CCTracking.WebClient/Dtos/BookingDto","../DAL/Booking","marionette","jquery","knockout","selectize","text!./BookingTmpl.html"],function(e,t,n,r,i,s,o){var u=e("underscore"),a=e("knockout"),f=e("selectize"),l,c=function(t){function a(){l=n.Application.getInstance(),t.call(this)}return __extends(a,t),a.prototype.Show=function(){this.LoadCompleted(JSON.parse(localStorage.getItem("lookupResponse")))},a.prototype.EditBooking=function(e){var t=this,n=o.GetById(e);n.done(function(e){return t.GetByIdCompleted(e)})},a.prototype.GetByIdCompleted=function(e){var t=this,n=JSON.parse(localStorage.getItem("lookupResponse")),s=new Backbone.Model(e.bookingModel);s.set("causeOfDeathList",n.causeOfDeath),s.set("landmarkList",n.landmark),s.set("busPointList",n.landmark),s.set("unionCouncilList",n.unionCouncil),s.set("townList",n.town),s.set("graveyardList",n.graveyard),s.set("busDetailsList",n.bus),s.set("pickupTimeSlotList",n.timeSlot),s.set("returnTimeSlotList",n.timeSlot),s.set("prayersList",n.prayers),s.set("prayersList",n.prayers),s.set("alkhidmatCentreList",n.alkhidmatCentre);var o=u.filter(n.causeOfDeath,function(e){return e.id==s.get("causeOfDeath")}),a=u.filter(n.landmark,function(e){return e.id==s.get("landmarkId")}),f=u.filter(n.landmark,function(e){return e.id==s.get("busPoint")}),c=u.filter(n.unionCouncil,function(e){return e.id==s.get("unionCouncilId")}),h=u.filter(n.town,function(e){return e.id==s.get("townId")}),p=u.filter(n.graveyard,function(e){return e.id==s.get("graveyardId")}),d=u.filter(n.bus,function(e){return e.id==s.get("busDetailId")}),v=u.filter(n.timeSlot,function(e){return e.id==s.get("pickupTime")}),m=u.filter(n.timeSlot,function(e){return e.id==s.get("returnTime")}),g=u.filter(n.prayers,function(e){return e.id==s.get("namazEJanazaHeldIn")}),y=u.filter(n.alkhidmatCentre,function(e){return e.id==s.get("alkhidmatCentreId")});s.set("causeOfDeathSelected",o[0]),s.set("busPointSelected",f[0]),s.set("unionCouncilIdSelected",c[0]),s.set("townIdSelected",h[0]),s.set("graveyardIdSelected",p[0]),s.set("busDetailIdSelected",d[0]),s.set("deseasedGender",s.get("deseasedGender").toString()),s.set("alkhidmatCentreSelected",y[0]),s.set("pickupTimeSlotSelected",v[0]),s.set("returnTimeSlotSelected",m[0]),s.set("prayersSelected",g[0]),s.set("isReferralBooking",s.get("isReferralBooking")?"1":"0"),s.set("pickupDate",r.FormatDateString(s.get("pickupDate"))),this.bookingViewModel=new i.BookingViewModel(s,this),this.bookingView=new i.BookingView({viewModel:this.bookingViewModel}),this.bookingView.on("SaveBooking",function(){return t.Save(t.bookingViewModel.bbModel)}),this.layout=l.AppLayout,l.MainRegion.show(this.bookingView),f[0]!=undefined&&this.bookingView.$el.find("#txtBusPoint").append(f[0].description)},a.prototype.LoadCompleted=function(e){var t=this,n=new s.Models.BookingResponse;n.set("contactName",""),n.set("contactMobile",""),n.set("contactNic",""),n.set("deseasedName",""),n.set("deseasedAge",""),n.set("deseasedGender",""),n.set("causeOfDeathList",e.causeOfDeath),n.set("causeOfDeathSelected",""),n.set("address",""),n.set("landmarkIdSelected",""),n.set("landmarkList",e.landmark),n.set("busPointList",e.landmark),n.set("busPointSelected",""),n.set("alkhidmatCentreList",e.alkhidmatCentre),n.set("alkhidmatCentreSelected",""),n.set("unionCouncilList",e.unionCouncil),n.set("unionCouncilIdSelected",""),n.set("townList",e.town),n.set("townIdSelected",""),n.set("pickupDate",""),n.set("pickupTime",""),n.set("returnTime",""),n.set("graveyardList",e.graveyard),n.set("graveyardIdSelected",""),n.set("pickupTimeSlotList",e.timeSlot),n.set("pickupTimeSlotSelected",""),n.set("returnTimeSlotList",e.timeSlot),n.set("returnTimeSlotSelected",""),n.set("prayersList",e.prayers),n.set("prayersSelected",""),n.set("namazEJanazaHeldIn",""),n.set("namazEJanazaLocation",""),n.set("masjidName",""),n.set("otherDetail",""),n.set("isReferralBooking",""),n.set("referralName",""),n.set("referralDetail",""),this.bookingViewModel=new i.BookingViewModel(n,this),this.bookingView=new i.BookingView({viewModel:this.bookingViewModel}),this.bookingView.on("SaveBooking",function(){return t.Save(t.bookingViewModel.bbModel)}),this.layout=l.AppLayout,l.MainRegion.show(this.bookingView)},a.prototype.GetAll=function(e){var t=this;typeof e=="undefined"&&(e=1),e==undefined&&(e=1);var n=o.GetAll(e);n.done(function(e){return t.GetAllCompleted(e)})},a.prototype.GetAllCompleted=function(t){var o=this;l=n.Application.getInstance();var a=u.map(t.bookingList,function(e){return e.pickupDate!="0001-01-01T00:00:00"?e.pickupDate=r.FormatDateString(e.pickupDate):e.pickupDate="",e}),f=new s.Models.BookingResponseCollection(a),c=new i.BookingCollectionView({collection:f});c.listenTo(c,"itemview:ExportToPdf",function(e,t){r.PrintReceipt(t)}),c.listenTo(c,"itemview:Event:EditBooking",function(e,t){o.EditBooking(t)}),c.listenTo(c,"itemview:Event:EditPayment",function(t,n){e(["./../Payment/PaymentCtrl"],function(e){(new e.PaymentCtrl).EditPayment(n)})}),c.listenTo(c,"itemview:Event:EditRefund",function(t,n){e(["./../RefundBooking/RefundBookingCtrl"],function(e){(new e.RefundBookingCtrl).EditRefund(n)})}),c.listenTo(c,"itemview:Event:EditExtraCharge",function(t,n){e(["./../ExtraCharge/ExtraChargeCtrl"],function(e){(new e.ExtraChargeCtrl).EditExtraCharge(n)})}),l.MainRegion.show(c)},a.prototype.Save=function(e){var t=this,n=l.request("AppGlobalSetting");e.set("modifiedBy",n.get("Id")),e.set("causeOfDeath",e.get("causeOfDeathSelected").id),e.set("busPoint",e.get("busPointSelected").id),e.set("unionCouncilId",e.get("unionCouncilIdSelected").id),e.set("townId",e.get("townIdSelected").id),e.set("graveyardId",e.get("graveyardIdSelected").id),e.set("pickupTime",e.get("pickupTimeSlotSelected").id),e.set("returnTime",e.get("returnTimeSlotSelected").id),e.set("namazEJanazaHeldIn",e.get("prayersSelected").id),e.set("alkhidmatCentreId",e.get("alkhidmatCentreSelected").id);if(e.get("isReferralBooking")=="1"&&e.get("referralName").trim().length==0){r.ShowModalPopup("danger","Booking","Please enter referral name.");return}e.set("isReferralBooking",e.get("isReferralBooking")=="1"?!0:!1);var i=o.Save(this.GetMinimalRequest(e));i.done(function(e){t.SaveCompleted(e)})},a.prototype.GetMinimalRequest=function(e){var t=new s.Models.BookingRequest;return t.set("alkhidmatCentreId",e.get("alkhidmatCentreId")),t.set("address",e.get("address")),t.set("busPoint",e.get("busPoint")),t.set("causeOfDeath",e.get("causeOfDeath")),t.set("contactMobile",e.get("contactMobile")),t.set("contactName",e.get("contactName")),t.set("contactNic",e.get("contactNic")),t.set("createdBy",e.get("createdBy")),t.set("createdDate",e.get("createdDate")),t.set("deseasedAge",e.get("deseasedAge")),t.set("deseasedGender",e.get("deseasedGender")),t.set("deseasedName",e.get("deseasedName")),t.set("graveyardId",e.get("graveyardId")),t.set("id",e.get("id")),t.set("isActive",e.get("isActive")),t.set("isReferralBooking",e.get("isReferralBooking")),t.set("landmarkId",e.get("landmarkId")),t.set("masjidName",e.get("masjidName")),t.set("modifiedBy",e.get("modifiedBy")),t.set("modifiedDate",e.get("modifiedDate")),t.set("namazEJanazaHeldIn",e.get("namazEJanazaHeldIn")),t.set("namazEJanazaLocation",e.get("namazEJanazaLocation")),t.set("operationType",e.get("operationType")),t.set("otherDetail",e.get("otherDetail")),t.set("pickupDate",e.get("pickupDate")),t.set("pickupTime",e.get("pickupTime")),t.set("referralDetail",e.get("referralDetail")),t.set("referralName",e.get("referralName")),t.set("returnTime",e.get("returnTime")),t.set("townId",e.get("townId")),t.set("unionCouncilId",e.get("unionCouncilId")),t},a.prototype.SaveCompleted=function(t){var n=new Backbone.Model(t);n.get("errorMessage")!=undefined&&n.get("errorMessage").trim()!=""?(console.log(n.get("errorMessage")),r.ShowModalPopup("danger","Booking","Due to some technical reason booking have not been saved successfully!<br> Pelase try later")):(r.ShowModalPopup("success","Booking","Record has been saved successfully with Booking ID : "+t.id),e(["./../Payment/PaymentCtrl"],function(e){(new e.PaymentCtrl).EditPayment(n.get("id"))}))},a}(r.Controller);t.BookingCtrl=c}),define("text!CCTracking.WebClient/Common/Templates/Header.html",[],function(){return'<div>\r\n    <script type="text/html" id="SiteHeader">\r\n\r\n        <!--@*<nav class="navbar navbar-default" role="navigation">*@-->\r\n        <div>\r\n            <ul class="nav navbar-nav navbar-left header-menu-font-size">\r\n                <% if(isAdminRole()) {%> \r\n                <li class="header-menu-font-size"><a href="#viewHome"><i class="fa fa-home">&nbsp;</i>Home</a></li>               \r\n                <%} else {%>\r\n                <li class="header-menu-font-size"><a href="#viewBooking"><i class="fa fa-home">&nbsp;</i>Home</a></li>               \r\n                <%}%>\r\n                <li class="dropdown header-menu-font-size">\r\n                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-gears">&nbsp;</i>Main<span class="caret"></span></a>\r\n                    <ul class="dropdown-menu header-menu-font-size" role="menu">\r\n                        <!--<li><a href="#addBooking"><span class="glyphicon glyphicon-time"></span>Add</a></li>-->\r\n                        <!--<li><a href="#viewBooking"><i class="fa fa-book">&nbsp;</i>Booking</a></li>-->\r\n                        <li><a href="javascript:void(0);" id="nav-booking"><i class="fa fa-book">&nbsp;</i>Booking</a></li>\r\n                        <li><a href="#viewBusVisit"><i class="fa fa-bus">&nbsp;</i>Bus Visit</a></li>\r\n                        <li><a href="#searchBooking"><span class="fa fa-search">&nbsp;</span>Search</a></li>\r\n                        <li class="divider"></li>\r\n                        <!--<li class="divider"></li>\r\n                            <li><a href="#cancelBooking"><span class="glyphicon glyphicon-time"></span>Cancel</a></li>-->\r\n                    </ul>\r\n                </li>\r\n                <!-- diaplay only to admin-->\r\n                <% if(isAdminRole()) {%> \r\n                <li class="dropdown header-menu-font-size">\r\n                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-lock">&nbsp;</i>Admin<span class="caret"></span></a>\r\n                    <ul class="dropdown-menu header-menu-font-size" role="menu">\r\n                        <li><a href="#viewAlkhidmatCentre"><i class="fa fa-institution">&nbsp;</i>Alkhidmat Centre</a></li>\r\n                        <li><a href="#viewAdminBus"><i class="fa fa-bus">&nbsp;</i>Bus</a></li>\r\n                        <li><a href="#viewCauseOfDeath"><i class="fa fa-ambulance">&nbsp;</i>Cause of Death</a></li>\r\n                        <li class="divider"></li>\r\n                        <li><a href="#viewDriver"><i class="fa fa-male">&nbsp;</i>Driver</a></li>\r\n                        <li><a href="#viewGraveyard"><i class="fa fa-random">&nbsp;</i>Graveyard</a></li>\r\n                        <li><a href="#viewLandmark"><i class="fa fa-building-o">&nbsp;</i>Landmark</a></li>\r\n                        <li class="divider"></li>\r\n                        <li><a href="#viewPaymentType"><i class="fa fa-cc-mastercard">&nbsp;</i>Payment Type</a></li>\r\n                        <li><a href="#viewRefundType"><i class="fa fa-cc-visa">&nbsp;</i>Refund Type</a></li>\r\n                        <li><a href="#viewTrackingDevice"><i class="fa fa-clock-o">&nbsp;</i>Tracking Device</a></li>                        \r\n                        <li><a href="#viewVisitType"><i class="fa fa-bus">&nbsp;</i>Visit Type</a></li>\r\n                        <li class="divider"></li>\r\n                        <li><a href="#viewUser"><i class="fa fa-user">&nbsp;</i>User</a></li>\r\n                        <li><a href="#viewNearestCentreSetup"><i class="fa fa-institution">&nbsp;</i>Nearest Centre</a></li>\r\n                        <li class="divider"></li>\r\n                        <!--<li><a href="#cancelAdmin"><span class="glyphicon glyphicon-time"></span>Cancel</a></li>-->\r\n                    </ul>\r\n                </li>\r\n                \r\n                <li class="dropdown header-menu-font-size">\r\n                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-line-chart">&nbsp;</i>Reports<span class="caret"></span></a>\r\n                    <ul class="dropdown-menu header-menu-font-size" role="menu">\r\n                        <li><a href="#adminSearchBooking"><i class="fa fa-book">&nbsp;</i>&nbsp;Booking</a></li>\r\n                        <li><a href="#busMilageReport"><i class="fa fa-bus">&nbsp;</i>&nbsp;Milage</a></li>\r\n                        <li><a href="#busFuelingReport"><i class="fa fa-bus">&nbsp;</i>&nbsp;Bus Fueling</a></li>\r\n                        <li><a href="#driverSummary"><i class="fa fa-male">&nbsp;</i>&nbsp;Driver\'s Summary</a></li>\r\n                        <!--<li class="divider"></li>\r\n                        <li><a href="#busVisitSummary"><i class="fa fa-bus">&nbsp;</i>&nbsp;Bus Visit - Bookings</a></li>\r\n                        <li><a href="#busVisitMilageSummary"><i class="fa fa-bus">&nbsp;</i>&nbsp;Bus Visit - Non Bookings</a></li>-->\r\n                    </ul>\r\n                </li>\r\n                <li class="dropdown header-menu-font-size">\r\n                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-twitch">&nbsp;</i>Audit Trial<span class="caret"></span></a>\r\n                    <ul class="dropdown-menu header-menu-font-size" role="menu">\r\n                        <li><a href="#auditBooking"><i class="fa fa-book">&nbsp;</i>&nbsp;Booking</a></li>\r\n                        <li><a href="#auditBusVisit"><i class="fa fa-book">&nbsp;</i>&nbsp;Bus Visit</a></li>\r\n                        <li><a href="#auditPayment"><i class="fa fa-cc-mastercard">&nbsp;</i>&nbsp;Payment</a></li>\r\n                        <li><a href="#auditRefundBooking"><i class="fa fa-cc-visa">&nbsp;</i>&nbsp;Refund</a></li>\r\n                    </ul>\r\n                </li>\r\n                <%}%>\r\n                \r\n            </ul>\r\n           <!-- <form class="navbar-form navbar-left" role="search">\r\n                <div class="form-group">\r\n                    <input type="text" class="form-control" placeholder="Search">\r\n                </div>\r\n                <button type="submit" class="btn btn-primary">Submit</button>\r\n            </form>-->\r\n            <ul class="nav navbar-nav navbar-right">\r\n                <!--<li><a href="#">Link</a></li>-->\r\n                <li class="dropdown header-menu-font-size">\r\n                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-user">&nbsp;</i><%=firstName%>,<%=lastName%><span class="caret"></span></a>\r\n                    <ul class="dropdown-menu header-menu-font-size" role="menu">\r\n                        <!--<li><a href="#"><i class="fa fa-file-text">&nbsp;</i> Profile</a></li>-->\r\n                        <li><a href="#changePassword"><i class="fa fa-edit">&nbsp;</i> Change Password</a></li>\r\n                        <li class="divider"></li>\r\n                        <li><a href="#logout"><i class="fa fa-sign-out">&nbsp;</i>Logout</a></li>\r\n                    </ul>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    </script>\r\n</div>\r\n'});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Common/Views/HeaderView",["require","exports","../../App","marionette","text!CCTracking.WebClient/Common/Templates/Header.html"],function(e,t,n){var r=e("text!CCTracking.WebClient/Common/Templates/Header.html"),i,s=function(e){function t(t){t||(t={}),i=n.Application.getInstance(),t.template=r.getOuterHTML("#SiteHeader"),this.templateHelpers=function(){return{isAdminRole:function(){return i.request("AppGlobalSetting").get("IsAdmin")}}},this.events={"click #nav-booking":function(){i.goViewBooking()}},e.call(this,t)}return __extends(t,e),t}(Marionette.ItemView);t.HeaderItemView=s}),define("text!CCTracking.WebClient/Bus/BusAvailability.html",[],function(){return'<div>\r\n<div id="BusAvailabilityPanel">\r\n    \r\n    <div class="panel panel-default">\r\n        <div class="panel-heading header-bold"><i class="fa fa-search">&nbsp;</i>&nbsp;CHECK BUS AVAILABILITY</div>\r\n        <div class="panel-body">\r\n            <table class="table table-condensed form-group">\r\n                <tr>\r\n                    <td class="col-sm-4 col-md-4 input-sm">Centres/Parnters</td>\r\n                    <td class="col-sm-8 col-md-8">\r\n                            <select id="ddlCentre" class="form-control input-sm"\r\n                                            data-bind="options: model.alkhidmatCentreList, optionsText:\'description\', value:model.alkhidmatCentreSelected">\r\n                                    </select></td>\r\n                </tr>\r\n                <tr>\r\n                    <td class="col-sm-4 col-md-4 input-sm">Buses</td>\r\n                    <td class="col-sm-8 col-md-8">\r\n                         <select id="ddlBusDetails" class="form-control input-sm"\r\n                                        data-bind="options: model.busList, optionsText:\'description\', value:model.busSelected">\r\n                                    </select></td>\r\n                </tr>\r\n                <tr>\r\n                    <td class="col-sm-4 col-md-4 input-sm"></td>\r\n                    <td class="col-sm-8 col-md-8 input-sm">\r\n                        <button id="btnAvailability" class="jsAvailability btn btn-default">Avialability</button>&nbsp;\r\n                        <button id="btnLocation" class="btn btn-default">Location</button>&nbsp;\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n            <div id="BusAvailabilityRegion"></div>\r\n<!--            <div id="AdminLeftRegion"></div>\r\n            <div id="LeftRegion"></div>-->\r\n        </div>\r\n    </div>\r\n    \r\n</div>\r\n</div>'}),define("text!CCTracking.WebClient/Bus/BusAvailabilityGrid.html",[],function(){return'<div>\r\n    <div id="gridTemplate">\r\n        <div class="panel panel-default">\r\n            <div class="panel-heading header-bold">\r\n                <span class="fa fa-binoculars">&nbsp;</span> View - Availability\r\n                <!--<span class="pull-right"><a href="#busVisit">Add New</a></span>-->\r\n            </div>\r\n            <div class="panel-body">\r\n                <table id="tblStation" class="table table-condensed table-bordered table-hover table-striped form-group">\r\n                    <thead>\r\n                        <tr class="active">\r\n                            <th class="input-sm">Centres</th>\r\n                            <th class="input-sm">Bus Availability</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody></tbody>\r\n                    <tfoot>\r\n                        <tr class="active">\r\n                            <td colspan="2">&nbsp;</td>\r\n                        </tr>\r\n                    </tfoot>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n\r\n    <script type="text/html" id="rowTemplate">\r\n        <td class="jsShowDetail input-sm"><a href="#editBusVisit?id=<%=id%>"><%=centreName%></a></td>\r\n        <td class="jsBusList input-sm"><%=showBuses()%></td>        \r\n    </script>\r\n</div>\r\n\r\n\r\n'});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Bus/BusAvailabilityView",["require","exports","../Helper","marionette","jquery","knockout","text!./BusAvailability.html","text!./BusAvailabilityGrid.html"],function(e,t,n){var r=e("underscore"),i=e("text!./BusAvailability.html"),s=e("text!./BusAvailabilityGrid.html"),o,u=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t}(n.ViewModel);t.BusAvailabilityViewModel=u;var a=function(e){function t(t){this.template=i,this.events={submit:"Save","click .jsAvailability":"Availability"},e.call(this,t)}return __extends(t,e),t.prototype.close=function(){this.off("Event:SaveForm"),this.off("Event:BusAvailability"),this.off("Event:BusBookingDetail")},t.prototype.Availability=function(){this.trigger("Event:BusAvailability",this.model.get("alkhidmatCentreSelected").id)},t.prototype.Save=function(e){e.preventDefault(),this.trigger("Event:SaveForm")},t}(n.Views.MvvmView);t.BusAvailabilityView=a;var f=function(e){function t(t){t.itemView=l,t.template=s.getOuterHTML("#gridTemplate"),t.itemViewContainer="tbody",t.events={"click .jsSearchVisit":"SearchVisit"},e.call(this,t)}return __extends(t,e),t.prototype.SearchVisit=function(e){e.preventDefault(),this.trigger("Event:SearchVisit",this.model.get("busSelected").id)},t.prototype.setOptionDisable=function(e,t){alert("dddddd")},t}(n.Views.CompositeView);t.BusAvailabilityCollectionView=f;var l=function(e){function t(t){var n=this;t||(t={}),t.template=s.getOuterHTML("#rowTemplate"),t.tagName="tr",t.className="jsRowClick",t.events={"click .jsShowBusDetail":"ShowBusDetail"},e.call(this,t),this.templateHelpers={showBuses:function(){if(n.model!=undefined){var e=n.model.get("busList")===null?"":n.model.get("busList"),t="";if(e!=""){var r=e.split("|");for(var i=0;i<r.length;i++)r[i].trim().indexOf("0 ")>=0?t=t+" <a href='javasript:void(0);?id="+r[i].trim().split(" ")[1]+"' class='jsShowBusDetail btn-danger'>"+r[i]+"</a> &nbsp; | ":t=t+" <span class='btn-success'>"+r[i]+"</span> &nbsp; | ";t!=""&&(t=t.substring(0,t.length-2))}return t}return""},showMessage1:function(){return"this is the coolest!SSS"}}}return __extends(t,e),t.prototype.ShowBusDetail=function(e){var t=e.target.href.split("=")[1];this.trigger("Event:BusBookingDetail",t)},t.prototype.ShowDetail=function(){this.trigger("ShowDetail")},t}(n.Views.ItemView);t.BusAvailabilityItemView=l});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Dtos/BusAvailabilityDto",["require","exports","jquery","backbone"],function(e,t){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{id:"",centreId:"",busId:"",driverId:"",visitTypeId:"",bookingId:"",isBookingCompleted:"",description:"",busDesc:"",centreDesc:"",driverDesc:"",visitTypeDesc:"",isActive:"",createdBy:"",createdDate:"",modifiedBy:"",modifiedDate:""}},t}(Backbone.Model);e.BusAvailabilityDto=t;var n=function(e){function n(n){this.model=t,e.call(this,n)}return __extends(n,e),n}(Backbone.Collection);e.BusAvailabilityCollection=n})(t.Models||(t.Models={}));var n=t.Models});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/DAL/BusAvailability",["require","exports","CCTracking.WebClient/DAL/AjaxRequest","CCTracking.WebClient/Dtos/BusAvailabilityDto","jquery"],function(e,t,n,r){function o(){var e=new s;return e.doAjaxRequest(null,"GET","NearestCentre")}function u(e){var t=new s;return t.doAjaxRequest(e,"POST","NearestCentre")}function a(e){var t=new s;return t.doAjaxRequest(null,"GET","NearestCentre?idAll="+e)}function f(e){var t=new s;return t.doAjaxRequest(null,"GET","NearestCentre?id="+e)}var i=e("jquery"),s=function(e){function t(){e.call(this,this)}return __extends(t,e),t.prototype.getResponse=function(){return new r.Models.BusAvailabilityDto},t}(n.BaseDto);t.BusAvailabilityDal=s,t.Load=o,t.Save=u,t.GetAll=a,t.GetById=f});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Bus/BusAvailabilityCtrl",["require","exports","../App","../Helper","./BusAvailabilityView","../Dtos/BusAvailabilityDto","../DAL/BusAvailability","marionette","jquery","knockout"],function(e,t,n,r,i,s,o){var u=e("underscore"),a=e("knockout"),f=e("knockback"),l=function(e){function t(){e.call(this),this.app=n.Application.getInstance(),this.backboneModel=new s.Models.BusAvailabilityDto,this.viewModel=new i.BusAvailabilityViewModel(this.backboneModel,this),this.view=new i.BusAvailabilityView({viewModel:this.viewModel}),this.collection=new s.Models.BusAvailabilityCollection({id:"",busList:"",centreName:""}),this.collectionView=new i.BusAvailabilityCollectionView({collection:this.collection}),this.compositeModel=new Backbone.Model}return __extends(t,e),t.prototype.Show=function(){var e=this,t=JSON.parse(localStorage.getItem("lookupResponse")),n=this.backboneModel;n.set("alkhidmatCentreList",t.alkhidmatCentre),n.set("alkhidmatCentreSelected",""),n.set("busList",t.bus),n.set("busSelected",""),this.viewModel=new i.BusAvailabilityViewModel(n,this),this.view=new i.BusAvailabilityView({viewModel:this.viewModel}),this.view.model=n,this.view.listenTo(this.view,"Event:BusAvailability",function(t){return e.BusAvailability(t)}),this.collectionView.listenTo(this.collectionView,"itemview:Event:BusBookingDetail",function(t,n){return e.ShowBusBookingDetail(n)}),this.app.RightRegion.show(this.view),this.app.BusAvailabilityRegion.show(this.collectionView)},t.prototype.ShowBusBookingDetail=function(e){var t=this,n=o.GetById(e);n.done(function(e){return t.ShowBusBookingDetailCompleted(e)})},t.prototype.ShowBusBookingDetailCompleted=function(e){var t=u.map(e.nearestCentreList,function(e){return e.pickupDate=r.FormatDateString(e.pickupDate),e}),n=new Backbone.Collection(t),i=new Backbone.Model;i.set("type","btn-primary"),i.set("message",""),r.ShowBusDetailModalPopup(i,n)},t.prototype.BusAvailability=function(e){var t=this,n=o.GetAll(e);n.done(function(e){return t.GetAllCompleted(e)})},t.prototype.GetAllCompleted=function(e){this.collection.reset(e.nearestCentreList),this.collectionView.collection=this.collection},t}(r.Controller);t.BusAvailabilityCtrl=l}),define("text!CCTracking.WebClient/Booking/BookingLeft/BookingLeftTmpl.html",[],function(){return'<div id="BookingLeftPane">\r\n    <ul class="list-group left-menu-size">\r\n                <li class="list-group-item active"><i class="fa fa-bar-chart">&nbsp;</i>&nbsp;SUMMARY\r\n                </li>\r\n                <li class="list-group-item"><span class="glyphicon glyphicon-stats"></span> Todays\'s Booking\r\n                    <a href="javascript:void(0)" class="jsTodayBooking"><span class="badge" data-bind="text:model.todaysBooking"></span></a>\r\n                </li>\r\n                <li class="list-group-item">CURRENT USER SUMMARY\r\n                </li>\r\n                <li class="list-group-item"><span class="glyphicon glyphicon-stats"></span> Bookings\r\n                    <a href="javascript:void(0)" class="jsTotalBooking"><span class="badge"  data-bind="text:model.userTotalBooking"></span></a>\r\n                </li>\r\n                <li class="list-group-item"><span class="glyphicon glyphicon-stats"></span> Paid Bookings\r\n                    <a  href="javascript:void(0)" class="jsPaidBooking"><span class="badge"  data-bind="text:model.userPiadBooking"></span></a>\r\n                </li>\r\n                <li class="list-group-item"><span class="glyphicon glyphicon-stats"></span> Unpaid Bookings\r\n                    <a  href="javascript:void(0)" class="jsUnpaidBooking"><span class="badge"  data-bind="text:model.userUnpaidBooking"></span></a>\r\n                </li>\r\n            </ul>\r\n</div>\r\n'}),define("text!CCTracking.WebClient/Common/Templates/ModalPopup.html",[],function(){return'<div>\r\n    <script type="text/html" id="Modal">\r\n        <div class="modal-dialog jsModal" style="z-index: 10001">\r\n            <div class="modal-content">\r\n                <div class="modal-header <%=type%>">\r\n                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>\r\n                    <h4 class="modal-title" id="myModalLabel"><%=title%></h4>\r\n                </div>\r\n                <div class="modal-body modalBody" id="ModalBody">\r\n                    <strong><%=message%></strong>\r\n                </div>\r\n                <div class="modal-footer">\r\n                    <button type="button" class="btn <%=type%>" data-dismiss="modal">Close</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n    </script>\r\n</div>\r\n'}),define("text!CCTracking.WebClient/Common/Templates/Progressbar.html",[],function(){return'<div>\r\n    <div type="text/html" id="Progressbar" class="row">\r\n        <div class="col-xs-12 text-center">\r\n            <!--<img class="jsProgressbar" src="/CCTrackingTS/Content/Images/progressbar.gif" alt="..." />-->\r\n            <span class="jsProgressbar fa fa-5x fa-spinner fa-spin"></span>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("text!CCTracking.WebClient/Common/Templates/BusDetailModalPopup.html",[],function(){return'<div>\r\n    <!--<div id="ModalGrid1">\r\n            <div></div>\r\n        </div>-->\r\n\r\n    <div id="ModalGrid">\r\n        <div class="modal-dialog">\r\n            <div class="modal-content">\r\n                <div class="modal-header <%=type%>">\r\n                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>\r\n                    <h4 class="modal-title" id="myModalLabel">BUS STATUS</h4>\r\n                </div>\r\n                <div class="modal-body modalBody" id="ModalBody">\r\n                    <div id="ItemContainer"></div>\r\n\r\n                </div>\r\n                <div class="modal-footer">\r\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <script type="text/html" id="Modal">    \r\n        <div class="row">\r\n            <div ><hr/></div>\r\n        </div>\r\n         <div class="row input-sm">\r\n            <div class="col-sm-3 text-right">Booking Id</div>\r\n            <div class="col-sm-6"><%=bookingId%></div>\r\n        </div>\r\n        <div class="row input-sm">\r\n            <div class="col-sm-3 text-right">Driver Name</div>\r\n            <div class="col-sm-6"><%=fullName%></div>\r\n        </div>\r\n        <div class="row input-sm">\r\n            <div class="col-sm-3 text-right">Driver Contact</div>\r\n            <div class="col-sm-6 text-danger"><strong><%=mobileNo%></strong> </div>\r\n        </div>\r\n        <div class="row input-sm">\r\n            <div class="col-sm-3 text-right">Vehicle</div>\r\n            <div class="col-sm-6"> <%=vehicleNo%></div>\r\n        </div>\r\n        <div class="row input-sm">\r\n            <div class="col-sm-3 text-right">Pickup Date</div>\r\n            <div class="col-sm-6"> <%=pickupDate%></div>\r\n        </div>\r\n        <div class="row input-sm">\r\n            <div class="col-sm-3 text-right">Time Slot</div>\r\n            <div class="col-sm-6 text-danger"><strong><%=pickupTime%> - <%=returnTime%></strong> </div>\r\n        </div>\r\n        <div class="row input-sm">\r\n            <div class="col-sm-3 text-right">Bus Point</div>\r\n            <div class="col-sm-6"><%=busPoint%></div>\r\n        </div>\r\n        <div class="row input-sm">\r\n            <div class="col-sm-3 text-right">Graveyard</div>\r\n            <div class="col-sm-6"><%=graveyard%></div>\r\n        </div>\r\n        <div class="row input-sm">\r\n            <div class="col-sm-3 text-right">Masjid Name</div>\r\n            <div class="col-sm-6"><%=masjidName%></div>\r\n        </div>\r\n        <div class="row input-sm">\r\n            <div class="col-sm-3 text-right">Funeral Prayer</div>\r\n              <div class="col-sm-6 text-danger"><strong><%=namazEJanazaHeldIn%></strong> </div>\r\n        </div>\r\n        <div class="row input-sm">\r\n            <div class="col-sm-3 text-right">Funeral Location</div>\r\n            <div class="col-sm-6"><%=namazEJanazaLocation%></div>\r\n        </div>\r\n        <div class="row input-sm">\r\n            <div class="col-sm-3 text-right">Other Details</div>\r\n            <div class="col-sm-6"><%=otherDetail%></div>\r\n        </div>\r\n       \r\n    </script>\r\n\r\n</div>\r\n'}),define("text!CCTracking.WebClient/Common/Templates/ReceiptLayout.html",[],function(){return'\r\n\r\n<div>\r\n\r\n    <script type="text/html" id="ReceiptTemplate">\r\n\r\n        <div>\r\n            <button id="btnExportPdf" type="button" class="jsExportPdf btn btn-default" style="display: none">Export to Pdf</button></div>\r\n        <div class="modal-dialog">\r\n            <div class="modal-content">\r\n                <div class="modal-header btn-primary">\r\n                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>\r\n                    <h4 class="modal-title" id="myModalLabel"><i class="fa fa-file-pdf-o">&nbsp;</i> PRINT RECEIPT LAYOUT</h4>\r\n                </div>\r\n                <div class="modal-body modalBody" id="ModalBody">\r\n                    <div id="ItemContainer"></div>\r\n\r\n                </div>\r\n                <div class="modal-footer">\r\n                    <button type="button" class="jsPrintDocument btn btn-default">Print</button>\r\n                    <button type="button" class="jsPDFReceipt btn btn-default" style="display: none">Export to Pdf</button>\r\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n\r\n\r\n    </script>\r\n\r\n    <!-- Starts Booking Receipt Layout-->\r\n    <script type="text/html" id="ReceiptContainer">\r\n        <div id="ReceiptLayout" class="PrintArea row">\r\n            \r\n            <!-- <table class="table table-condensed table-removeTopBorder table-hover form-group" style="width: 595px;">\r\n                \r\n                     <tr>\r\n                         <td colspan="2" class="input-sm text-center" style="width: 595px;">AKWS Coffin Carrier Tracking System</td>                    \r\n                     </tr>\r\n                     <tr>\r\n                         <td colspan="2" class="input-sm text-center" style="width: 595px;">centre name</td>\r\n                     </tr>\r\n                \r\n                     <tr>\r\n                         <td class="input-sm" style="width: 300px;">Generated By: <%=userName%></td>\r\n                         <td class="text-right input-sm" style="width: 295px;">Signed By___________</td>\r\n                     </tr>\r\n\r\n                 </table>-->\r\n\r\n            <table class="table table-condensed table-removeTopBorder table-hover form-group">\r\n                   \r\n                    <tr>\r\n                        <td colspan="2" class="input-sm text-center input-lg">AKWS Coffin Carrier Tracking System</td>                    \r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan="2" class="input-sm text-center" >Head Office - Noor-ul-Huda Centre, Near Numayesh Chorangi</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan="2" class="input-sm text-center input-md">Cash Receipt</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class="input-sm">Cash Receipt #: <%=bookingReceipt%></td>\r\n                        <td class="text-right input-sm">Date: <%=printDateTime%></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class="input-sm">Booking Id: <%=bookingId%></td>\r\n                        <td class="text-right input-sm">Booking Date: <%=bookingDate%></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class="input-sm col-sm-8">Cash Received From ________________________________________</td>\r\n                        <td class="input-sm text-right col-sm-4">of Rs.______________</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan="2" class="input-sm">For_________________________________________________________________________</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan="2" class="input-sm text-right">\r\n                            <table class="table table-condensed table-bordered">\r\n                                <tr>\r\n                                    <td class="col-sm-4 col-md-4 text-center">Particulars</td>\r\n                                    <td class="col-sm-4 col-md-4 text-center">Details</td>\r\n                                </tr>\r\n                                \r\n                                <tr>\r\n                                    <td class="col-sm-4 col-md-4 text-left">Cash Received From</td>\r\n                                    <td class="col-sm-4 col-md-4 text-left"><%=contactName%></td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td class="col-sm-4 col-md-4 text-left">Total Amount Due</td>\r\n                                    <td class="col-sm-4 col-md-4 text-left"><%=bookingAmount%></td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td class="text-left">Amount Received</td>\r\n                                    <td>&nbsp;</td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td class="text-left">Balance Due</td>\r\n                                    <td>&nbsp;</td>\r\n                                </tr>\r\n                            </table>\r\n                        </td>                    \r\n                    </tr>\r\n                    <tr>\r\n                        <td class="input-sm">Generated By: <%=userName%></td>\r\n                        <td class="text-right input-sm">Signed By___________</td>\r\n                    </tr>\r\n\r\n                </table>\r\n\r\n            <!--<div class="col-sm-12 col-md-12">\r\n\r\n                    <div class="row text-center">\r\n                        <div class="col-sm-12 col-md-12">AKWS Coffin Carrier Tracking System</div>\r\n                    </div>\r\n                    <div class="row text-center">\r\n                        centre name\r\n                    </div>\r\n                    <div class="row">&nbsp;</div>\r\n                    <div class="row text-center">\r\n                        <div class="col-sm-12 col-md-12">Cash Receipt</div>\r\n                    </div>\r\n                    <div class="row">\r\n                        <div class="col-sm-4 col-md-4">Cash Receipt #: <%=bookingReceipt%></div>\r\n                        <div class="col-sm-8 col-md-8 text-right">Date: <%=printDateTime%></div>\r\n                    </div>\r\n                    <div class="row">&nbsp;</div>\r\n                    <div class="row">\r\n                        <div class="col-sm-12 col-md-12">Booking Id: <%=bookingId%> \r\n                            <span class="pull-right">Booking Date: <%=bookingDate%></span>\r\n                        </div> \r\n                    </div>\r\n               \r\n                    <div class="row">&nbsp;</div>\r\n                \r\n                    <div class="row">\r\n                        <div class="col-sm-12 col-sm-12">\r\n                            Cash Received From_________________________ <span class="pull-right">of Rs.________________</span>\r\n                        </div>\r\n                    \r\n                    </div>\r\n\r\n               \r\n                    <div class="row">&nbsp;</div>\r\n                    <div class="row">\r\n                        <div class="col-sm-12 col-md-12">For___________________________________________________________________</div>\r\n                    </div>\r\n                    <div class="row">&nbsp;</div>\r\n                    <div class="row">\r\n                        <div class="col-sm-4 col-md-4">&nbsp;</div>\r\n                        <div class="col-sm-8 col-md-8">\r\n                            <table class="table table-condensed table-bordered">\r\n                                <tr>\r\n                                    <td class="col-sm-4 col-md-4">Particulars</td>\r\n                                    <td class="col-sm-4 col-md-4">Amount</td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td class="col-sm-4 col-md-4">Total Amount Due</td>\r\n                                    <td class="col-sm-4 col-md-4"><%=bookingAmount%></td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td>Amount Received</td>\r\n                                    <td>&nbsp;</td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td>Balance Due</td>\r\n                                    <td>&nbsp;</td>\r\n                                </tr>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                    <div class="row">\r\n                        <div class="col-sm-8 col-md-8">Generated By: <%=userName%></div>\r\n                        <div class="col-sm-4 col-md-4 text-right">Signed By___________</div>\r\n                    </div>\r\n                </div>-->\r\n            \r\n         \r\n\r\n        </div>\r\n    </script>\r\n\r\n    <!-- End Booking Receipt Layout-->\r\n</div>\r\n'});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Booking/BookingLeft/BookingLeftView",["require","exports","../../App","../../Helper","text!CCTracking.WebClient/Booking/BookingLeft/BookingLeftTmpl.html","text!CCTracking.WebClient/Common/Templates/ModalPopup.html","text!CCTracking.WebClient/Common/Templates/Progressbar.html","text!CCTracking.WebClient/Common/Templates/BusDetailModalPopup.html","text!CCTracking.WebClient/Common/Templates/ReceiptLayout.html","marionette"],function(e,t,n,r){var i=e("underscore"),s=e("text!CCTracking.WebClient/Booking/BookingLeft/BookingLeftTmpl.html"),o=e("text!CCTracking.WebClient/Common/Templates/ModalPopup.html"),u=e("text!CCTracking.WebClient/Common/Templates/Progressbar.html"),a=e("text!CCTracking.WebClient/Common/Templates/BusDetailModalPopup.html"),f=e("text!CCTracking.WebClient/Common/Templates/ReceiptLayout.html"),l,c=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t}(r.ViewModel);t.BookingLeftViewModel=c;var h=function(e){function t(t){this.template=s,l=n.Application.getInstance(),this.events={"click .jsTodayBooking":"ShowTodayBooking","click .jsTotalBooking":"ShowTotalBooking","click .jsPaidBooking":"ShowPaidBooking","click .jsUnpaidBooking":"ShowUnpaidBooking"},e.call(this,t)}return __extends(t,e),t.prototype.ShowTotalBooking=function(e){e.preventDefault(),this.trigger("ShowTotalBooking")},t.prototype.ShowPaidBooking=function(e){e.preventDefault(),this.trigger("ShowPaidBooking")},t.prototype.ShowUnpaidBooking=function(e){e.preventDefault(),this.trigger("ShowUnpaidBooking")},t.prototype.ShowTodayBooking=function(e){e.preventDefault(),this.trigger("ShowTodayBooking")},t}(r.Views.MvvmView);t.BookingLeftView=h;var p=function(e){function t(t){this.template=o.getOuterHTML("#Modal"),e.call(this,t)}return __extends(t,e),t}(r.Views.ItemView);t.ModalPopupView=p;var d=function(e){function t(t){this.template=u.getOuterHTML("#Progressbar"),e.call(this,t)}return __extends(t,e),t}(r.Views.ItemView);t.ProgressbarView=d;var v=function(e){function t(t){this.itemView=m,this.template=a.getOuterHTML("#ModalGrid"),this.itemViewContainer="#ItemContainer",e.call(this,t)}return __extends(t,e),t}(r.Views.CompositeView);t.BusDetailModalPopupCollectionView=v;var m=function(e){function t(t){this.template=a.getOuterHTML("#Modal"),this.tagName="div",e.call(this,t)}return __extends(t,e),t}(r.Views.ItemView);t.BusDetailModalPopupView=m;var g=function(e){function t(t){var n=this;this.itemView=y,this.template=f.getOuterHTML("#ReceiptTemplate"),this.itemViewContainer="#ItemContainer",this.events={"click .jsPrintDocument":function(){r.PrintDocument(),n.close()},"click .jsPDFReceipt":function(){n.trigger("Event-PrintPDFReceipt")}},e.call(this,t)}return __extends(t,e),t}(r.Views.CompositeView);t.ReceiptLayoutCollectionView=g;var y=function(e){function t(t){this.template=f.getOuterHTML("#ReceiptContainer"),e.call(this,t)}return __extends(t,e),t}(r.Views.ItemView);t.ReceiptLayoutItemView=y});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Dtos/BookingLeftDto",["require","exports","backbone"],function(e,t){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{officerId:"",todaysBooking:"",userTotalBooking:"",userPiadBooking:"",userUnpaidBooking:""}},t}(Backbone.Model);e.BookingLeftDto=t;var n=function(e){function n(n){this.model=t,e.call(this,n)}return __extends(n,e),n}(Backbone.Collection);e.DriverCollection=n})(t.Models||(t.Models={}));var n=t.Models});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/DAL/BookingLeft",["require","exports","CCTracking.WebClient/DAL/AjaxRequest","CCTracking.WebClient/Dtos/BookingLeftDto"],function(e,t,n,r){function s(e){var t=new i;return t.doAjaxRequest(e,"POST","BookingLeft")}var i=function(e){function t(){e.call(this,this)}return __extends(t,e),t.prototype.getResponse=function(){return new r.Models.BookingLeftDto},t}(n.BaseDto);t.BookingLeftDal=i,t.GetByCriteria=s});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Dtos/ReceiptContentDto",["require","exports","backbone"],function(e,t){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{bookingId:"",centreDesc:"",contactName:"",bookingReceipt:"",bookingDate:"",bookingAmount:"",userName:"",printDateTime:""}},t}(Backbone.Model);e.ReceiptContentDto=t;var n=function(e){function n(n){this.model=t,e.call(this,n)}return __extends(n,e),n}(Backbone.Collection);e.ReceiptContentCollection=n})(t.Models||(t.Models={}));var n=t.Models});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/DAL/ReceiptContent",["require","exports","CCTracking.WebClient/DAL/AjaxRequest","CCTracking.WebClient/Dtos/ReceiptContentDto"],function(e,t,n,r){function s(e){var t=new i;return t.doAjaxRequest(null,"GET","ReceiptContent?id="+e)}var i=function(e){function t(){e.call(this,this)}return __extends(t,e),t.prototype.getResponse=function(){return new r.Models.ReceiptContentDto},t}(n.BaseDto);t.ReceiptContentDal=i,t.GetById=s});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Booking/BookingLeft/BookingLeftCtrl",["require","exports","../../App","../../Helper","./BookingLeftView","../../Dtos/BookingLeftDto","../../DAL/BookingLeft","../../DAL/ReceiptContent","../BookingCtrl","marionette","jquery","knockout","text!./BookingLeftTmpl.html","printArea"],function(e,t,n,r,i,s,o,u,a){var f=e("underscore"),l=e("knockout"),c=e("knockback"),h=e("printArea"),p=function(e){function t(){e.call(this),this.app=n.Application.getInstance(),this.backboneModel=new s.Models.BookingLeftDto,this.bookingLeftViewModel=new i.BookingLeftViewModel(this.backboneModel,this),this.bookingLeftView=new i.BookingLeftView({viewModel:this.bookingLeftViewModel})}return __extends(t,e),t.prototype.Show=function(){var e=this,t=this.app.request("AppGlobalSetting"),n=new s.Models.BookingLeftDto;n.set("officerId",t.get("Id"));var r=o.GetByCriteria(n);r.done(function(t){return e.GetByCriteriaCompleted(t)})},t.prototype.GetByCriteriaCompleted=function(e){var t=this;this.backboneModel=new Backbone.Model(e.bookingLeftModel);var n=this.backboneModel;this.UIBinding(n),this.bookingLeftView=new i.BookingLeftView({viewModel:this.bookingLeftViewModel}),this.bookingLeftView.on("ShowTotalBooking",function(){return t.ShowTotalBooking()}),this.bookingLeftView.on("ShowPaidBooking",function(){return t.ShowPaidBooking()}),this.bookingLeftView.on("ShowUnpaidBooking",function(){return t.ShowUnpaidBooking()}),this.bookingLeftView.on("ShowTodayBooking",function(){return t.ShowTodayBooking()}),this.app.LeftRegion.show(this.bookingLeftView)},t.prototype.ShowTotalBooking=function(){(new a.BookingCtrl).GetAll(1)},t.prototype.ShowPaidBooking=function(){(new a.BookingCtrl).GetAll(2)},t.prototype.ShowUnpaidBooking=function(){(new a.BookingCtrl).GetAll(3)},t.prototype.ShowTodayBooking=function(){(new a.BookingCtrl).GetAll(4)},t.prototype.UIBinding=function(e){this.bookingLeftViewModel.bbModel=e,this.bookingLeftViewModel.model=c.viewModel(e),l.cleanNode($(this.bookingLeftView.el)[0]),l.applyBindings(this.bookingLeftViewModel,this.bookingLeftView.el)},t.prototype.ShowProgressbar=function(){var e=this.app.ModalRegion.currentView,t=new Backbone.Model({type:"btn-",title:"title",message:"message"}),n=new i.ProgressbarView({model:t});this.app.ModalRegion.currentView==undefined&&this.app.ModalRegion.show(n)},t.prototype.HideProgressbar=function(){var e=this.app.ModalRegion.currentView;this.app.ModalRegion.close(),$(".modal-backdrop").remove()},t.prototype.ShowModalPopup=function(e,t,n){var r=new Backbone.Model({type:"btn-"+e,title:t,message:n}),s=new i.ModalPopupView({model:r});this.app.ModalAlertRegion.show(s)},t.prototype.PrintReceipt=function(e){var t=this,n=u.GetById(e);n.done(function(e){return t.GetReceiptContentCompleted(e)})},t.prototype.GetReceiptContentCompleted=function(e){var t=this,n=f.map(e.receiptContentList,function(e){var n=new Date(e.printDateTime),i=t.app.request("AppGlobalSetting");return e.bookingDate=r.FormatDateString(e.bookingDate),e.printDateTime=r.FormatDateString(e.printDateTime)+"    "+n.getHours()+":"+n.getMinutes(),e.bookingAmount=r.FormatMoney(e.bookingAmount),e.userName=i.get("FirstName")+","+i.get("LastName"),e}),s=new Backbone.Collection(n),o=new i.ReceiptLayoutCollectionView({collection:s});this.app.ModalAlertRegion.show(o),this.app.ModalAlertRegion.show(o),o.on("Event-PrintPDFReceipt",function(){t.ExportToPdf(o.$el.find("#ReceiptLayout")[0]),t.app.ModalAlertRegion.close()})},t}(r.Controller);t.BookingLeftCtrl=p}),define("text!CCTracking.WebClient/Bus/BusVisit/BusVisit.html",[],function(){return'<div>\r\n    <div class="panel panel-default">\r\n        <div class="panel-heading header-bold"><span class="glyphicon glyphicon-briefcase"></span>&nbsp;BUS DETAILS</div>\r\n        <div class="panel-body">\r\n            <form id="form1" name="form1">\r\n                <div class="panel panel-default">\r\n                    <!--<div class="panel-heading header-bold">PAYMENT INFO</div>-->\r\n                    <div class="panel-body">\r\n                        <table class="table table-removeTopBorder table-condensed table-hover form-group">\r\n\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Alkhidmat/Co-Partners</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <select id="ddlCentre" class="form-control input-sm"\r\n                                            data-bind="options: alkhidmatCentreList, optionsText:\'description\', value:alkhidmatCentreSelected">\r\n                                    </select></td>\r\n                            </tr>\r\n                             <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Driver</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <select id="Select1" class="form-control input-sm"\r\n                                        data-bind="options: driverList, optionsText:\'description\', value:driverSelected">\r\n                                    </select>\r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Vehicle No</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                   <select id="ddlBusDetails" class="form-control input-sm"\r\n                                        data-bind="options: busList, optionsText:\'description\', value:busSelected, disable:isEdit()">\r\n                                    </select>\r\n                                </td>\r\n                            </tr>\r\n                             <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Incharge Name</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" class="form-control input-sm" placeholder="Incharge Name" data-bind="value:inchargeName" />   \r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Visit Date</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" id="PickupDate" class="form-control input-sm" placeholder="mm/dd/yyyy" data-bind="datepicker:{}, value:visitDate"\r\n                                        required="required" data-role="validate" title="Visit Date" data-content="Visit date is required" />   \r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Bus Visit Type</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <select id="ddlOtherTravelling" class="form-control input-sm" data-bind="options: visitTypeList, optionsText:\'description\', value:visitTypeSelected, disable:isEdit()"> </select>\r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Out Time</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                     <select id="ddlReturnTime" class="form-control input-sm"\r\n                                data-bind="options: outTimeSlotList, optionsText:\'description\', value:outTimeSlotSelected">\r\n                            </select>\r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Return Time</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                <select id="Select2" class="form-control input-sm"\r\n                                        data-bind="options: reutrnTimeSlotList, optionsText:\'description\', value:returnTimeSlotSelected">\r\n                                </select>\r\n                            </tr>\r\n                             <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Return Date</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" id="Text1" class="form-control input-sm" placeholder="mm/dd/yyyy" data-bind="datepicker: {}, value: returnDate" />   \r\n                                </td>\r\n                            </tr>\r\n                            <tr >\r\n                                <td class="col-sm-4 col-md-4 input-sm">Filling Meter Reading </td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" class="form-control input-sm" placeholder="Current Reading" data-bind="value:readingWhenFilling" />\r\n                                        <!--required="required" data-role="validate" title="Current Reading" data-content="Current reading is required" />   -->\r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Initial Reading</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" class="form-control input-sm" placeholder="Bus Initial Reading" data-bind="value:initialReading" />   \r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Final Reading</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" class="form-control input-sm" placeholder="Bus Final Reading" data-bind="value:finalReading" />   \r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Amount</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" placeholder="Amount"  class="form-control input-sm" data-bind="value: fuelAmount, enable: !isBooking()" \r\n                                        required="required" data-role="validate" title="Amount" data-content="Amount is required"  />   \r\n                                </td>\r\n                            </tr>\r\n                            \r\n                             <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Pump Location</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <textarea id="txtPumpLocation" placeholder="Location" class="form-control input-sm" data-bind="value:pumpLocation, enable:isPatrolPump()">   \r\n                                    </textarea>\r\n                                </td>\r\n                            </tr>\r\n\r\n                            <!--<tr>\r\n                                <td>Booking (If any)</td>\r\n                                <td>\r\n                                    <input type="text" placeholder="Booking" disabled />\r\n                                    <br />\r\n                                    enable if visit type is booking\r\n                                </td>\r\n                            </tr>\r\n                            -->\r\n\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Fuel Rate</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" placeholder="Rate" class="form-control input-sm" data-bind="value:fuelRate, enable:isPatrolPump()" \r\n                                        required="required" data-role="validate" title="Fuel Rate" data-content="Fuel rate is required"  />   \r\n                                </td>\r\n                            </tr>\r\n                            \r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Fuel Quantity (Liter)</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" placeholder="Fuel Quantity"  class="form-control input-sm" data-bind="value:fuelQuantity, enable:isPatrolPump()" \r\n                                        required="required" data-role="validate" title="Fuel Quantity" data-content="Fuel quantity is required"  />   \r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Fuel Receipt</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" placeholder="Fuel Receipt"  class="form-control input-sm" data-bind="value:fuelingReceipt, enable:isPatrolPump()" \r\n                                        required="required" data-role="validate" title="Fuel Receipt" data-content="Fuel receipt is required"  />   \r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Description</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <textarea id="txtDescription" placeholder="Description" class="form-control input-sm" data-bind="value:description" >   </textarea>\r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Booking Completed</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="radio" name="rbCurrentBooking" value="1" data-bind="checked:isBookingCompleted, enable:isBooking() || isMaintenance()" />Yes\r\n                                    <input type="radio" name="rbCurrentBooking" value="0" data-bind="checked: isBookingCompleted, enable: isBooking() || isMaintenance()" />No\r\n                                </td>\r\n                            </tr>\r\n                           \r\n                            <!--<tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm"></td>\r\n                                <td class="col-sm-8 col-md-8"><a href="#" data-toggle="modal" data-target="#busDetailsModal" class="form-control input-sm">View Bus Details</a></td>\r\n                            </tr>-->\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4"></td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <button type="submit" class="btn btn-default">Save</button>\r\n                                    &nbsp;\r\n                                    <button type="button" class="jsCancel btn btn-default">Cancel</button>\r\n                                </td>\r\n                            </tr>\r\n\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n\r\n            </form>\r\n\r\n            <div id="DetailRegion">\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n\r\n</div>'}),define("text!CCTracking.WebClient/Bus/BusVisit/BusVisitGrid.html",[],function(){return'<div>\r\n    <div id="BusVisitLayout">\r\n        <div class="rgnSearch"></div>\r\n        <div class="rgnContent"></div>\r\n    </div>\r\n\r\n    <div id="gridTemplate">\r\n        <div class="panel panel-default">\r\n            <div class="panel-body">\r\n                <table id="tblStation" class="table table-condensed table-bordered table-hover table-striped">\r\n                    <thead>\r\n                        <tr class="active">\r\n                            <th class="input-sm">Bus</th>\r\n                            <th class="input-sm">Booking Id</th>\r\n                            <th class="input-sm">Visit Type</th>\r\n                            <th class="input-sm">Dates</th>\r\n                            <th class="input-sm">Meter Reading</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody></tbody>\r\n                    <tfoot>\r\n                        <tr class="active">\r\n                            <td colspan="5">&nbsp;</td>\r\n                        </tr>\r\n                    </tfoot>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div id="SearchPanel">\r\n        <div class="panel panel-default">\r\n            <div class="panel-heading header-bold">\r\n                <span class="glyphicon glyphicon-time"></span>View - Bus Visit List\r\n                <span class="pull-right"><a href="#busVisit">Add New</a></span>\r\n            </div>\r\n            <div class="panel-body">\r\n                <div class="pull-right">\r\n                    <form class="navbar-form navbar-left" role="search">\r\n                        <div class="form-group">\r\n                            Vehicle No  \r\n                            <select id="ddlBuses" class="form-control input-sm"\r\n                                    data-bind="options: busList, optionsText: \'description\', value: busSelected">\r\n                            </select>\r\n                        </div>\r\n                        <button type="button" class="jsSearchVisit btn btn-default">Search</button>\r\n                    </form>\r\n                    </div>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <script type="text/html" id="rowTemplate">\r\n        <td class="jsShowDetail edit-action input-sm " ><%=busDesc%></td>\r\n        <td class="input-sm"><%=bookingId%></td>\r\n        <td class="input-sm"><%=visitTypeDesc%></td>\r\n        <td class="input-sm"><%=visitDate%> - <%=returnDate%></td>\r\n        <td class="input-sm"><%=initialReading%> - <%=finalReading%></td>\r\n\r\n    </script>\r\n</div>\r\n'});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Bus/BusVisit/BusVisitView",["require","exports","../../Helper","marionette","jquery","knockout","text!./BusVisit.html","text!./BusVisitGrid.html"],function(e,t,n){var r=e("underscore"),i=e("knockout"),s=e("text!./BusVisit.html"),o=e("text!./BusVisitGrid.html"),u=function(e){function t(t){this.template=o.getOuterHTML("#BusVisitLayout"),this.regions={SearchRegion:{selector:".rgnSearch"},ContentRegion:{selector:".rgnContent"}},e.call(this,t)}return __extends(t,e),t}(Marionette.Layout);t.SearchBusVisitLayoutView=u;var a=function(e){function t(t){this.itemView=f,this.template=o.getOuterHTML("#gridTemplate"),this.itemViewContainer="tbody",e.call(this,t)}return __extends(t,e),t.prototype.onShow=function(){this.dataTable=this.$el.find("#tblStation").dataTable({autoWidth:!1,info:!0,processing:!0,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],language:{paginate:{next:"Next",previous:"Prev"},emptyTable:"",infoEmpty:"",zeroRecords:"No record found!"},pageLength:n.GetPageSize()})},t}(n.Views.CompositeView);t.BusVisitCollectionView=a;var f=function(e){function t(t){t||(t={}),t.template=o.getOuterHTML("#rowTemplate"),t.tagName="tr",t.className="jsRowClick",t.events={"click .jsShowDetail":"EditBusVisit"},e.call(this,t)}return __extends(t,e),t.prototype.EditBusVisit=function(){window.location.href="#editBusVisit",this.trigger("Event:EditForm",this.model.get("id"))},t}(n.Views.ItemView);t.BusVisitItemView=f;var l=function(e){function t(t){this.template=o.getOuterHTML("#SearchPanel"),this.events={"click .jsSearchVisit":"SearchVisit"},e.call(this,t)}return __extends(t,e),t.prototype.SearchVisit=function(e){e.preventDefault(),this.trigger("Event:SearchVisit",this.model.get("busSelected").id)},t}(n.Views.ItemView);t.BusVisitSearchItemView=l;var c=function(e){function t(t){this.template=s,this.viewModel=new h(t),this.bbModel=new Backbone.Model,this.events={submit:"Save","click .jsCancel":"Cancel"},e.call(this,t)}return __extends(t,e),t.prototype.close=function(){},t.prototype.Cancel=function(){this.trigger("Event:CancelForm")},t.prototype.Save=function(e){e.preventDefault();if(!this.viewModel.isValidReading())return n.ShowModalPopup("danger","Bus Visit","Please enter valid reading! Final reading should be greather than the Initial reading!"),!1;if(this.viewModel.isBookingCompleted()=="1"){if(this.viewModel.returnDate()==undefined||this.viewModel.returnDate()=="")return n.ShowModalPopup("danger","Bus Visit","Please enter valid return date to complete the booking."),!1;if(this.viewModel.finalReading()==undefined||this.viewModel.finalReading()==""||this.viewModel.finalReading()==0)return n.ShowModalPopup("danger","Bus Visit","Please enter valid final reading to complete the booking."),!1}this.bbModel.set("id",this.viewModel.id()),this.bbModel.set("isActive",this.viewModel.isActive()=="1"?!0:!1),this.bbModel.set("bookingId",this.viewModel.bookingId()),this.bbModel.set("inchargeName",this.viewModel.inchargeName()),this.bbModel.set("visitDate",this.viewModel.visitDate()),this.bbModel.set("returnDate",this.viewModel.returnDate()),this.bbModel.set("readingWhenFilling",this.viewModel.readingWhenFilling()),this.bbModel.set("pumpLocation",this.viewModel.pumpLocation()),this.bbModel.set("fuelRate",this.viewModel.fuelRate()),this.bbModel.set("fuelQuantity",this.viewModel.fuelQuantity()),this.bbModel.set("fuelAmount",this.viewModel.fuelAmount()),this.bbModel.set("fuelingReceipt",this.viewModel.fuelingReceipt()),this.bbModel.set("isBookingCompleted",this.viewModel.isBookingCompleted()),this.bbModel.set("description",this.viewModel.description()),this.bbModel.set("initialReading",this.viewModel.initialReading()),this.bbModel.set("finalReading",this.viewModel.finalReading()),this.bbModel.set("busDesc",this.viewModel.busDesc()),this.bbModel.set("centreDesc",this.viewModel.centreDesc()),this.bbModel.set("driverDesc",this.viewModel.driverDesc()),this.bbModel.set("visitTypeDesc",this.viewModel.visitTypeDesc()),this.bbModel.set("centreId",this.viewModel.alkhidmatCentreSelected().id),this.bbModel.set("driverId",this.viewModel.driverSelected().id),this.bbModel.set("busId",this.viewModel.busSelected().id),this.bbModel.set("outTime",this.viewModel.outTimeSlotSelected().id),this.bbModel.set("returnTime",this.viewModel.returnTimeSlotSelected().id),this.bbModel.set("visitTypeId",this.viewModel.visitTypeSelected().id),this.trigger("Event:SaveForm",this.bbModel)},t.prototype.onShow=function(){i.applyBindings(this.viewModel,this.el)},t}(n.Views.ItemView);t.BusVisitView=c;var h=function(){function e(e){var t=this,s=JSON.parse(localStorage.getItem("lookupResponse"));this.outTimeSlotList=i.observableArray(s.timeSlot),this.reutrnTimeSlotList=i.observableArray(s.timeSlot),this.busList=i.observableArray(s.bus),this.driverList=i.observableArray(s.driver),this.alkhidmatCentreList=i.observableArray(s.alkhidmatCentre),this.visitTypeList=i.observableArray(s.visitType);if(e==undefined)this.id=i.observable(),this.isEdit=i.observable(!1),this.isActive=i.observable("1"),this.centreId=i.observable(),this.busId=i.observable(),this.driverId=i.observable(),this.visitTypeId=i.observable(),this.bookingId=i.observable(),this.inchargeName=i.observable(),this.visitDate=i.observable(),this.outTime=i.observable(),this.returnTime=i.observable(),this.returnDate=i.observable(),this.readingWhenFilling=i.observable(),this.pumpLocation=i.observable(),this.fuelRate=i.observable(),this.fuelAmount=i.observable(),this.fuelQuantity=i.observable(),this.fuelingReceipt=i.observable(),this.isBookingCompleted=i.observable(),this.description=i.observable(),this.initialReading=i.observable(),this.finalReading=i.observable(),this.busDesc=i.observable(),this.centreDesc=i.observable(),this.driverDesc=i.observable(),this.visitTypeDesc=i.observable(),this.outTimeSlotSelected=i.observable(),this.returnTimeSlotSelected=i.observable(),this.busSelected=i.observable(),this.driverSelected=i.observable(),this.alkhidmatCentreSelected=i.observable(),this.visitTypeSelected=i.observable(),this.isPatrolPump=i.computed({owner:this,read:function(){return t.visitTypeSelected()!=undefined&&n.VisitTypes[t.visitTypeSelected().id]==n.VisitTypes[1]?!0:!1}}),this.isMaintenance=i.computed({owner:this,read:function(){return t.visitTypeSelected()!=undefined&&n.VisitTypes[t.visitTypeSelected().id]==n.VisitTypes[3]?!0:!1}}),this.isBooking=i.computed({owner:this,read:function(){return t.visitTypeSelected()!=undefined&&n.VisitTypes[t.visitTypeSelected().id]==n.VisitTypes[2]?!0:!1}});else{this.id=i.observable(e.get("id")),this.isEdit=i.observable(!0),this.isActive=i.observable(e.get("isActive")),this.centreId=i.observable(e.get("centreId")),this.busId=i.observable(e.get("busId")),this.driverId=i.observable(e.get("drvierId")),this.visitTypeId=i.observable(e.get("visitTypeId")),this.bookingId=i.observable(e.get("bookingId")),this.inchargeName=i.observable(e.get("inchargeName")),this.visitDate=i.observable(e.get("visitDate")),this.outTime=i.observable(e.get("outTime")),this.returnTime=i.observable(e.get("returnTime")),this.returnDate=i.observable(e.get("returnDate")),this.readingWhenFilling=i.observable(e.get("readingWhenFilling")),e.get("pumpLocation")!=undefined&&e.get("pumpLocation").trim()==""?this.pumpLocation=i.observable():this.pumpLocation=i.observable(e.get("pumpLocation")),e.get("fuelRate")!=undefined&&e.get("fuelRate")=="0"?this.fuelRate=i.observable():this.fuelRate=i.observable(e.get("fuelRate")),e.get("fuelAmount")!=undefined&&e.get("fuelAmount")=="0"?this.fuelAmount=i.observable():this.fuelAmount=i.observable(e.get("fuelAmount")),e.get("fuelQuantity")!=undefined&&e.get("fuelQuantity")=="0"?this.fuelQuantity=i.observable():this.fuelQuantity=i.observable(e.get("fuelQuantity")),e.get("fuelingReceipt")!=undefined&&e.get("fuelingReceipt")==""?this.fuelingReceipt=i.observable():this.fuelingReceipt=i.observable(e.get("fuelingReceipt"));var o=e.get("isBookingCompleted")==1?"1":"0";this.isBookingCompleted=i.observable(o),this.description=i.observable(e.get("description")),this.initialReading=i.observable(e.get("initialReading")),this.finalReading=i.observable(e.get("finalReading")),this.busDesc=i.observable(e.get("busDesc")),this.centreDesc=i.observable(e.get("centreDesc")),this.driverDesc=i.observable(e.get("driverDesc")),this.visitTypeDesc=i.observable(e.get("visitTypeDesc"));var u=r.filter(s.timeSlot,function(t){return t.id==e.get("outTime")}),a=r.filter(s.timeSlot,function(t){return t.id==e.get("returnTime")}),f=r.filter(s.bus,function(t){return t.id==e.get("busId")}),l=r.filter(s.driver,function(t){return t.id==e.get("driverId")}),c=r.filter(s.alkhidmatCentre,function(t){return t.id==e.get("centreId")}),h=r.filter(s.visitType,function(t){return t.id==e.get("visitTypeId")});this.outTimeSlotSelected=i.observable(u[0]),this.returnTimeSlotSelected=i.observable(a[0]),this.busSelected=i.observable(f[0]),this.driverSelected=i.observable(l[0]),this.alkhidmatCentreSelected=i.observable(c[0]),this.visitTypeSelected=i.observable(h[0]),this.isPatrolPump=i.computed({owner:this,read:function(){return t.visitTypeSelected()!=undefined&&n.VisitTypes[t.visitTypeSelected().id]==n.VisitTypes[1]?!0:!1}}),this.isMaintenance=i.computed({owner:this,read:function(){return t.visitTypeSelected()!=undefined&&n.VisitTypes[t.visitTypeSelected().id]==n.VisitTypes[3]?!0:!1}}),this.isBooking=i.computed({owner:this,read:function(){return t.visitTypeSelected()!=undefined&&n.VisitTypes[t.visitTypeSelected().id]==n.VisitTypes[2]?!0:!1}})}this.isValidReading=i.computed({owner:this,read:function(){return t.finalReading()!=undefined&&t.finalReading()==0?!0:t.initialReading()!=undefined&&t.finalReading()!=undefined?parseInt(t.initialReading())>parseInt(t.finalReading())?!1:!0:!0}})}return e}();t.ViewModel=h});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Dtos/BusVisitDto",["require","exports","jquery","backbone"],function(e,t){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{idAttribute:"busVisitId",id:"",centreId:"",busId:"",driverId:"",visitTypeId:"",bookingId:"",inchargeName:"",visitDate:"",outTime:"",returnTime:"",readingWhenFilling:"",pumpLocation:"",fuelRate:"",fuelAmount:"",fuelQuantity:"",fuelingReceipt:"",isBookingCompleted:"",description:"",busChangeReason:"",initialReading:"",finalReading:"",isActive:"",busDesc:"",centreDesc:"",driverDesc:"",visitTypeDesc:"",createdBy:"",createdDate:"",modifiedBy:"",modifiedDate:""}},t}(Backbone.Model);e.BusVisitDto=t;var n=function(e){function n(n){this.model=t,e.call(this,n)}return __extends(n,e),n}(Backbone.Collection);e.BusVisitCollection=n;var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{busId:"",busDesc:"",driverDesc:"",centreDesc:"",milage:"",visitCount:"",vehicleNo:"",visitDate:"",visitInterval:"",bookingId:"",isActive:"",createdBy:"",createdDate:"",modifiedBy:"",modifiedDate:""}},t}(Backbone.Model);e.BusVisitSummaryDto=r;var i=function(e){function t(t){this.model=r,e.call(this,t)}return __extends(t,e),t}(Backbone.Collection);e.BusVisitSummaryCollection=i;var s=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{id:"",bookingId:"",propertyName:"",oldValue:"",newValue:"",modifiedDate:"",createdDate:"",actualModifiedDate:"",userName:""}},t}(Backbone.Model);e.AuditBusVisit=s;var o=function(e){function t(t){this.model=s,e.call(this,t)}return __extends(t,e),t}(Backbone.Collection);e.AuditBusVisitResponseCollection=o})(t.Models||(t.Models={}));var n=t.Models});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/DAL/BusVisit",["require","exports","CCTracking.WebClient/DAL/AjaxRequest","CCTracking.WebClient/Dtos/BusVisitDto","jquery"],function(e,t,n,r){function o(){var e=new s;return e.doAjaxRequest(null,"GET","BusVisit")}function u(e){var t=new s;return t.doAjaxRequest(e,"POST","BusVisit")}function a(e){var t=new s;return t.doAjaxRequest(null,"GET","BusVisit?idAll="+e)}function f(e){var t=new s;return t.doAjaxRequest(null,"GET","BusVisit?id="+e)}function l(){var e=new s;return e.doAjaxRequest(null,"GET","BusVisitSummary")}function c(e){var t=new s;return t.doAjaxRequest(null,"GET","BusVisitSummary?id="+e)}function h(){var e=new s;return e.doAjaxRequest(null,"GET","BusVisitMilageSummary")}function p(e){var t=new s;return t.doAjaxRequest(null,"GET","BusVisitMilageSummary?id="+e)}function d(e){var t=new s;return t.doAjaxRequest(e,"POST","AuditBusVisit")}var i=e("jquery"),s=function(e){function t(){e.call(this,this)}return __extends(t,e),t.prototype.getResponse=function(){return new r.Models.BusVisitDto},t}(n.BaseDto);t.BusVisitDal=s,t.Load=o,t.Save=u,t.GetAll=a,t.GetById=f,t.GetAllSummary=l,t.GetAllDetail=c,t.GetAllMilageSummary=h,t.GetAllMilageDetail=p,t.GetAllAuditBusVisit=d});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Bus/BusVisit/BusVisitCtrl",["require","exports","../../App","../../Helper","./BusVisitView","../../DAL/BusVisit","marionette","jquery","knockout"],function(e,t,n,r,i,s){var o=e("underscore"),u=e("knockout"),a=e("knockback"),f=function(e){function t(){e.call(this),this.app=n.Application.getInstance(),this.currentLayout=new i.SearchBusVisitLayoutView,this.searchView=new i.BusVisitSearchItemView,this.compositeModel=new Backbone.Model}return __extends(t,e),t.prototype.Load=function(){var e=this;this.view=new i.BusVisitView,this.view.on("Event:SaveForm",function(t){return e.Save(t)}),this.view.on("Event:CancelForm",function(){return e.Cancel()}),this.app.MainRegion.show(this.view)},t.prototype.EditForm=function(e){var t=this,n=s.GetById(e);n.done(function(e){return t.GetByIdCompleted(e)})},t.prototype.SimpleLoad=function(){var e=this,t=JSON.parse(localStorage.getItem("lookupResponse"));this.compositeModel.set("busList",t.bus),this.compositeModel.set("busSelected",""),this.app.MainRegion.show(this.currentLayout),this.searchView.model=this.compositeModel,this.searchView.on("Event:SearchVisit",function(t){e.SearchVisit(t)}),this.currentLayout.SearchRegion.show(this.searchView);var n=a.viewModel(this.compositeModel),r=$("#ddlBuses")[0];u.cleanNode(r),u.applyBindings(n,r)},t.prototype.SearchVisit=function(e){var t=this,n=s.GetAll(e);n.done(function(e){return t.GetAllCompleted(e)})},t.prototype.GetAllCompleted=function(e){var t=this,n=o.map(e.busVisitList,function(e){return e.visitDate=r.FormatDateTimeString(e.visitDate),e.returnDate!=undefined&&(e.returnDate=r.FormatDateTimeString(e.returnDate)),e});this.collection=new Backbone.Collection(n),this.collectionView=new i.BusVisitCollectionView({collection:this.collection}),this.collectionView.on("itemview:Event:EditForm",function(e,n){return t.EditForm(n)}),this.currentLayout.ContentRegion.show(this.collectionView)},t.prototype.GetByIdCompleted=function(e){var t=this,n=new Backbone.Model(e.busVisitModel);n.get("visitDate")!=null&&n.get("visitDate").trim()!=""&&n.set("visitDate",r.FormatDateString(n.get("visitDate"))),n.get("returnDate")!=null&&n.get("returnDate").trim()!=""&&n.set("returnDate",r.FormatDateString(n.get("returnDate"))),this.view=new i.BusVisitView(n),this.view.on("Event:SaveForm",function(e){return t.Save(e)}),this.view.on("Event:CancelForm",function(){return t.Cancel()}),this.app.MainRegion.show(this.view)},t.prototype.Save=function(e){var t=this,n=this.app.request("AppGlobalSetting");e.set("modifiedBy",n.get("Id")),e.set("isBookingCompleted",e.get("isBookingCompleted")=="1"?!0:!1);var r=s.Save(e);r.done(function(e){return t.SaveCompleted(e)})},t.prototype.Cancel=function(){window.location.href="#viewBusVisit"},t.prototype.SaveCompleted=function(e){e==undefined?r.ShowModalPopup("danger","Bus Visit","Bus visit have not been saved successfully!"):(r.ShowModalPopup("success","Bus Visit","Record has been saved successfully with Bus Visit ID : "+e.id),this.Cancel())},t}(r.Controller);t.BusVisitCtrl=f}),define("text!CCTracking.WebClient/Search/SearchTmpl.html",[],function(){return'<div>\r\n    <div id="SearchFromLayout">\r\n        <div class="rgnSearch"></div>\r\n        <div class="rgnContent"></div>\r\n    </div>\r\n\r\n\r\n    <div id="gridTemplate">\r\n\r\n        <!--<div id="gridTemplate1">-->\r\n        <div class="panel panel-default">\r\n            <div class="panel-heading header-bold">\r\n                <span class="glyphicon glyphicon-time"></span>View - Search Details\r\n                <!--<span class="pull-right"><a href="#addBooking">Add New</a> </span>-->\r\n            </div>\r\n            <div class="panel-body">\r\n                <table id="tblSearch" class="table table-condensed table-bordered table-hover table-striped">\r\n                    <thead>\r\n                        <tr class="active">\r\n                            <th class="input-sm">Contat Name</th>\r\n                            <th class="input-sm">Contact Mobile</th>\r\n                            <!--<th class="input-sm">Contact Nic</th>-->\r\n                            <th class="input-sm">Deceased Name</th>\r\n                            <th class="input-sm">Pickup Date</th>\r\n                            <th class="input-sm">Status</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody></tbody>\r\n                    <tfoot>\r\n                        <tr class="active">\r\n                            <td colspan="5">&nbsp;</td>\r\n                        </tr>\r\n                    </tfoot>\r\n                </table>\r\n            </div>\r\n        </div>\r\n        <!--</div>-->\r\n\r\n\r\n    </div>\r\n\r\n    <div id="searchForm">\r\n        <div class="panel panel-default">\r\n            <div class="panel-heading header-bold"><span class="glyphicon glyphicon-time"></span>SEARCH FORM</div>\r\n            <div class="panel-body">\r\n                <form id="form1">\r\n                    <table class="table table-condensed table-hover form-group">\r\n                        <tr>\r\n                            <td class="col-sm-6 col-md-6">\r\n                                <input type="text" id="txtContactInfo" class="form-control input-sm" placeholder="Contact Info: Name, Mobile or Nic" data-bind="value: contactInfo" />\r\n                            </td>\r\n                            <td class="col-sm-6 col-md-6">\r\n                                <input type="text" id="txtDeseasedInfo" class="form-control input-sm" placeholder="Deseased Info: Name or Address" data-bind="value: deseasedInfo" />\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-6 col-md-6">\r\n                                <input type="radio" class="jsGender" name="rbGender" value="1" data-bind="checked: genderId" />Male\r\n                                <input type="radio" class="jsGender" name="rbGender" value="2" data-bind="checked: genderId" />Female\r\n                            </td>\r\n                            <td class="col-sm-6 col-md-6">\r\n                                <input name="rbStatus" class="jsPaymentStatus" type="radio" title="Paid" value="1" data-bind="checked: paymentStatusId" />Paid\r\n                                <input name="rbStatus" class="jsPaymentStatus" type="radio" title="UnPaid" value="0" data-bind="checked: paymentStatusId" />UnpPaid \r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-6 col-md-6">\r\n                                <input type="text" id="txtBookingDate" class="form-control input-sm" data-bind="datepicker: {}, value: bookingDate" />\r\n                            </td>\r\n                            <td class="col-sm-6 col-md-6">\r\n                                <select id="ddlGraveyard" class="form-control input-sm"\r\n                                    data-bind="options: graveyardList, optionsText: \'description\', value: graveyardIdSelected, optionsCaption: \'Please Select Graveyard\'">\r\n                                </select>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-6 col-md-6">\r\n                                <select id="ddlCentre" class="form-control input-sm"\r\n                                    data-bind="options: alkhidmatCentreList, optionsText: \'description\', value: alkhidmatCentreSelected, optionsCaption: \'Please Select Centre\'">\r\n                                </select>\r\n                            </td>\r\n                            <td class="col-sm-6 col-md-6">\r\n                                <select id="ddlBusDetails" class="form-control input-sm"\r\n                                    data-bind="options: busList, optionsText: \'description\', value: busSelected, optionsCaption: \'Please Select Bus\'">\r\n                                </select>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-6 col-md-6">&nbsp;\r\n                            </td>\r\n                            <td class="col-sm-6 col-md-6 ">\r\n                                <span class="pull-right">\r\n                                    <button type="button" class="jsSearch btn btn-default">Search</button>&nbsp;&nbsp;\r\n                                    <button type="reset" class="jsCancel btn btn-default" title="Cancel">Cancel</button>\r\n                                </span>\r\n                            </td>\r\n                        </tr>\r\n                    </table>\r\n                </form>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <script type="text/html" id="rowTemplate">\r\n        <!--<td class="jsShowDetail input-sm"><a href="#editBooking?id=<%=id%>"><%=contactName %></a></td>-->\r\n        <td class="jsShowDetail input-sm edit-action"><%=contactName%></td>\r\n        <td class="input-sm"><%=contactMobile%></td>\r\n        \r\n        <td class="input-sm"><%=deseasedName%></td>\r\n        <td class="input-sm"><%=pickupDate%></td>\r\n        <td class="input-sm"><%=status%></td>\r\n    </script>\r\n\r\n</div>\r\n'});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Search/SearchView",["require","exports","../Helper","marionette","jquery","jqueryUI","knockout","text!./SearchTmpl.html"],function(e,t,n){var r=e("underscore"),i=e("text!./SearchTmpl.html"),s=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t}(n.ViewModel);t.SearchViewModel=s;var o=function(e){function t(t){t.itemView=u,t.template=i.getOuterHTML("#gridTemplate"),t.itemViewContainer="#tblSearch tbody",e.call(this,t)}return __extends(t,e),t.prototype.onShow=function(){this.dataTable=this.$el.find("#tblSearch").dataTable({autoWidth:!1,info:!0,processing:!0,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],language:{paginate:{next:"Next",previous:"Prev"},emptyTable:"",infoEmpty:"",zeroRecords:"No record found!"},pageLength:n.GetPageSize()})},t}(n.Views.CompositeView);t.SearchCollectionView=o;var u=function(t){function n(e){e||(e={}),e.template=i.getOuterHTML("#rowTemplate"),e.tagName="tr",e.className="jsRowClick",e.events={"click .jsShowDetail":"ShowDetail"},t.call(this,e)}return __extends(n,t),n.prototype.ShowDetail=function(){var t=this;window.location.href="#editBooking",e(["../Booking/BookingCtrl"],function(e){(new e.BookingCtrl).EditBooking(t.model.get("id"))})},n}(n.Views.ItemView);t.SearchItemView=u;var a=function(e){function t(t){this.template=i.getOuterHTML("#SearchFromLayout"),this.regions={SearchRegion:{selector:".rgnSearch"},ContentRegion:{selector:".rgnContent"}},e.call(this,t)}return __extends(t,e),t}(Marionette.Layout);t.SearchFormLayoutView=a;var f=function(e){function t(t){this.template=i.getOuterHTML("#searchForm"),this.events={"click .jsSearch":"Search","click .jsCancel":"Cancel"},e.call(this,t)}return __extends(t,e),t.prototype.Search=function(e){e.preventDefault(),this.trigger("SearchBooking")},t.prototype.Cancel=function(e){e.preventDefault(),this.trigger("CancelForm")},t}(n.Views.ItemView);t.SearchFormItemView=f});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Dtos/SearchDto",["require","exports","jquery","backbone"],function(e,t){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{id:"",name:"",landmarkId:"",address:"",contactNo1:"",contactNo2:"",isCoPartner:"",contactInfo:"",deseasedInfo:"",genderId:"",paymentStatusId:"",bookingDate:"",greveyardId:"",centreId:"",busId:"",isActive:"",createdBy:"",createdDate:"",modifiedBy:"",modifiedDate:""}},t}(Backbone.Model);e.SearchDto=t;var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{id:"",contactName:"",contactMobile:"",contactNic:"",deseasedName:"",deseasedAge:"",status:"",pickupDate:""}},t}(Backbone.Model);e.SearchDtoResponse=n;var r=function(e){function n(n){this.model=t,e.call(this,n)}return __extends(n,e),n}(Backbone.Collection);e.SearchCollection=r;var i=function(e){function t(t){this.model=n,e.call(this,t)}return __extends(t,e),t}(Backbone.Collection);e.SearchDtoResponseCollection=i})(t.Models||(t.Models={}));var n=t.Models});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/DAL/Search",["require","exports","CCTracking.WebClient/DAL/AjaxRequest","CCTracking.WebClient/Dtos/SearchDto","jquery"],function(e,t,n,r){function o(){var e=new s;return e.doAjaxRequest(null,"GET","Search")}function u(e){var t=new s;return t.doAjaxRequest(e,"POST","Search")}function a(){var e=new s;return e.doAjaxRequest(null,"GET","Search?a=a")}function f(e){var t=new s;return t.doAjaxRequest(null,"GET","Search?id="+e)}function l(e){var t=new s;return t.doAjaxRequest(e,"POST","Search")}var i=e("jquery"),s=function(e){function t(){e.call(this,this)}return __extends(t,e),t.prototype.getResponse=function(){return new r.Models.SearchDto},t}(n.BaseDto);t.SearchDal=s,t.Load=o,t.Save=u,t.GetAll=a,t.GetById=f,t.GetByCriteria=l});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Search/SearchCtrl",["require","exports","../App","../Helper","./SearchView","CCTracking.WebClient/Dtos/SearchDto","../DAL/Search","marionette","jquery","knockout","text!./SearchTmpl.html"],function(e,t,n,r,i,s,o){var u=e("underscore"),a=e("knockout"),f=e("knockback"),l=function(e){function t(){e.call(this),this.app=n.Application.getInstance(),this.searchFromLayout=new i.SearchFormLayoutView,this.searchModel=new s.Models.SearchDto,this.searchFormView=new i.SearchFormItemView,this.searchViewModel=new i.SearchViewModel(this.backboneModel,this)}return __extends(t,e),t.prototype.Show=function(){this.Load()},t.prototype.Load=function(){var e=this,t=JSON.parse(localStorage.getItem("lookupResponse")),n=this.searchModel;n.set("graveyardList",t.graveyard),n.set("graveyardIdSelected",""),n.set("alkhidmatCentreList",t.alkhidmatCentre),n.set("alkhidmatCentreSelected",""),n.set("busList",t.bus),n.set("busSelected",""),n.set("genderId",""),n.set("contactInfo",""),n.set("deseasedInfo",""),n.set("paymentStatusId",""),n.set("bookingDate",""),this.searchFormView.listenTo(this.searchFormView,"SearchBooking",function(){return e.GetByCriteria(n)}),this.searchFormView.on("CancelForm",function(){return e.Cancel()}),this.app.MainRegion.show(this.searchFromLayout),this.searchFromLayout.SearchRegion.show(this.searchFormView),this.KOBinding(n)},t.prototype.GetByCriteria=function(e){var t=this;e.set("genderId",e.get("genderId").toString()),e.set("paymentStatusId",e.get("paymentStatusId").toString()),e.get("bookingDate").trim()!=""&&e.set("bookingDate",r.FormatDateString(e.get("bookingDate"))),e.get("graveyardIdSelected")!=undefined&&e.set("greveyardId",e.get("graveyardIdSelected").id),e.get("alkhidmatCentreSelected")!=undefined&&e.set("centreId",e.get("alkhidmatCentreSelected").id),e.get("busSelected")!=undefined&&e.set("busId",e.get("busSelected").id);var n=o.GetByCriteria(this.GetMinimalRequest(e));n.done(function(e){return t.GetByCriteriaCompleted(e)})},t.prototype.GetMinimalRequest=function(e){var t=new s.Models.SearchDto;return t.set("bookingDate",e.get("bookingDate")),t.set("busId",e.get("busId")),t.set("centreId",e.get("centreId")),t.set("contactInfo",e.get("contactInfo")),t.set("deseasedInfo",e.get("deseasedInfo")),t.set("genderId",e.get("genderId")),t.set("greveyardId",e.get("greveyardId")),t.set("paymentStatusId",e.get("paymentStatusId")),t},t.prototype.GetByCriteriaCompleted=function(e){var t=u.map(e.bookingList,function(e){return e.pickupDate!="0001-01-01T00:00:00"?e.pickupDate=r.FormatDateString(e.pickupDate):e.pickupDate="",e.status?e.status="Paid":e.status="Unpaid",e}),n=new Backbone.Collection(t),s=new i.SearchCollectionView({collection:n});this.searchFromLayout.ContentRegion.show(s)},t.prototype.KOBinding=function(e){var t=f.viewModel(e),n=this.searchFormView.$el,r=n.find("#ddlGraveyard")[0];a.cleanNode(r),a.applyBindings(t,r);var i=n.find("#ddlCentre")[0];a.cleanNode(i),a.applyBindings(t,i);var s=n.find("#ddlBusDetails")[0];a.cleanNode(s),a.applyBindings(t,s);var o=n.find("#txtContactInfo")[0];a.cleanNode(o),a.applyBindings(t,o);var u=n.find("#txtDeseasedInfo")[0];a.cleanNode(u),a.applyBindings(t,u);var l=n.find(".jsGender")[0];a.cleanNode(l),a.applyBindings(t,l),l=n.find(".jsGender")[1],a.cleanNode(l),a.applyBindings(t,l);var c=n.find(".jsPaymentStatus")[0];a.cleanNode(c),a.applyBindings(t,c),c=n.find(".jsPaymentStatus")[1],a.cleanNode(c),a.applyBindings(t,c);var h=n.find("#txtBookingDate")[0];a.cleanNode(h),a.applyBindings(t,h)},t.prototype.Cancel=function(){var e=this.searchModel;e.set("graveyardIdSelected",""),e.set("alkhidmatCentreSelected",""),e.set("busSelected",""),e.set("genderId",""),e.set("contactInfo",""),e.set("deseasedInfo",""),e.set("paymentStatusId",""),e.set("bookingDate","")},t}(r.Controller);t.SearchCtrl=l}),define("text!CCTracking.WebClient/Payment/PaymentTmpl.html",[],function(){return'<div>\r\n    <div data-bind="attr: {class: currentDisplay}">\r\n        <div class="panel-heading header-bold"><i class="fa fa-briefcase">&nbsp;</i> PAYMENT & BUS DETAILS\r\n            <div class="pull-right">\r\n                Booking ID - <span data-bind="text: bookingId"></span>\r\n             </div>\r\n        </div>\r\n        \r\n        <div class="panel-body">\r\n            <form id="form1" >\r\n                <div data-bind="attr: {class: currentDisplay}">\r\n                    <div class="panel-heading header-bold">\r\n                        BUS INFO \r\n                        <span class="input-sm"><a href="#viewBooking" class="pull-right input-sm"><i class="glyphicon glyphicon-time"></i>Booking</a> </span>\r\n                    </div>\r\n\r\n                    <div class="panel-body">\r\n                        <table class="table table-removeTopBorder table-condensed table-hover form-group">\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Alkhidmat/Co-Partners</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <select id="ddlCentre" class="form-control input-sm"\r\n                                        data-bind="options: alkhidmatCentreList, optionsText:\'description\', value:alkhidmatCentreSelected">\r\n                                    </select></td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Driver</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <select id="Select1" class="form-control input-sm"\r\n                                        data-bind="options: driverList, optionsText:\'description\', value:driverSelected">\r\n                                    </select></td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Vehicle No</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <select id="ddlBusDetails" class="form-control input-sm"\r\n                                            data-bind="options: busList, optionsText:\'description\', value:busSelected, optionsAfterRender:setOptionDisable">\r\n                                    </select>\r\n                                </td>\r\n                            </tr>\r\n                            \r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Booking Amount</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input id="txtAmount" type="text" maxlength="10" class="form-control input-sm" data-bind="value: fuelAmount, numeric: 1, valueUpdate: \'afterkeydown\', event: { blur: FormatMoneyValue(fuelAmount) }" \r\n                                     data-role="validate" title="Amount" data-content="Amount is required" />\r\n                                </td>\r\n                            </tr>\r\n\r\n                            <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Reason for Bus Change</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input id="Text2" type="text"  maxlength="500" class="form-control input-sm" data-bind="value: busChangeReason" />\r\n                                <a href="javascript:void(0);" id="lnkUpdate" class="jsUpdateMore pull-right input-sm" title="Update More Items" ><i class="fa fa-edit"></i>Update</a>\r\n                                <a href="javascript:void(0);" id="lnkAdd" class="jsAddMore pull-right input-sm" title="Add More Items" ><i class="glyphicon glyphicon-plus"></i>Add</a>\r\n                            </td>\r\n                        </tr>\r\n                            <tr>\r\n                                <td colspan="2">\r\n                                    <div id="SubRegion"></div>\r\n                                </td>\r\n                            </tr>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n\r\n                <div data-bind="attr: {class: currentDisplay}">\r\n                    <div class="panel-heading header-bold">PAYMENT INFO</div>\r\n                    <div class="panel-body">\r\n                        <table class="table table-removeTopBorder table-condensed table-hover form-group">\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Payment Type</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <select id="ddlPaymentType" class="form-control input-sm"\r\n                                         data-bind="options: paymentTypeList, optionsText:\'description\', value:paymentTypeSelected, disable:isPaid">                                        \r\n                                    </select></td>\r\n                            </tr>\r\n\r\n                            <!--<tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Pricing</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="radio" name="rbPricing" id="rbPricingFixed" />Fixed\r\n                                <input type="radio" name="rbPricing" id="rbPricingCalculated" />Calculated </td>\r\n                            </tr>-->\r\n                            \r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Amount</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input id="txtAmount" type="text" maxlength="10" class="form-control input-sm" data-bind="value: amount, numeric: 1, valueUpdate: \'afterkeydown\'" disabled/></td>\r\n                        </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Office/Payment Location</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <select id="ddlOfficeLocation" class="form-control input-sm"\r\n                                        data-bind="options: paymentLocationList, optionsText:\'description\', value: paymentLocationSelected, disable:isPaid">\r\n                                    </select></td>\r\n                            </tr>\r\n\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Officer/Cashier</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <select id="ddlOfficerName" class="form-control input-sm"\r\n                                        data-bind="options: cashierList, optionsText:\'description\', value:cashierSelected, disable:isPaid">\r\n                                    </select>\r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Receipt</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" id="txtReceipt" maxlength="50" class="form-control input-sm" data-bind="value:receiptNo, disable:isPaid,numeric: 1, valueUpdate: \'afterkeydown\'" \r\n                                        required="required" data-role="validate" title="Receipt" data-content="Receipt is required" />\r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">EasyPaisa Transaction No.</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" id="txtEasyPaisaTranNo" maxlength="30" class="form-control input-sm" data-bind="value:easyPaisaTranNo, enable:isEasyPaisa" />\r\n                                    <!--<span data-bind="text:isPaid"></span> -->\r\n                                </td>\r\n                            </tr>\r\n\r\n                        <!--    <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Extra Chareges</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" id="txtExtraAmount" class="form-control input-sm" data-bind="value: extraAmountCharge,numeric: 1, valueUpdate: \'afterkeydown\'"/></td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Reason for Extra Charges</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" id="txtReasonExtraAmount" class="form-control input-sm"  data-bind="value: extraAmountReason"/>\r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Receipt for Extra Charges</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" id="txtExtraAmountReceipt" class="form-control input-sm" data-bind="value: extraAmountReceipt,numeric: 1, valueUpdate: \'afterkeydown\'"/></td>\r\n                            </tr>-->\r\n                              <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Is Referral Booking Paid</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="radio" name="rbIsReferralBoking" value="1" data-bind="checked: isReferralBookingPaid,enable:isReferral" />Yes\r\n                                    &nbsp;\r\n                                    <input type="radio" name="rbIsReferralBoking" value="0" data-bind="checked: isReferralBookingPaid,enable:isReferral" />No \r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Referral Booking Payment Date</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="text" id="PickupDate" placeholder="mm/dd/yyyy" class="form-control input-sm" data-bind="datepicker: {}, value: referralPaymentDate,enable:isReferral"\r\n                                        data-role="validate" title="Pick-up Date"  />\r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Payment Status</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <span data-bind="text:paymentStatusDesc"></span>\r\n                                    <!--<span data-bind="visible:isPaid">Paid</span>\r\n                                    <span data-bind="visible:!isPaid()">Unpaid</span>-->\r\n                                    \r\n                                    <!--<input type="radio" id="rbPaymentStatus" name="rbPaymentStatus" value="1"  data-bind="checked: paymentStatus" />Paid\r\n                                        <input type="radio" id="Radio1" name="rbPaymentStatus" value="0"  data-bind="checked: paymentStatus" />UnPaid-->\r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4"></td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <button type="submit" class="btn btn-default" data-bind="disable:isCancel()">Save</button>\r\n                                    &nbsp;\r\n                        <button type="button" class="jsCancel btn btn-default" data-bind="disable:isCancel()">Cancel</button>\r\n                                </td>\r\n                            </tr>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("text!CCTracking.WebClient/Payment/PaymentGrid.html",[],function(){return'<div>\r\n    <div id="gridTemplate">\r\n        <!--<a href="javascript:void(0);" class="jsAddMore btn btn-sm btn-primary">Add More</a>-->\r\n        <table class="table table-condensed table-bordered  table-hover table-striped form-group">\r\n            <thead>\r\n                <tr class="active">\r\n                    <th class="input-sm">Centre</th>\r\n                    <th class="input-sm">Vehicle No</th>\r\n                    <th class="input-sm">Driver</th>\r\n                    <th class="input-sm">Amount</th>\r\n                    <th class="input-sm">Action</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n</div>\r\n\r\n<div>\r\n    <script type="text/html" id="rowTemplate">\r\n        <td class="input-sm"><%=centreDesc%></td>\r\n        <td class="input-sm"><%=busDesc%></td>\r\n        <td class="input-sm"><%=driverDesc%></td>\r\n        <td class="input-sm"><%=fuelAmount%></td>\r\n        <td class="input-sm">\r\n            <a href="javascript:void(0);" class="jsRemoveItem" ><i class="glyphicon glyphicon-remove" title="Remove Item">&nbsp;</i></a>\r\n            <a href="javascript:void(0);" class="jsUpdateItem" ><i class="fa fa-edit" title="Update Item">&nbsp;</i></a>\r\n\r\n        </td>\r\n    </script>\r\n</div>\r\n'});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Payment/PaymentView",["require","exports","../Helper","../App","marionette","jquery","knockout","text!./PaymentTmpl.html","text!./PaymentGrid.html"],function(e,t,n,r){var i=e("underscore"),s=e("knockout"),o=e("text!./PaymentTmpl.html"),u=e("text!./PaymentGrid.html"),a,f=function(e){function t(t,n){var r=this;e.call(this,t,n),this.model.paymentTypeSelected.subscribe(function(){r.model.paymentTypeSelected().id==1?r.model.isCash=!0:r.model.isCash=!1})}return __extends(t,e),t}(n.ViewModel);t.PaymentViewModel=f;var l=function(e){function t(t,n){a=r.Application.getInstance(),this.template=o,this.viewModel=new c(t,n),this.bbModel=new Backbone.Model,this.events={submit:"Save","click .jsCancel":"Cancel","click .jsAddMore":"AddMore","click .jsUpdateMore":"UpdateMore"},e.call(this,n)}return __extends(t,e),t.prototype.Cancel=function(){window.location.href="#viewBooking"},t.prototype.AddMore=function(){this.trigger("BusVisitAddItem",this.viewModel.bookingId(),this.viewModel.alkhidmatCentreSelected(),this.viewModel.driverSelected(),this.viewModel.busSelected(),this.viewModel.fuelAmount())},t.prototype.UpdateMore=function(){this.trigger("BusVisitUpdateItem",this.viewModel.bookingId(),this.viewModel.alkhidmatCentreSelected(),this.viewModel.driverSelected(),this.viewModel.busSelected(),this.viewModel.fuelAmount(),this.viewModel.busChangeReason())},t.prototype.Save=function(e){e.preventDefault(),this.bbModel.set("id",this.viewModel.Id()),this.bbModel.set("bookingId",this.viewModel.bookingId()),this.bbModel.set("paymentType",this.viewModel.paymentType()),this.bbModel.set("pricing",this.viewModel.pricing()),this.bbModel.set("amount",this.viewModel.amount()),this.bbModel.set("paymentLocation",this.viewModel.paymentLocation()),this.bbModel.set("officerId",this.viewModel.officerId()),this.bbModel.set("receiptNo",this.viewModel.receiptNo()),this.bbModel.set("extraAmountCharge",this.viewModel.extraAmountCharge()),this.bbModel.set("extraAmountReason",this.viewModel.extraAmountReason()),this.bbModel.set("extraAmountReceipt",this.viewModel.extraAmountReceipt()),this.bbModel.set("isReferralBooking",this.viewModel.isReferralBooking()=="1"?!0:!1),this.bbModel.set("isReferralBookingPaid",this.viewModel.isReferralBookingPaid()=="1"?!0:!1),this.bbModel.set("referralPaymentDate",this.viewModel.referralPaymentDate()),this.bbModel.set("easyPaisaTranNo",this.viewModel.easyPaisaTranNo()),this.bbModel.set("paymentLocation",this.viewModel.paymentLocationSelected().id),this.bbModel.set("officerId",this.viewModel.cashierSelected().id),this.bbModel.set("paymentType",this.viewModel.paymentTypeSelected().id),this.bbModel.set("fuelAmount",this.viewModel.fuelAmount()),this.bbModel.set("busChangeReason",this.viewModel.busChangeReason()),this.trigger("PaymentSave",this.bbModel)},t.prototype.onShow=function(){s.applyBindings(this.viewModel,this.el),this.$el.find("#lnkUpdate").hide()},t.prototype.onClose=function(){a.vent.off("Event:UpdateSummary")},t}(n.Views.ItemView);t.PaymentView=l;var c=function(){function e(e,t){var r=this;if(t==undefined){this.Id=s.observable(),this.bookingId=s.observable(),this.paymentType=s.observable(),this.pricing=s.observable(),this.amount=s.observable(),this.paymentLocation=s.observable(),this.officerId=s.observable(),this.receiptNo=s.observable(),this.extraAmountCharge=s.observable(),this.extraAmountReason=s.observable(),this.extraAmountReceipt=s.observable(),this.isReferralBooking=s.observable(),this.isReferralBookingPaid=s.observable(),this.referralPaymentDate=s.observable(),this.paymentStatus=s.observable(),this.isReferral=s.computed({owner:this,read:function(){return r.isReferralBooking()==1&&r.paymentStatus()!=1?!0:!1}}),this.easyPaisaTranNo=s.observable();var o=JSON.parse(localStorage.getItem("lookupResponse"));this.busList=s.observableArray(e),this.fuelAmount=s.observable(),this.busChangeReason=s.observable(),this.busSelected=s.observable(),this.driverList=s.observableArray(o.driver),this.driverSelected=s.observable(),this.alkhidmatCentreList=s.observableArray(o.alkhidmatCentre),this.alkhidmatCentreSelected=s.observable(),this.paymentLocationList=s.observableArray(o.alkhidmatCentre),this.paymentLocationSelected=s.observable(),this.cashierList=s.observableArray(o.cashier),this.cashierSelected=s.observable(),this.paymentTypeList=s.observableArray(o.paymentType),this.paymentTypeSelected=s.observable(),this.currentDisplay=s.observable(),this.isEasyPaisa=s.computed({owner:this,read:function(){return r.paymentTypeSelected()!=undefined&&r.paymentTypeSelected().id===2&&r.easyPaisaTranNo().trim()==""?!0:!1}}),this.isPaid=s.computed({owner:this,read:function(){return r.paymentStatus()=="1"?!0:!1}}),this.isCancel=s.computed({owner:this,read:function(){return r.paymentStatus()=="2"?!0:!1}}),this.paymentStatusDesc=s.computed({owner:this,read:function(){return r.paymentStatus()=="1"?(r.currentDisplay("panel panel-default"),"Paid"):r.paymentStatus()=="2"?(r.currentDisplay("panel panel-danger"),"Cancel"):(r.currentDisplay("panel panel-warning"),"Unpaid")}})}else{this.Id=s.observable(t.get("id")),this.bookingId=s.observable(t.get("bookingId")),this.paymentType=s.observable(),this.pricing=s.observable(),this.amount=s.observable(n.FormatMoney(t.get("amount"))),this.paymentLocation=s.observable(),this.officerId=s.observable(),this.receiptNo=s.observable(t.get("receiptNo")),this.extraAmountCharge=s.observable(t.get("extraAmountCharge")),this.extraAmountReason=s.observable(t.get("extraAmountReason")),this.extraAmountReceipt=s.observable(t.get("extraAmountReceipt")),this.isReferralBooking=s.observable(t.get("isReferralBooking")?"1":"0"),this.isReferralBookingPaid=s.observable(t.get("isReferralBookingPaid")?"1":"0"),t.get("referralPaymentDate")!="0001-01-01T00:00:00"?this.referralPaymentDate=s.observable(n.FormatDateString(t.get("referralPaymentDate"))):this.referralPaymentDate=s.observable(""),this.paymentStatus=s.observable(t.get("paymentStatus")),this.isReferral=s.computed({owner:this,read:function(){return r.isReferralBooking()==1&&r.paymentStatus()!=1?!0:!1}}),this.easyPaisaTranNo=s.observable(t.get("easyPaisaTranNo"));var o=JSON.parse(localStorage.getItem("lookupResponse"));this.busList=s.observableArray(e),this.fuelAmount=s.observable(t.get("fuelAmoun")),this.busChangeReason=s.observable(t.get("busChangeReason")),this.busSelected=s.observable(),this.driverList=s.observableArray(o.driver),this.driverSelected=s.observable(),this.alkhidmatCentreList=s.observableArray(o.alkhidmatCentre),this.alkhidmatCentreSelected=s.observable(),this.paymentLocationList=s.observableArray(o.alkhidmatCentre);var u=i.filter(o.alkhidmatCentre,function(e){return e.id==t.get("paymentLocation")}),a=i.filter(o.paymentType,function(e){return e.id==t.get("paymentType")}),f=i.filter(o.cashier,function(e){return e.id==t.get("officerId")});this.paymentLocationSelected=s.observable(u[0]),this.cashierList=s.observableArray(o.cashier),this.cashierSelected=s.observable(f[0]),this.paymentTypeList=s.observableArray(o.paymentType),this.paymentTypeSelected=s.observable(a[0]),this.currentDisplay=s.observable(),this.isEasyPaisa=s.computed({owner:this,read:function(){return r.paymentTypeSelected()!=undefined&&r.paymentTypeSelected().id===2&&r.easyPaisaTranNo().trim()==""?!0:!1}}),this.isPaid=s.computed({owner:this,read:function(){return r.paymentStatus()=="1"?!0:!1}}),this.isCancel=s.computed({owner:this,read:function(){return r.paymentStatus()=="2"?!0:!1}}),this.paymentStatusDesc=s.computed({owner:this,read:function(){return r.paymentStatus()=="1"?(r.currentDisplay("panel panel-default"),"Paid"):r.paymentStatus()=="2"?(r.currentDisplay("panel panel-danger"),"Cancel"):(r.currentDisplay("panel panel-warning"),"Unpaid")}}),this.alkhidmatCentreSelected.subscribe(function(){var t=i.filter(e,function(e){return e.centreId==r.alkhidmatCentreSelected().id});r.busList(t)})}}return e.prototype.FormatMoneyValue=function(e){e()!=undefined&&e()!=""&&e(n.FormatMoney(e()))},e.prototype.setOptionDisable=function(e,t){var n=t.description;if(t.description.indexOf("Booked - Paid")>=0||t.description.indexOf("Booked - Unpaid")>=0)n=t.description,s.applyBindingsToNode(e,{disable:!0,text:n},t);t.isOnMaintainance&&(n=t.description+" - Maintenance",s.applyBindingsToNode(e,{disable:!0,text:n},t))},e}();t.ViewModel=c;var h=function(e){function t(t){a=r.Application.getInstance(),t.itemView=p,t.template=u.getOuterHTML("#gridTemplate"),t.itemViewContainer="tbody",e.call(this,t)}return __extends(t,e),t}(n.Views.CompositeView);t.BusVisitCollectionView=h;var p=function(e){function t(t){var n=this;t||(t={}),t.template=u.getOuterHTML("#rowTemplate"),t.tagName="tr",t.className="jsRowClick",t.events={"mouseover .jsShowDetail":"ShowDetail","click .jsShowDetail":"ShowDetail","click .jsRemoveItem":function(){return n.RemoveItem()},"click .jsUpdateItem":function(){return n.UpdateItem()}},e.call(this,t)}return __extends(t,e),t.prototype.RemoveItem=function(){this.trigger("BusVisitRemoveItem",this.model.get("busId"),this.model.get("centreId"),this.model.get("driverId"))},t.prototype.UpdateItem=function(){this.trigger("UpdateBusVisitItem",this.model)},t.prototype.ShowDetail=function(){},t}(n.Views.ItemView);t.BusVisitItemView=p});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Dtos/PaymentDto",["require","exports","jquery","backbone"],function(e,t){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{bookingId:"",paymentType:"",pricing:"",amount:"",paymentLocation:"",officerId:"",receiptNo:"",extraAmountCharge:"",extraAmountReason:"",extraAmountReceipt:"",paymentStatus:"",isReferralBooking:"",isReferralBookingPaid:"",referralPaymentDate:""}},t}(Backbone.Model);e.PaymentRequest=t;var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{bookingId:"",paymentType:"",pricing:"",amount:"",paymentLocation:"",officerId:"",receiptNo:"",extraAmountCharge:"",extraAmountReason:"",extraAmountReceipt:"",paymentStatus:"",easyPaisaTranNo:"",isReferralBooking:"",isReferralBookingPaid:"",referralPaymentDate:""}},t}(Backbone.Model);e.PaymentResponse=n;var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{id:"",bookingId:"",propertyName:"",oldValue:"",newValue:"",modifiedDate:"",createdDate:"",actualModifiedDate:"",userName:""}},t}(Backbone.Model);e.AuditPayment=r;var i=function(e){function t(t){this.model=n,e.call(this,t)}return __extends(t,e),t}(Backbone.Collection);e.PaymentResponseCollection=i;var s=function(e){function t(t){this.model=r,e.call(this,t)}return __extends(t,e),t}(Backbone.Collection);e.AuditPaymentResponseCollection=s})(t.Models||(t.Models={}));var n=t.Models});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/DAL/Payment",["require","exports","CCTracking.WebClient/DAL/AjaxRequest","CCTracking.WebClient/Dtos/PaymentDto","jquery"],function(e,t,n,r){function o(){var e=new s;return e.doAjaxRequest(null,"GET","Payment")}function u(e){var t=new s;return t.doAjaxRequest(e,"POST","Payment")}function a(){var e=new s;return e.doAjaxRequest(null,"GET","Payment?a=a")}function f(e){var t=new s;return t.doAjaxRequest(null,"GET","Payment?id="+e)}function l(e){var t=new s;return t.doAjaxRequest(null,"GET","BusAvailability?id="+e)}function c(e){var t=new s;return t.doAjaxRequest(e,"POST","AuditPayment")}var i=e("jquery"),s=function(e){function t(){e.call(this,this)}return __extends(t,e),t.prototype.getResponse=function(){return new r.Models.PaymentResponse},t}(n.BaseDto);t.PaymentDal=s,t.Load=o,t.Save=u,t.GetAll=a,t.GetById=f,t.GetBusAvialability=l,t.GetAllAuditPayment=c});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Payment/PaymentCtrl",["require","exports","../App","../Helper","./PaymentView","CCTracking.WebClient/Dtos/BusVisitDto","../DAL/Payment","marionette","jquery","knockout","text!./PaymentTmpl.html"],function(e,t,n,r,i,s,o){var u=e("underscore"),a=e("knockout"),f=e("knockback"),l,c=function(e){function t(){var t=this;l=n.Application.getInstance(),e.call(this),this.backboneCollection=new s.Models.BusVisitCollection,this.backboneCollection=this.busVisitCollection,this.busVisitCollectionView=new i.BusVisitCollectionView({collection:this.backboneCollection}),this.busVisitCollectionView.on("itemview:BusVisitRemoveItem",function(e,n,r,i){return t.RemoveBusVisitItem(n,r,i)}),this.busVisitCollectionView.on("itemview:UpdateBusVisitItem",function(e,n){t.UpdateBusVisitItem(n);var r=t.paymentView.viewModel.busList(),i=u.filter(r,function(e){return e.id==n.get("busId")});t.paymentView.viewModel.busSelected(i[0])}),this.idCounter=1}return __extends(t,e),t.prototype.EditPayment=function(e){var t=this,n=o.GetBusAvialability(e);n.done(function(n){t.FillBusAvailability(n,e)})},t.prototype.FillBusAvailability=function(e,t){var n=this,r=e.busAvailabilityList;if(t>0){var i=o.GetById(t);i.done(function(e){return n.GetByIdCompleted(e,r)})}else this.LoadCompleted(r)},t.prototype.GetByIdCompleted=function(e,t){var n=this,s=new Backbone.Model(e.paymentModel);s.set("bookingId",s.get("bookingId")),this.layout=l.AppLayout,this.paymentView=new i.PaymentView(t,s),this.paymentView.on("BusVisitAddItem",function(e,t,r,i,s){return n.AddBusVisitItem(e,t,r,i,s)}),this.paymentView.on("BusVisitUpdateItem",function(e,t,r,i,s,o){return n.ModifyBusVisitItem(e,t,r,i,s,o)}),this.paymentView.on("PaymentSave",function(e){return n.Save(e)});var o=u.map(s.get("busVisits"),function(e){return e.fuelAmount=r.FormatMoney(e.fuelAmount),e});this.backboneCollection=new Backbone.Collection(o),this.busVisitCollectionView=new i.BusVisitCollectionView({collection:this.backboneCollection}),this.busVisitCollectionView.on("itemview:BusVisitRemoveItem",function(e,t,r,i){return n.RemoveBusVisitItem(t,r,i)}),this.busVisitCollectionView.on("itemview:UpdateBusVisitItem",function(e,t){n.UpdateBusVisitItem(t);var r=n.paymentView.viewModel.busList(),i=u.filter(r,function(e){return e.id==t.get("busId")});n.paymentView.viewModel.busSelected(i[0])}),l.MainRegion.show(this.paymentView),l.SubRegion.reset(),l.SubRegion.show(this.busVisitCollectionView)},t.prototype.InitalizeKoBinding=function(e){e.set("amount",""),e.set("busChangeReason",""),e.set("receiptNo",""),e.set("easyPaisaTranNo",""),e.set("extraAmountCharge",""),e.set("extraAmountReason",""),e.set("extraAmountReceipt","")},t.prototype.LoadCompleted=function(e){var t=this;this.layout=l.AppLayout,this.paymentView=new i.PaymentView(e),this.paymentView.on("BusVisitAddItem",function(e,n,r,i,s){return t.AddBusVisitItem(e,n,r,i,s)}),this.paymentView.on("BusVisitUpdateItem",function(e,n,r,i,s,o){return t.ModifyBusVisitItem(e,n,r,i,s,o)}),this.paymentView.on("PaymentSave",function(e){return t.Save(e)}),l.MainRegion.show(this.paymentView),l.SubRegion.reset(),l.SubRegion.show(this.busVisitCollectionView)},t.prototype.AddBusVisitItem=function(e,t,n,i,o){if(i==undefined||i.length<=0){r.ShowModalPopup("danger","Bus Info","Please enter valid  vehicle no.!");return}if(o==""||o==undefined||o===0){r.ShowModalPopup("danger","Bus Info","Please enter valid amount!");return}var a=this.idCounter++,f=this.backboneCollection.findWhere({busId:i.id}),l=this.backboneCollection.findWhere({driverId:n.id});if(f==undefined&&l==undefined){this.backboneCollection.push(new s.Models.BusVisitDto({busVisitId:a,centreId:t.id,centreDesc:t.description,busId:i.id,busDesc:i.description,driverId:n.id,driverDesc:n.description,visitTypeId:"2",bookingId:e,fuelAmount:o.replace(",","")})),this.busVisitCollectionView.collection=this.backboneCollection;var c=u.reduce(this.backboneCollection.models,function(e,t){return e+parseFloat(t.get("fuelAmount").replace(",",""))},0);this.paymentView.viewModel.amount(r.FormatMoney(c))}else r.ShowModalPopup("danger","Bus Info","Entry already exists!")},t.prototype.ModifyBusVisitItem=function(e,t,n,i,s,o){if(i==undefined||i.length<=0){r.ShowModalPopup("danger","Bus Info","Please enter valid  vehicle no.!");return}if(s==""||s==undefined||s===0){r.ShowModalPopup("danger","Bus Info","Please enter valid amount!");return}if(o==""||o==undefined){r.ShowModalPopup("danger","Bus Info","Please enter reason for bus change!");return}var a=this.idCounter++,f=this.backboneCollection.findWhere({busId:i.id}),l=this.backboneCollection.findWhere({driverId:n.id});if(f!=undefined&&l!=undefined){var c=u.map(this.backboneCollection.models,function(r){return r.get("busId")==i.id&&r.get("driverId")==n.id&&(r.set("centreId",t.id),r.set("centreDesc",t.description),r.set("busId",i.id),r.set("busDesc",i.description),r.set("driverId",n.id),r.set("driverDesc",n.description),r.set("visitTypeId","2"),r.set("bookingId",e),r.set("fuelAmount",s.replace(",","")),r.set("busChangeReason",o)),r});this.backboneCollection.reset(c),this.busVisitCollectionView.collection=this.backboneCollection;var h=u.reduce(this.backboneCollection.models,function(e,t){return e+parseFloat(t.get("fuelAmount").replace(",",""))},0);this.paymentView.viewModel.amount(r.FormatMoney(h))}else r.ShowModalPopup("danger","Bus Info","You cannot modify centre & bus info");var p=this.paymentView.$el;p.find("#ddlCentre").prop("disabled",!1),p.find("#ddlBusDetails").prop("disabled",!1),p.find("#lnkAdd").show(),p.find("#lnkUpdate").hide(),this.paymentView.viewModel.busChangeReason("")},t.prototype.RemoveBusVisitItem=function(e,t,n){this.backboneCollection.remove(this.backboneCollection.findWhere({busId:e,centreId:t,driverId:n}));var i=u.reduce(this.backboneCollection.models,function(e,t){return e+parseFloat(t.get("fuelAmount").replace(",",""))},0);this.paymentView.viewModel.amount(r.FormatMoney(i))},t.prototype.UpdateBusVisitItem=function(e){var t=this.paymentView.viewModel.alkhidmatCentreList(),n=this.paymentView.viewModel.driverList(),r=this.paymentView.viewModel.busList(),i=u.filter(t,function(t){return t.id==e.get("centreId")}),s=u.filter(n,function(t){return t.id==e.get("driverId")});this.paymentView.viewModel.fuelAmount(e.get("fuelAmount")),this.paymentView.viewModel.busChangeReason(e.get("busChangeReason")),this.paymentView.viewModel.driverSelected(s[0]),this.paymentView.viewModel.alkhidmatCentreSelected(i[0]);var o=this.paymentView.$el;o.find("#ddlCentre").prop("disabled",!0),o.find("#ddlBusDetails").prop("disabled",!0),o.find("#lnkAdd").hide(),o.find("#lnkUpdate").show()},t.prototype.Save=function(e){var t=this;if(this.backboneCollection.length<1){r.ShowModalPopup("danger","Bus Details","Please add bus details");return}if(e.get("isReferralBooking")&&e.get("isReferralBookingPaid")&&(e.get("referralPaymentDate")==undefined||e.get("referralPaymentDate")=="")){r.ShowModalPopup("danger","Bus Details","Please enter Referral Booking date.");return}var n=l.request("AppGlobalSetting");e.set("modifiedBy",n.get("Id")),e.set("amount",e.get("amount").replace(",",""));var i=this.RemoveAmountFormatting(this.backboneCollection.toJSON());e.set("busVisits",i);var s=o.Save(e);s.done(function(e){return t.SaveCompleted(e)})},t.prototype.SaveCompleted=function(e){var t=new Backbone.Model(e);t.get("errorMessage")!=undefined&&t.get("errorMessage").trim()!=""?(console.log(t.get("errorMessage")),r.ShowModalPopup("danger","Payment","Due to some technical reason payment have not been saved successfully!<br> Pelase try later")):(r.ShowModalPopup("success","Payment","Record has been saved successfully with Payment ID : "+e.id),location.href="#viewBooking")},t.prototype.RemoveAmountFormatting=function(e){var t=null;return e!=undefined&&(t=u.map(e,function(e){return e.fuelAmount=e.fuelAmount.replace(",",""),e})),t},t.prototype.GetMinimalRequest=function(){var e=[];for(var t=0;t<this.backboneCollection.length;t++){var n={centreId:this.backboneCollection.models[t].get("centreId"),busId:this.backboneCollection.models[t].get("busId"),driverId:this.backboneCollection.models[t].get("driverId"),visitTypeId:this.backboneCollection.models[t].get("visitTypeId"),bookingId:this.backboneCollection.models[t].get("bookingId"),fuelAmount:this.backboneCollection.models[t].get("fuelAmount")};e.push(n)}return e},t}(r.Controller);t.PaymentCtrl=c}),define("text!CCTracking.WebClient/RefundBooking/RefundBookingTmpl.html",[],function(){return'<div>\r\n    <div class="panel panel-default">\r\n        <div class="panel-heading header-bold"><i class="fa fa-remove">&nbsp;</i> BOOKING CANCELLATION\r\n            <div class="pull-right">\r\n                Booking ID - <span data-bind="text: model.bookingId"></span>\r\n             </div>\r\n        </div>\r\n        <div class="panel-body">\r\n            <form id="form1">\r\n                <table class="table table-removeTopBorder table-condensed table-hover form-group">\r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Vehicle No</td>\r\n                        <td class="col-sm-8 col-md-8">\r\n                            <select id="ddlBusDetails" class="form-control input-sm"\r\n                                    data-bind="options: model.busList, optionsText: \'vehicleNo\', value: model.busSelected">\r\n                            </select>\r\n                        </td>\r\n                    </tr>\r\n                    \r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Reason for Cancellation</td>\r\n                        <td class="col-sm-8 col-md-8">\r\n                            <select id="ddlReasonForCancelation" class="form-control input-sm" \r\n                                    data-bind="options: model.refundTypeList, optionsText: \'description\', value: model.refundTypeSelected">\r\n                               \r\n                            </select>\r\n                        </td>\r\n                    </tr>\r\n\r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Refund from (Office)</td>\r\n                        <td class="col-sm-8 col-md-8">\r\n                            <select id="ddlCentre" class="form-control input-sm"\r\n                                    data-bind="options: model.alkhidmatCentreList, optionsText: \'description\', value: model.alkhidmatCentreSelected" >\r\n                            </select></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Officer/Cashier</td>\r\n                        <td class="col-sm-8 col-md-8">\r\n                            <select id="ddlOfficerName" class="form-control input-sm"\r\n                                    data-bind="options: model.cashierList, optionsText: \'description\', value: model.cashierSelected" >\r\n                            </select>\r\n                        </td>\r\n                    </tr>\r\n                    \r\n                    <tr>\r\n                        <td colspan="2"><hr/></td>\r\n                    </tr>\r\n                    <tr style="display: none">\r\n                        <td class="col-sm-4 col-md-4 input-sm">ID</td>\r\n                        <td class="col-sm-8 col-md-8 input-sm">\r\n                            <input id="hdnRefundId" type="hidden" data-bind="value:model.id"/>\r\n                            <span data-bind="text: model.id"></span>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Reason for Cancellation</td>\r\n                        <td class="col-sm-8 col-md-8 input-sm">\r\n                            <span data-bind="text: model.refundTypeSelectedDesc"></span>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Refund from (Office)</td>\r\n                        <td class="col-sm-8 col-md-8 input-sm">\r\n                         <span data-bind="text: model.refundFromOfficeDesc"></span>\r\n                        </td>\r\n                    </tr>\r\n                   \r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Officer/Cashier</td>\r\n                        <td class="col-sm-8 col-md-8 input-sm">\r\n                            <span data-bind="text: model.refundCashierDesc"></span>\r\n                        </td>\r\n                    </tr>\r\n\r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Cancellation Details</td>\r\n                        <td class="col-sm-8 col-md-8">\r\n                            <textarea rows="5" class="form-control input-sm" data-bind="value:model.refundReason" \r\n                                      required="required" data-role="validate" title="Cancellation Details" maxlength="200" data-content="Cancellation Details is required" ></textarea>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Booking Amount</td>\r\n                        <td class="col-sm-8 col-md-8">\r\n                            <input type="text" placeholder="Booking Amount" disabled class="form-control input-sm" data-bind="value:model.actualBookingAmount">\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Amount Refund</td>\r\n                        <td class="col-sm-8 col-md-8">\r\n                            <input type="text" placeholder="Amount Refund" class="form-control input-sm" data-bind="value:model.refundAmount" \r\n                                   required="required" data-role="validate" title="Amount Refund" maxlength="10" data-content="Amount Refund is required" />\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Amount Deducted</td>\r\n                        <td class="col-sm-8 col-md-8">\r\n                            <input type="text" placeholder="Automatically calculate" disabled class="form-control input-sm" data-bind="value:model.amountDeducted">\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4 input-sm">Refund Receipt</td>\r\n                        <td class="col-sm-8 col-md-8">\r\n                            <input type="text" placeholder="Refund Receipt" class="form-control input-sm" data-bind="value:model.refundReceipt"\r\n                                   required="required" data-role="validate" title="Refund Receipt" maxlength="50" data-content="Refund Receipt is required" />\r\n                        </td>\r\n                    </tr>\r\n                    <!--<tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Refund from (Office)</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                            <select id="ddlRefundFrom" class="form-control input-sm"\r\n                                    data-bind="options: model.landmarkList, optionsText:\'description\', value:model.landmarkIdSelected">\r\n                            </select>\r\n                        </tr>-->\r\n                    \r\n\r\n                    <tr>\r\n                        <td class="col-sm-4 col-md-4"></td>\r\n                        <td class="col-sm-8 col-md-8">\r\n                            <button type="submit" class="btn btn-default">Save</button>\r\n                            &nbsp;\r\n                            <button type="button" class="jsCancel btn btn-default">Cancel</button>\r\n                        </td>\r\n                    </tr>\r\n                    \r\n                </table>\r\n            </form>\r\n        </div>\r\n    </div>\r\n</div>\r\n'});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/RefundBooking/RefundBookingView",["require","exports","../Helper","marionette","jquery","knockout","text!./RefundBookingTmpl.html"],function(e,t,n){function a(e,t){var n=JSON.parse(localStorage.getItem("lookupResponse"));e.model.actualBookingAmount(t.actualBookingAmount),e.model.refundReason(t.refundReason),e.model.refundAmount(t.refundAmount),e.model.amountDeducted(t.amountDeducted),e.model.refundReceipt(t.refundReceipt);var i=r.filter(n.refundType,function(e){return e.id==t.refundTypeId});i.length>0?e.model.refundTypeSelectedDesc(i[0].description):e.model.refundTypeSelectedDesc("");var s=r.filter(n.alkhidmatCentre,function(e){return e.id==t.refundOfficeLocation});s.length>0?e.model.refundFromOfficeDesc(s[0].description):e.model.refundFromOfficeDesc("");var o=r.filter(n.cashier,function(e){return e.id==t.refundOfficer});o.length>0?e.model.refundCashierDesc(o[0].description):e.model.refundCashierDesc(""),e.model.id(t.id)}var r=e("underscore"),i=e("text!./RefundBookingTmpl.html"),s,o=function(e){function t(t,n){var i=this;e.call(this,t,n),this.model.busSelected.subscribe(function(){var e=r.filter(i.model.refundBookings(),function(e){return e.busId==i.model.busSelected().id});a(i,e[0])})}return __extends(t,e),t}(n.ViewModel);t.RefundBookingViewModel=o;var u=function(e){function t(t){this.template=i,this.events={submit:"Save","click .jsCancel":"Cancel"},e.call(this,t)}return __extends(t,e),t.prototype.Cancel=function(){this.trigger("Event:CancelForm")},t.prototype.Save=function(e){e.preventDefault(),this.trigger("Event:SaveForm")},t}(n.Views.MvvmView);t.RefundBookingView=u});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Dtos/RefundBookingDto",["require","exports","jquery","backbone"],function(e,t){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{id:"",bookingId:"",busId:"",actualBookingAmount:"",refundOfficeLocation:"",refundTypeId:"",refundAmount:"",amountDeducted:"",refundReason:"",refundReceipt:"",refundOfficer:"",isActive:"",createdBy:"",createdDate:"",modifiedBy:"",modifiedDate:""}},t}(Backbone.Model);e.RefundBookingDto=t;var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{id:"",bookingId:"",propertyName:"",oldValue:"",newValue:"",modifiedDate:"",createdDate:"",actualModifiedDate:"",userName:""}},t}(Backbone.Model);e.AuditRefundBooking=n;var r=function(e){function n(n){this.model=t,e.call(this,n)}return __extends(n,e),n}(Backbone.Collection);e.RefundBookingCollection=r;var i=function(e){function t(t){this.model=n,e.call(this,t)}return __extends(t,e),t}(Backbone.Collection);e.AuditRefundBookingResponseCollection=i})(t.Models||(t.Models={}));var n=t.Models});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/DAL/RefundBooking",["require","exports","CCTracking.WebClient/DAL/AjaxRequest","CCTracking.WebClient/Dtos/RefundBookingDto","jquery"],function(e,t,n,r){function o(){var e=new s;return e.doAjaxRequest(null,"GET","RefundBooking")}function u(e){var t=new s;return t.doAjaxRequest(e,"POST","RefundBooking")}function a(e){var t=new s;return t.doAjaxRequest(null,"GET","RefundBooking?id="+e)}function f(e){var t=new s;return t.doAjaxRequest(e,"POST","AuditRefundBooking")}var i=e("jquery"),s=function(e){function t(){e.call(this,this)}return __extends(t,e),t.prototype.getResponse=function(){return new r.Models.RefundBookingDto},t}(n.BaseDto);t.RefundBookingDal=s,t.Load=o,t.Save=u,t.GetById=a,t.GetAllAuditRefundBooking=f});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/RefundBooking/RefundBookingCtrl",["require","exports","../App","../Helper","./RefundBookingView","../Dtos/RefundBookingDto","../DAL/RefundBooking","marionette","jquery","knockout"],function(e,t,n,r,i,s,o){var u=e("underscore"),a=e("knockout"),f=e("knockback"),l=function(e){function t(){e.call(this),this.app=n.Application.getInstance(),this.backboneModel=new s.Models.RefundBookingDto}return __extends(t,e),t.prototype.EditRefund=function(e){var t=this,n=o.GetById(e);n.done(function(e){return t.GetByIdCompleted(e)})},t.prototype.Load=function(){var e=this,t=JSON.parse(localStorage.getItem("lookupResponse")),n=this.backboneModel;this.viewModel.bbModel=n,this.viewModel.model=f.viewModel(n),n.set("name",""),n.set("address",""),n.set("landmarkIdSelected",""),n.set("landmarkList",t.landmark),n.set("contactNo1",""),n.set("contactNo2",""),n.set("isCoPartner",""),n.set("isActive",""),this.viewModel=new i.RefundBookingViewModel(n,this),this.view=new i.RefundBookingView({viewModel:this.viewModel}),this.view.on("Event:SaveForm",function(){return e.Save(e.view.model)}),this.view.on("Event:CancelForm",function(){return e.Cancel()}),this.app.MainRegion.show(this.view)},t.prototype.GetByIdCompleted=function(e){var t=this;this.collection=e.refundBookingList,this.backboneModel=new Backbone.Model(e.refundBookingList[0]);var n=this.backboneModel;this.UIBinding(n),this.view=new i.RefundBookingView({viewModel:this.viewModel}),this.view.on("Event:SaveForm",function(){return t.Save(t.viewModel.bbModel)}),this.view.on("Event:CancelForm",function(){return t.Cancel()}),this.app.MainRegion.show(this.view)},t.prototype.Save=function(e){var t=this,n=this.app.request("AppGlobalSetting");e.set("modifiedBy",n.get("Id")),e.get("refundTypeSelected")==undefined?e.set("refundTypeId",e.get("refundTypeId")):e.set("refundTypeId",e.get("refundTypeSelected").id),e.get("alkhidmatCentreSelected")==undefined?e.set("refundOfficeLocation",e.get("refundOfficeLocation")):e.set("refundOfficeLocation",e.get("alkhidmatCentreSelected").id),e.get("busSelected")==undefined?e.set("busId",e.get("busId")):e.set("busId",e.get("busSelected").id),e.get("cashierSelected")==undefined?e.set("refundOfficer",e.get("refundOfficer")):e.set("refundOfficer",e.get("cashierSelected").id),e.set("isActive",e.get("isActive")=="1"?!0:!1),e.set("id",$("#hdnRefundId").val());var r=o.Save(e);r.done(function(e){return t.SaveCompleted(e)})},t.prototype.SaveCompleted=function(e){var t=new Backbone.Model(e);t.get("errorMessage")!=undefined&&t.get("errorMessage").trim()!=""?r.ShowModalPopup("danger","Booking","Due to some technical reason booking payment have not been saved successfully!<br> Pelase try later"):(r.ShowModalPopup("success","Booking","Record has been saved successfully with ID : "+e.id),this.Cancel())},t.prototype.Cancel=function(){window.location.href="#viewBooking"},t.prototype.UIBinding=function(e){var t=JSON.parse(localStorage.getItem("lookupResponse"));e.set("busList",e.get("busList")),e.set("busSelected",""),e.set("alkhidmatCentreList",t.alkhidmatCentre),e.set("cashierList",t.cashier),e.set("refundTypeList",t.refundType);var n=u.filter(t.alkhidmatCentre,function(t){return t.id==e.get("refundOfficeLocation")});e.set("alkhidmatCentreSelected",n[0]);var r=u.filter(t.cashier,function(t){return t.id==e.get("refundOfficer")});e.set("cashierSelected",r[0]);var s=u.filter(t.refundType,function(t){return t.id==e.get("refundTypeId")});e.set("refundTypeSelected",s[0]),s.length>0?e.set("refundTypeSelectedDesc",s[0].description):e.set("refundTypeSelectedDesc",""),n.length>0?e.set("refundFromOfficeDesc",n[0].description):e.set("refundFromOfficeDesc",""),r.length>0?e.set("refundCashierDesc",r[0].description):e.set("refundCashierDesc",""),e.set("refundBookings",this.collection),this.viewModel=new i.RefundBookingViewModel(e,this),this.viewModel.bbModel=e},t}(r.Controller);t.RefundBookingCtrl=l}),define("text!CCTracking.WebClient/ExtraCharge/ExtraCharge.html",[],function(){return'<div>\r\n    <div class="panel panel-default">\r\n        <div class="panel-heading header-bold">\r\n            <i class="fa fa-plus-circle">&nbsp;</i> BOOKING EXTRA CHARGES\r\n            <div class="pull-right">\r\n                Booking ID - <span data-bind="text: bookingId"></span>\r\n            </div>\r\n        </div>\r\n\r\n\r\n        <form id="form1">\r\n            <div>\r\n                <div class="panel-body">\r\n                    <table class="table table-removeTopBorder table-condensed table-hover form-group">\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Vehicle No</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <select id="ddlBusDetails" class="form-control input-sm"\r\n                                        data-bind="options: busList, optionsText: \'vehicleNo\', value: busSelected">\r\n                                </select>\r\n                                <input id="hdnExtraChargeId" type="hidden" data-bind="value: Id"/>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Booking Amount</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input type="text" id="Text1" class="form-control input-sm" data-bind="value: actualBookingAmount" disabled="disabled" />\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Extra Chareges</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input type="text" id="txtExtraAmount" class="form-control input-sm" data-bind="value: extraAmountCharge, numeric: 1, valueUpdate: \'afterkeydown\'"\r\n                                    required="required" data-role="validate" title="Extra Chareges" data-content="Extra Charege Amount is required" />\r\n\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Reason for Extra Charges</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input type="text" id="txtReasonExtraAmount" class="form-control input-sm" data-bind="value: extraAmountReason"\r\n                                    required="required" data-role="validate" title="Reason for Extra Charges" data-content="Reason for Extra Charges is required" />\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4 input-sm">Receipt for Extra Charges</td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <input type="text" id="txtExtraAmountReceipt" class="form-control input-sm" data-bind="value: extraAmountReceipt, numeric: 1, valueUpdate: \'afterkeydown\'"\r\n                                    required="required" data-role="validate" title="Receipt for Extra Charges" data-content="Receipt for Extra Charge is required" />\r\n\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class="col-sm-4 col-md-4"></td>\r\n                            <td class="col-sm-8 col-md-8">\r\n                                <button type="submit" class="btn btn-default">Save</button>\r\n                                &nbsp;\r\n                                <button type="button" class="jsCancel btn btn-default">Cancel</button>\r\n                            </td>\r\n                        </tr>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </form>\r\n\r\n    </div>\r\n</div>\r\n'});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/ExtraCharge/ExtraChargeView",["require","exports","../Helper","../App","marionette","jquery","jqueryUI","knockout","text!./ExtraCharge.html"],function(e,t,n,r){function c(e,t){e.bookingId(t.bookingId),e.extraAmountCharge(t.extraAmountCharge),e.extraAmountReason(t.extraAmountReason),e.extraAmountReceipt(t.extraAmountReceipt),e.actualBookingAmount(t.actualBookingAmount),e.Id(t.id)}var i=e("underscore"),s=e("knockout"),o=e("text!./ExtraCharge.html"),u,a=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t}(n.ViewModel);t.ExtraChargeViewModel=a;var f=function(e){function t(t){u=r.Application.getInstance(),this.template=o,this.viewModel=new l(t),this.bbModel=new Backbone.Model,this.events={submit:"Save","click .jsCancel":"Cancel","click .jsAddMore":"AddMore"},e.call(this,t)}return __extends(t,e),t.prototype.Cancel=function(){window.location.href="#viewBooking"},t.prototype.Save=function(e){e.preventDefault(),this.bbModel.set("id",this.viewModel.Id()),this.bbModel.set("bookingId",this.viewModel.bookingId()),this.bbModel.set("actualBookingAmount",this.viewModel.actualBookingAmount()),this.bbModel.set("busId",this.viewModel.busSelected().id),this.bbModel.set("extraAmountCharge",this.viewModel.extraAmountCharge()),this.bbModel.set("extraAmountReason",this.viewModel.extraAmountReason()),this.bbModel.set("extraAmountReceipt",this.viewModel.extraAmountReceipt()),this.trigger("ExtraChargesSave",this.bbModel)},t.prototype.SaveCompleted=function(e){var t=new Backbone.Model(e);t.get("errorMessage")!=undefined&&t.get("errorMessage").trim()!=""?n.ShowModalPopup("danger","Extra Charge","Due to some technical reason payment have not been saved successfully!<br> Pelase try later"):(n.ShowModalPopup("success","Extra Charge","Record has been saved successfully with Payment ID : "+e.id),location.href="#viewBooking")},t.prototype.onShow=function(){s.applyBindings(this.viewModel,this.el)},t.prototype.onClose=function(){},t}(n.Views.ItemView);t.ExtraChargeView=f;var l=function(){function e(e){var t=this;e==undefined?(this.Id=s.observable(),this.bookingId=s.observable(),this.actualBookingAmount=s.observable(),this.extraAmountCharge=s.observable(),this.extraAmountReason=s.observable(),this.extraAmountReceipt=s.observable()):(this.Id=s.observable(e.get("id")),this.busList=s.observableArray(e.get("busList")),this.busSelected=s.observable(e.get("busId")),this.bookingId=s.observable(e.get("bookingId")),this.actualBookingAmount=s.observable(e.get("actualBookingAmount")),this.extraAmountCharge=s.observable(e.get("extraAmountCharge")),this.extraAmountReason=s.observable(e.get("extraAmountReason")),this.extraAmountReceipt=s.observable(e.get("extraAmountReceipt"))),this.busSelected.subscribe(function(){var n=i.filter(e.get("extraChargesCollection"),function(e){return e.busId==t.busSelected().id});c(t,n[0])})}return e}();t.ViewModel=l});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Dtos/ExtraChargesDto",["require","exports","backbone"],function(e,t){(function(e){var t=function(){function e(){}return e.prototype.default=function(){return{id:"",bookingId:"",actualBookingAmount:"",extraAmountCharge:"",extraAmountReason:"",extraAmountReceipt:"",isActive:"",createdBy:"",createdDate:"",modifiedBy:"",modifiedDate:""}},e}();e.ExtraChargesDto=t;var n=function(e){function n(n){this.model=t,e.call(this,n)}return __extends(n,e),n}(Backbone.Collection);e.ExtraChargesCollection=n})(t.Models||(t.Models={}));var n=t.Models});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/DAL/ExtraCharges",["require","exports","CCTracking.WebClient/DAL/AjaxRequest","../Dtos/ExtraChargesDto"],function(e,t,n,r){function s(){var e=new i;return e.doAjaxRequest(null,"GET","ExtraCharges")}function o(e){var t=new i;return t.doAjaxRequest(e,"POST","ExtraCharges")}function u(){var e=new i;return e.doAjaxRequest(null,"GET","ExtraCharges?a=a")}function a(e){var t=new i;return t.doAjaxRequest(null,"GET","ExtraCharges?id="+e)}var i=function(e){function t(){e.call(this,this)}return __extends(t,e),t.prototype.getResponse=function(){return new r.Models.ExtraChargesDto},t}(n.BaseDto);t.ExtraChargesDal=i,t.Load=s,t.Save=o,t.GetAll=u,t.GetById=a});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/ExtraCharge/ExtraChargeCtrl",["require","exports","../App","../Helper","./ExtraChargeView","../DAL/ExtraCharges","marionette","jquery","knockout"],function(e,t,n,r,i,s){var o=e("underscore"),u=e("knockout"),a=e("knockback"),f,l=function(e){function t(){f=n.Application.getInstance(),e.call(this)}return __extends(t,e),t.prototype.EditExtraCharge=function(e){var t=this,n=s.GetById(e);n.done(function(e){t.GetByIdCompleted(e)})},t.prototype.GetByIdCompleted=function(e){var t=this;this.collection=e.extraChargesList,this.backboneModel=new Backbone.Model(this.collection[0]);var n=this.backboneModel,r=window.location.href,s=r.substring(r.indexOf("id=")+3,r.length);(n.get("id")===undefined||n.get("id")===0)&&this.InitalizeKoBinding(n),n.set("bookingId",s),n.set("busList",n.get("busList")),n.set("busSelected",""),this.view=new i.ExtraChargeView(n),this.view.on("ExtraChargesSave",function(e){return t.Save(e)}),n.set("extraChargesCollection",this.collection),f.MainRegion.show(this.view)},t.prototype.InitalizeKoBinding=function(e){e.set("extraAmountCharge",""),e.set("extraAmountReason",""),e.set("extraAmountReceipt","")},t.prototype.Save=function(e){var t=this,n=f.request("AppGlobalSetting");e.set("modifiedBy",n.get("Id")),e.set("id",$("#hdnExtraChargeId").val());var r=s.Save(e);r.done(function(e){return t.SaveCompleted(e)})},t.prototype.SaveCompleted=function(e){var t=new Backbone.Model(e);t.get("errorMessage")!=undefined&&t.get("errorMessage").trim()!=""?r.ShowModalPopup("danger","Extra Charge","Due to some technical reason payment have not been saved successfully!<br> Pelase try later"):(r.ShowModalPopup("success","Extra Charge","Record has been saved successfully with Extra Charge ID : "+e.id),location.href="#viewBooking")},t}(r.Controller);t.ExtraChargeCtrl=l}),define("text!CCTracking.WebClient/User/UserTmpl.html",[],function(){return'<div>\r\n    <div class="panel panel-default">\r\n        <div class="panel-heading header-bold"><span class="glyphicon glyphicon-briefcase"></span>&nbsp;User Information</div>\r\n        <div class="panel-body">\r\n            <form id="form1">\r\n                <div class="panel panel-default">\r\n\r\n                    <div class="panel-body">\r\n                        <table class="table table-removeTopBorder table-condensed table-hover form-group">\r\n                              <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">First Name *</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input id="txtFirstName" type="text" class="form-control input-sm" data-bind="value: model.firstName" \r\n                                        required="required" data-role="validate" title="First Name" data-content="First name is required" /></td>\r\n                            </tr>\r\n                              <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Last Name *</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input id="txtLastName" type="text" class="form-control input-sm" data-bind="value: model.lastName" \r\n                                        required="required" data-role="validate" title="Last Name" data-content="Last name is required"/></td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">User Name *</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input id="txtUserName" type="text" class="form-control input-sm" data-bind="value: model.userName, enable: model.id > \'0\' ? false:true" \r\n                                        required="required" data-role="validate" title="User name" maxlength="15" data-content="User name is required"/></td>\r\n                            </tr>\r\n                              <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">CNIC</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input id="txtCnic" type="text" class="form-control input-sm" data-bind="value: model.cnic" /></td>\r\n                            </tr>\r\n                              <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Mobile *</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input id="txtMobile" type="text" class="form-control input-sm" data-bind="value: model.mobile" required="required" data-role="validate" title="Mobile number" data-content="Mobile number is required" /></td>\r\n                            </tr>\r\n                             <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Email</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input id="txtEmail" type="email" class="form-control input-sm" data-bind="value: model.email" /></td>\r\n                            </tr>\r\n                              <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Address</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input id="txtAddress" type="text" class="form-control input-sm" data-bind="value: model.address" /></td>\r\n                            </tr>\r\n                              <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">City</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input id="txtCity" type="text" class="form-control input-sm" data-bind="value: model.city" /></td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Alkhidmat Center *</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <select id="ddlCentre" class="form-control input-sm"\r\n                                        data-bind="options: model.alkhidmatCentreList, optionsText:\'description\', value:model.alkhidmatCentreSelected">\r\n                                    </select></td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Role *</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <select id="ddlRole" class="form-control input-sm"\r\n                                        data-bind="options: model.roleList, optionsText:\'description\', value:model.roleSelected">\r\n                                    </select></td>\r\n                            </tr>\r\n                            \r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Is Active</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="radio" name="rbIsActive" value="1" data-bind="checked: model.isActive" />Yes\r\n                                    &nbsp;\r\n                                    <input type="radio" name="rbIsActive" value="0" data-bind="checked: model.isActive" />No </td>\r\n                            </tr>\r\n\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4"></td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <button type="submit" class="btn btn-default">Save</button>\r\n                                    &nbsp;\r\n                                    <button type="button" class="jsCancel btn btn-default">Cancel</button>\r\n                                </td>\r\n                            </tr>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n\r\n            </form>\r\n\r\n            <div id="DetailRegion">\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n\r\n</div>\r\n'}),define("text!CCTracking.WebClient/User/UserGrid.html",[],function(){return'<div>\r\n    <div id="gridTemplate">\r\n        <div class="panel panel-default">\r\n            <div class="panel-heading header-bold">\r\n                <span class="glyphicon glyphicon-time"></span>View - User List\r\n                <span class="pull-right"><a href="#user">Add New</a></span>\r\n            </div>\r\n            <div class="panel-body">\r\n                <table id="tblUser" class="table table-condensed table-bordered table-hover table-striped form-group">\r\n                    <thead>\r\n                        <tr class="active">\r\n                            <th>User Name</th>\r\n                            <th>Name</th>\r\n                            <th>Email</th>\r\n                            <th>CNIC</th>\r\n                            <th>Mobile</th>                            \r\n                            <th>Reset Password</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody></tbody>\r\n                    <tfoot>\r\n                        <tr class="active">\r\n                            <td colspan="6">&nbsp;</td>\r\n                        </tr>\r\n                    </tfoot>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <script type="text/html" id="rowTemplate">\r\n        <td class="jsShowDetail  input-sm"><a href="#user?id=<%=id%>"><%=userName%></a></td>\r\n        <td class="input-sm"><%=firstName%> <%=lastName%></td>\r\n         <td class="input-sm"><%=email%></td>\r\n         <td class="input-sm"><%=cnic%></td>\r\n         <td class="input-sm"><%=mobile%></td>        \r\n         <td class="input-sm"><a class="jsResetPassword" href="javascript:void(0); ?id=<%=id%>&username=<%=userName%>" >Reset</a></td>\r\n    </script>\r\n</div>\r\n\r\n\r\n\r\n\r\n'});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/User/UserView",["require","exports","../Helper","marionette","jquery","knockout","text!./UserTmpl.html","text!./UserGrid.html"],function(e,t,n){var r=e("underscore"),i=e("text!./UserTmpl.html"),s=e("text!./UserGrid.html"),o,u=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t}(n.ViewModel);t.UserViewModel=u;var a=function(e){function t(t){this.template=i,this.events={submit:"Save","click .jsCancel":"Cancel"},e.call(this,t)}return __extends(t,e),t.prototype.close=function(){},t.prototype.Cancel=function(){this.trigger("CancelForm")},t.prototype.TestFunction=function(){alert("test function")},t.prototype.Save=function(e){e.preventDefault(),this.trigger("SaveUser")},t}(n.Views.MvvmView);t.UserView=a;var f=function(e){function t(t){t.itemView=l,t.template=s.getOuterHTML("#gridTemplate"),t.itemViewContainer="tbody",e.call(this,t)}return __extends(t,e),t}(n.Views.CompositeView);t.UserCollectionView=f;var l=function(e){function t(t){t||(t={}),t.template=s.getOuterHTML("#rowTemplate"),t.tagName="tr",t.className="jsRowClick",t.events={"click .jsShowDetail":"ShowDetail","click .jsResetPassword":"ResetPassword"},e.call(this,t)}return __extends(t,e),t.prototype.ShowDetail=function(){this.trigger("ShowDetail")},t.prototype.ResetPassword=function(e){var t=n.GetParameterByName("id",e.target.href),r=n.GetParameterByName("username",e.target.href),i=new Backbone.Model({id:t,userName:r});this.trigger("Event:ResetPassword",i)},t}(n.Views.ItemView);t.UserItemView=l});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Dtos/UserDto",["require","exports","backbone"],function(e,t){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{id:"",firstName:"",lastName:"",email:"",mobile:"",cnic:"",address:"",city:"",userName:"",password:"",centreId:"",centreDesc:"",roleId:"",roleDesc:"",isAdmin:!1,authenticationToken:"",authenticationErrorMessage:""}},t}(Backbone.Model);e.UserDto=t;var n=function(e){function n(n){this.model=t,e.call(this,n)}return __extends(n,e),n}(Backbone.Collection);e.UserCollection=n})(t.Models||(t.Models={}));var n=t.Models});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/DAL/User",["require","exports","CCTracking.WebClient/DAL/AjaxRequest","CCTracking.WebClient/Dtos/UserDto"],function(e,t,n,r){function s(){var e=new i;return e.doAjaxRequest(null,"GET","User")}function o(e){var t=new i;return t.doAjaxRequest(e,"POST","User")}function u(){var e=new i;return e.doAjaxRequest(null,"GET","User?a=a")}function a(e){var t=new i;return t.doAjaxRequest(null,"GET","User?id="+e)}function f(e){var t=new i;return t.doAjaxRequest(e,"POST","ResetPassword")}var i=function(e){function t(){e.call(this,this)}return __extends(t,e),t.prototype.getResponse=function(){return new r.Models.UserDto},t}(n.BaseDto);t.UserDal=i,t.Load=s,t.Save=o,t.GetAll=u,t.GetById=a,t.ResetUserPasswrd=f});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/User/UserCtrl",["require","exports","../App","../Helper","./UserView","../Dtos/UserDto","../DAL/User","marionette","jquery","knockout","text!./UserTmpl.html"],function(e,t,n,r,i,s,o){var u=e("underscore"),a=e("knockout"),f=e("knockback"),l=function(e){function t(){e.call(this),this.app=n.Application.getInstance(),this.backboneModel=new s.Models.UserDto,this.userViewModel=new i.UserViewModel(this.backboneModel,this),this.userView=new i.UserView({viewModel:this.userViewModel}),this.collection=new s.Models.UserCollection({}),this.collectionView=new i.UserCollectionView({collection:this.collection})}return __extends(t,e),t.prototype.Show=function(){var e=this,t=window.location.href;if(t.indexOf("id=")>-1){var n=t.substring(t.indexOf("id=")+3,t.length),r=o.GetById(n);r.done(function(t){return e.GetByIdCompleted(t)})}else this.Load()},t.prototype.Load=function(){var e=this,t=JSON.parse(localStorage.getItem("lookupResponse")),n=this.backboneModel;this.userViewModel.bbModel=n,this.userViewModel.model=f.viewModel(n),n.set("firstName",""),n.set("lastName",""),n.set("alkhidmatCentreList",t.alkhidmatCentre),n.set("alkhidmatCentreSelected",""),n.set("roleList",t.role),n.set("roleSelected",""),n.set("cnic",""),n.set("userName",""),n.set("address",""),n.set("city",""),n.set("mobile",""),n.set("email",""),n.set("isActive","1"),this.userViewModel=new i.UserViewModel(n,this),this.userView=new i.UserView({viewModel:this.userViewModel}),this.userView.on("SaveUser",function(){return e.Save(e.userViewModel.bbModel)}),this.userView.on("CancelForm",function(){return e.Cancel()}),this.app.MainRegion.show(this.userView)},t.prototype.GetAll=function(){var e=this,t=o.GetAll();t.done(function(t){return e.GetAllCompleted(t)})},t.prototype.GetByIdCompleted=function(e){var t=this;this.backboneModel=new Backbone.Model(e);var n=this.backboneModel;this.UIBinding(n),this.userView=new i.UserView({viewModel:this.userViewModel}),this.userView.on("SaveUser",function(){return t.Save(t.userViewModel.bbModel)}),this.userView.on("CancelForm",function(){return t.Cancel()}),this.app.MainRegion.show(this.userView)},t.prototype.Save=function(e){var t=this,n=this.app.request("AppGlobalSetting");e.set("modifiedBy",n.get("Id")),e.set("centreId",e.get("alkhidmatCentreSelected").id),e.set("roleId",e.get("roleSelected").id),e.set("isActive",e.get("isActive")=="1"?!0:!1);var r=o.Save(this.GetMinimalRequest(e));r.done(function(e){return t.SaveCompleted(e)})},t.prototype.GetMinimalRequest=function(e){var t=new s.Models.UserDto;return t.set("id",e.get("id")),t.set("firstName",e.get("firstName")),t.set("lastName",e.get("lastName")),t.set("email",e.get("email")),t.set("mobile",e.get("mobile")),t.set("cnic",e.get("cnic")),t.set("address",e.get("address")),t.set("city",e.get("city")),t.set("userName",e.get("userName")),t.set("password",e.get("password")),t.set("centreId",e.get("centreId")),t.set("roleId",e.get("roleId")),t.set("isAdmin",e.get("isAdmin")),t.set("isActive",e.get("isActive")),t.set("createdBy",e.get("createdBy")),t.set("createdDate",e.get("createdDate")),t.set("modifiedBy",e.get("modifiedBy")),t.set("modifiedDate",e.get("modifiedDate")),t},t.prototype.GetAllCompleted=function(e){var t=this;this.collection.reset(e),this.collectionView=new i.UserCollectionView({collection:this.collection}),this.collectionView.on("itemview:ShowDetail",function(e){return t.GetByIdCompleted(e.model)}),this.collectionView.listenTo(this.collectionView,"itemview:Event:ResetPassword",function(e,n){return t.ResetUserPassword(n)}),this.app.MainRegion.show(this.collectionView)},t.prototype.SaveCompleted=function(e){this.backboneModel=new Backbone.Model(e);var t=this.backboneModel;e==undefined?r.ShowModalPopup("danger","User Detail","User Detail have not been saved successfully!"):(r.ShowModalPopup("success","User Detail","Record has been saved successfully with User ID : "+e.id),this.Cancel())},t.prototype.Cancel=function(){window.location.href="#viewUser"},t.prototype.ResetUserPassword=function(e){var t=this,n=this.app.request("AppGlobalSetting");e.set("modifiedBy",n.get("Id"));var r=o.ResetUserPasswrd(e);r.done(function(e){return t.ResetUserPasswrdCompleted(e)})},t.prototype.ResetUserPasswrdCompleted=function(e){var t=new Backbone.Model(e);if(t==undefined){r.ShowModalPopup("danger","Reset Password","Due to some technical reason password have not been reset successfully!<br> Pelase try later");return}if(t.get("errorMessage")!=undefined&&t.get("errorMessage").trim()!=""){r.ShowModalPopup("danger","Reset Password",t.get("errorMessage"));return}r.ShowModalPopup("success","Reset Password","User Password has been reset successfully to his initial password.")},t.prototype.UIBinding=function(e){var t=JSON.parse(localStorage.getItem("lookupResponse"));e.set("alkhidmatCentreList",t.alkhidmatCentre);var n=u.filter(t.alkhidmatCentre,function(t){return t.id==e.get("centreId")});e.set("alkhidmatCentreSelected",n[0]),e.set("roleList",t.role);var r=u.filter(t.role,function(t){return t.id==e.get("roleId")});e.set("roleSelected",r[0]),e.set("isActive",e.get("isActive")?"1":"0"),this.userViewModel.bbModel=e,this.userViewModel.model=f.viewModel(e),a.cleanNode($(this.userView.el)[0]),a.applyBindings(this.userViewModel,this.userView.el)},t}(r.Controller);t.UserCtrl=l}),define("text!CCTracking.WebClient/ChangePassword/ChangePassword.html",[],function(){return'<div>\r\n    <div class="panel panel-default">\r\n        <div class="panel-heading header-bold"><span class="fa fa-edit"></span>&nbsp;CC Tracking Change Password Screen</div>\r\n        <div class="panel-body">\r\n            <form class="form-signin" id="form1">\r\n                <div class="panel panel-default">\r\n\r\n                    <div class="panel-body">\r\n                        <table class="table table-removeTopBorder table-condensed table-hover form-group">\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Old Password</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="password" id="txtPassword" class="form-control" placeholder="Old Password"\r\n                                        required="required" data-role="validate" title="Password" maxlength="25" data-content="Password is required">\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">New Password</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="password" id="txtResetPassword" class="form-control" placeholder="New Password" autofocus="autofocus"\r\n                                        required="required" data-role="validate" title="New Password" maxlength="25" data-content="New Password is required">\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm">Re-enter New Password</td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <input type="password" id="txtReEnterPassword" class="form-control" placeholder="Re-enter New Password" autofocus="autofocus"\r\n                                        required="required" data-role="validate" title="Re-Enter Password" maxlength="25" data-content="Re-Enter Password is required">\r\n                            </tr>\r\n                            <tr>\r\n                                <td class="col-sm-4 col-md-4 input-sm"></td>\r\n                                <td class="col-sm-8 col-md-8">\r\n                                    <button class="jsBtnResetPassword btn btn-default" type="submit" data-role="trigger-validation">Reset Password</button>&nbsp;&nbsp;\r\n                <button class="jsCancel btn btn-default" type="reset" data-role="trigger-validation">Cancel</button>\r\n                            </tr>\r\n                        </table>\r\n\r\n                    </div>\r\n                </div>\r\n\r\n\r\n            </form>\r\n        </div>\r\n    </div>\r\n</div>\r\n'});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/ChangePassword/ChangePasswordView",["require","exports","../Helper","../App","marionette","jquery","knockout","text!./ChangePassword.html"],function(e,t,n,r){var i=e("underscore"),s=e("text!./ChangePassword.html"),o=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t}(n.ViewModel);t.ChangePasswordViewModel=o;var u=function(e){function t(t){this.template=s,this.events={submit:"ChangePassword"},this.App=r.Application.getInstance(),e.call(this,t)}return __extends(t,e),t.prototype.ChangePassword=function(e){e.preventDefault(),this.trigger("ChangePassword")},t}(n.Views.MvvmView);t.ChangePasswordView=u});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/Dtos/LoginDto",["require","exports","backbone"],function(e,t){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.default=function(){return{id:"",firstName:"",lastName:"",email:"",mobile:"",nic:"",userName:"",password:"",resetPassword:"",isAdmin:!1,authenticationToken:"",errorMessage:""}},t}(Backbone.Model);e.LoginDto=t})(t.Models||(t.Models={}));var n=t.Models});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/DAL/Login",["require","exports","CCTracking.WebClient/DAL/AjaxRequest","CCTracking.WebClient/Dtos/LoginDto"],function(e,t,n,r){function s(e){var t=new i;return t.doAjaxRequest(e,"POST","Login")}function o(e){var t=new i;return t.doAjaxRequest(e,"POST","ChangePassword")}var i=function(e){function t(){e.call(this,this)}return __extends(t,e),t.prototype.getResponse=function(){return new r.Models.LoginDto},t}(n.BaseDto);t.LoginDal=i,t.Login=s,t.ChangePasswrd=o});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("CCTracking.WebClient/ChangePassword/ChangePasswordCtrl",["require","exports","../App","../Helper","./ChangePasswordView","../Dtos/LoginDto","../DAL/Login","marionette","jquery","knockout","text!./ChangePassword.html"],function(e,t,n,r,i,s,o){var u=e("underscore"),a=e("knockout"),f=e("knockback"),l=function(e){function t(){e.call(this),this.app=n.Application.getInstance(),this.backboneModel=new s.Models.LoginDto,this.changePasswordViewModel=new i.ChangePasswordViewModel(this.backboneModel,this),this.changePasswordView=new i.ChangePasswordView({viewModel:this.changePasswordViewModel})}return __extends(t,e),t.prototype.Load=function(){var e=this;this.changePasswordView=new i.ChangePasswordView;var t=this.app.AppLayout;this.app.MainRegion.show(this.changePasswordView),this.changePasswordView.on("ChangePassword",function(){return e.ChangePassword(e.changePasswordViewModel.bbModel)})},t.prototype.ChangePassword=function(e){var t=this,n=$("#txtPassword").val(),i=$("#txtResetPassword").val(),s=$("#txtReEnterPassword").val();if(i!=s){r.ShowModalPopup("danger","Reset Password","New Password and Re-Enter Password are not same.<br>Please enter same password.");return}var u=this.app.request("AppGlobalSetting");e.set("userName",u.get("UserName")),e.set("password",n),e.set("changePassword",i);var a=o.ChangePasswrd(e);a.done(function(e){return t.Authenticated(e)})},t.prototype.Authenticated=function(e){var t=new Backbone.Model(e);if(t==undefined){r.ShowModalPopup("danger","Reset Password","Due to some technical reason password have not been reset successfully!<br> Pelase try later");return}if(t.get("errorMessage")!=undefined&&t.get("errorMessage").trim()!=""){r.ShowModalPopup("danger","Reset Password",t.get("errorMessage"));return}r.ShowModalPopup("success","Reset Password","Password has been reset successfully")},t}(r.Controller);t.ChangePasswordCtrl=l});